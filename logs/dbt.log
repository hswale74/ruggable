

============================== 2024-07-18 16:00:38.538582 | 9e13e650-a479-49a2-b69a-40427ee47271 ==============================
[0m16:00:38.538980 [info ] [MainThread]: Running with dbt=1.2.0
[0m16:00:38.541460 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m16:00:38.542149 [debug] [MainThread]: Tracking: tracking
[0m16:00:38.566522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaaf703af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaaf7038e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaaf7038b0>]}
[0m16:00:38.570294 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:00:38.571624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaaf7038e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaaf7038b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaaf703b50>]}


============================== 2024-07-18 16:00:59.957352 | d6ce6594-e519-4a9a-b507-7dbacb1e7ea5 ==============================
[0m16:00:59.957980 [info ] [MainThread]: Running with dbt=1.2.0
[0m16:00:59.961519 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m16:00:59.963356 [debug] [MainThread]: Tracking: tracking
[0m16:00:59.986643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f6f940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f6f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f6f8b0>]}
[0m16:01:00.046874 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m16:01:00.048137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd6ce6594-e519-4a9a-b507-7dbacb1e7ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f6e260>]}
[0m16:01:00.135491 [debug] [MainThread]: Parsing macros/relations.sql
[0m16:01:00.149870 [debug] [MainThread]: Parsing macros/catalog.sql
[0m16:01:00.165409 [debug] [MainThread]: Parsing macros/adapters.sql
[0m16:01:00.329995 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:01:00.337587 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:01:00.346185 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:01:00.390159 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:01:00.393018 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:01:00.399095 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:01:00.402454 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m16:01:00.412180 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m16:01:00.464092 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m16:01:00.490826 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m16:01:00.505047 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m16:01:00.513398 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m16:01:00.523043 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m16:01:00.528652 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m16:01:00.532604 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m16:01:00.537490 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m16:01:00.545446 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m16:01:00.583798 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m16:01:00.591039 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m16:01:00.596897 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m16:01:00.602898 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m16:01:00.607823 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m16:01:00.613693 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m16:01:00.618234 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:01:00.629230 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:01:00.642900 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:01:00.649818 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m16:01:00.654818 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m16:01:00.659830 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m16:01:00.665818 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m16:01:00.670138 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m16:01:00.675877 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:01:00.680881 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m16:01:00.687108 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m16:01:00.693174 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m16:01:00.698374 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:01:00.710977 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:01:00.718758 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m16:01:00.733140 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m16:01:00.756680 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m16:01:00.774856 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m16:01:00.811070 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m16:01:00.833814 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m16:01:00.868921 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m16:01:00.882591 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m16:01:00.891167 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m16:01:00.900726 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m16:01:01.008057 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m16:01:01.039775 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m16:01:01.140467 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m16:01:01.203142 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m16:01:01.322122 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m16:01:01.368162 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m16:01:01.445798 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m16:01:01.456231 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m16:01:01.539071 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m16:01:01.649105 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m16:01:01.660247 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m16:01:01.670871 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m16:01:01.700304 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m16:01:01.718434 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m16:01:01.734453 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m16:01:01.770773 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m16:01:01.833040 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m16:01:01.878110 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m16:01:01.960461 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m16:01:02.059211 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m16:01:02.072452 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m16:01:03.717801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6ce6594-e519-4a9a-b507-7dbacb1e7ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1261900>]}
[0m16:01:03.756831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6ce6594-e519-4a9a-b507-7dbacb1e7ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f6f8b0>]}
[0m16:01:03.758088 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:01:03.759066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6ce6594-e519-4a9a-b507-7dbacb1e7ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1274b80>]}
[0m16:01:03.766647 [info ] [MainThread]: 
[0m16:01:03.768712 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:01:03.776560 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m16:01:03.829231 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:01:03.830041 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:01:03.830569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:03.899700 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.07 seconds
[0m16:01:03.906617 [debug] [ThreadPool]: On list_postgres: Close
[0m16:01:03.913373 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m16:01:03.945226 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:01:03.946100 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:01:03.946600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:03.985853 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m16:01:03.986844 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:01:03.987429 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:01:03.993083 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m16:01:03.998421 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:01:03.999250 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:01:04.020779 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:04.021732 [debug] [MainThread]: On master: BEGIN
[0m16:01:04.022261 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:01:04.060229 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:01:04.061264 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:04.061841 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:01:04.065121 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:01:04.070389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6ce6594-e519-4a9a-b507-7dbacb1e7ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1262200>]}
[0m16:01:04.071748 [debug] [MainThread]: On master: ROLLBACK
[0m16:01:04.072529 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:04.073060 [debug] [MainThread]: On master: BEGIN
[0m16:01:04.073948 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:01:04.074589 [debug] [MainThread]: On master: COMMIT
[0m16:01:04.075131 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:04.075659 [debug] [MainThread]: On master: COMMIT
[0m16:01:04.076329 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:01:04.076896 [debug] [MainThread]: On master: Close
[0m16:01:04.078145 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:01:04.079087 [info ] [MainThread]: 
[0m16:01:04.168623 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_category_map
[0m16:01:04.169250 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_color_map
[0m16:01:04.170395 [info ] [Thread-1 (]: 1 of 6 START seed file public.rugs_usa_category_map ............................ [RUN]
[0m16:01:04.171554 [info ] [Thread-2 (]: 2 of 6 START seed file public.rugs_usa_color_map ............................... [RUN]
[0m16:01:04.173234 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m16:01:04.175298 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m16:01:04.176037 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_category_map
[0m16:01:04.176690 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_color_map
[0m16:01:04.177342 [debug] [Thread-1 (]: finished collecting timing info
[0m16:01:04.177993 [debug] [Thread-2 (]: finished collecting timing info
[0m16:01:04.178601 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_category_map
[0m16:01:04.179273 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_color_map
[0m16:01:05.956242 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m16:01:05.977604 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: BEGIN
[0m16:01:05.990251 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:01:06.059496 [debug] [Thread-2 (]: SQL status: BEGIN in 0.07 seconds
[0m16:01:06.078687 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m16:01:06.091873 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_color_map"} */

    create table "postgres"."public"."rugs_usa_color_map" ("pid" text,"color_id" text,"color_value" text,"dw_insert_timestamp" text)
  
[0m16:01:06.123013 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.01 seconds
[0m16:01:07.877009 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m16:01:07.894592 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: BEGIN
[0m16:01:07.906575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:07.970943 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:01:07.986596 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m16:01:08.014807 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_category_map"} */

    create table "postgres"."public"."rugs_usa_category_map" ("pid" text,"category_id" text,"category_value" text,"dw_insert_timestamp" text)
  
[0m16:01:08.044105 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.01 seconds
[0m16:02:21.672142 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m16:02:21.750233 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: 
          insert into "postgres"."public"."rugs_usa_color_map" ("pid", "color_id", "color_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
[0m16:02:22.091754 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.33 seconds
[0m16:02:24.663211 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m16:02:24.686975 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m16:02:24.969422 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.27 seconds
[0m16:03:19.338888 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m16:03:19.377602 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: 
          insert into "postgres"."public"."rugs_usa_color_map" ("pid", "color_id", "color_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
[0m16:03:19.632120 [debug] [Thread-2 (]: SQL status: INSERT 0 7232 in 0.24 seconds
[0m16:03:19.751933 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_color_map"
[0m16:03:20.116121 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: COMMIT
[0m16:03:20.133126 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m16:03:20.145093 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: COMMIT
[0m16:03:20.165439 [debug] [Thread-2 (]: SQL status: COMMIT in 0.01 seconds
[0m16:03:20.182987 [debug] [Thread-2 (]: finished collecting timing info
[0m16:03:20.195873 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: Close
[0m16:03:20.211182 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ce6594-e519-4a9a-b507-7dbacb1e7ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaaf6da050>]}
[0m16:03:20.231220 [info ] [Thread-2 (]: 2 of 6 OK loaded seed file public.rugs_usa_color_map ........................... [[32mINSERT 17232[0m in 136.04s]
[0m16:03:20.247626 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_color_map
[0m16:03:20.265673 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_links
[0m16:03:20.285788 [info ] [Thread-2 (]: 3 of 6 START seed file public.rugs_usa_links ................................... [RUN]
[0m16:03:20.299529 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m16:03:20.314276 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_links
[0m16:03:20.327171 [debug] [Thread-2 (]: finished collecting timing info
[0m16:03:20.343305 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_links
[0m16:03:21.009890 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m16:03:21.026090 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: BEGIN
[0m16:03:21.038092 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:21.106261 [debug] [Thread-2 (]: SQL status: BEGIN in 0.07 seconds
[0m16:03:21.122098 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m16:03:21.134094 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_links"} */

    create table "postgres"."public"."rugs_usa_links" ("base_url" text,"page_links" text,"card_links" text,"request_time_stamp" text,"dw_insert_timestamp" text)
  
[0m16:03:21.158192 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.01 seconds
[0m16:03:45.498018 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m16:03:45.519235 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m16:03:45.813211 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.28 seconds
[0m16:04:16.302528 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m16:04:16.323172 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: 
          insert into "postgres"."public"."rugs_usa_links" ("base_url", "page_links", "card_links", "request_time_stamp", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m16:04:16.567774 [debug] [Thread-2 (]: SQL status: INSERT 0 5565 in 0.23 seconds
[0m16:04:16.587611 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_links"
[0m16:04:16.676570 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: COMMIT
[0m16:04:16.696961 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m16:04:16.708831 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: COMMIT
[0m16:04:16.738090 [debug] [Thread-2 (]: SQL status: COMMIT in 0.02 seconds
[0m16:04:16.751632 [debug] [Thread-2 (]: finished collecting timing info
[0m16:04:16.770005 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: Close
[0m16:04:16.783937 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ce6594-e519-4a9a-b507-7dbacb1e7ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaadddfffd0>]}
[0m16:04:16.804330 [info ] [Thread-2 (]: 3 of 6 OK loaded seed file public.rugs_usa_links ............................... [[32mINSERT 5565[0m in 56.48s]
[0m16:04:16.824060 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_links
[0m16:04:16.840284 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_pads_upsell
[0m16:04:16.869451 [info ] [Thread-2 (]: 4 of 6 START seed file public.rugs_usa_pads_upsell ............................. [RUN]
[0m16:04:16.883127 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:04:16.904925 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_pads_upsell
[0m16:04:16.924493 [debug] [Thread-2 (]: finished collecting timing info
[0m16:04:16.936975 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_pads_upsell
[0m16:05:03.274094 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m16:05:03.292671 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m16:05:03.563611 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.26 seconds
[0m16:05:24.440224 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:05:24.460083 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: BEGIN
[0m16:05:24.472153 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:05:24.542253 [debug] [Thread-2 (]: SQL status: BEGIN in 0.07 seconds
[0m16:05:24.558052 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:05:24.569993 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_pads_upsell"} */

    create table "postgres"."public"."rugs_usa_pads_upsell" ("size" text,"shape" text,"price" float8,"width" float8,"sqft" float8,"type" text,"stock" integer,"height" float8,"variant" text,"p_id" text,"pad_id" text,"dw_insert_timestamp" text)
  
[0m16:05:24.597226 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.01 seconds
[0m16:06:18.985131 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m16:06:18.998906 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m16:06:19.268271 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.26 seconds
[0m16:07:34.258453 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m16:07:34.279790 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m16:07:34.565514 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.27 seconds
[0m16:07:43.991081 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m16:07:44.003604 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m16:07:44.059861 [debug] [Thread-1 (]: SQL status: INSERT 0 1265 in 0.04 seconds
[0m16:07:44.081906 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_category_map"
[0m16:07:44.147785 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: COMMIT
[0m16:07:44.166621 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m16:07:44.178536 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: COMMIT
[0m16:07:44.198583 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:07:44.212637 [debug] [Thread-1 (]: finished collecting timing info
[0m16:07:44.230702 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: Close
[0m16:07:44.249982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ce6594-e519-4a9a-b507-7dbacb1e7ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab12bf850>]}
[0m16:07:44.268243 [info ] [Thread-1 (]: 1 of 6 OK loaded seed file public.rugs_usa_category_map ........................ [[32mINSERT 51265[0m in 400.08s]
[0m16:07:44.290110 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_category_map
[0m16:07:44.316908 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_parent
[0m16:07:44.333043 [info ] [Thread-1 (]: 5 of 6 START seed file public.rugs_usa_parent .................................. [RUN]
[0m16:07:44.345625 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m16:07:44.362731 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_parent
[0m16:07:44.376617 [debug] [Thread-1 (]: finished collecting timing info
[0m16:07:44.392692 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_parent
[0m16:07:48.229865 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m16:07:48.245624 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: BEGIN
[0m16:07:48.258559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:48.324700 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m16:07:48.342541 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m16:07:48.354521 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_parent"} */

    create table "postgres"."public"."rugs_usa_parent" ("pid" text,"product_type_id" text,"name" text,"url" text,"origin" text,"thickness" text,"material" text,"weave" integer,"weave_feature" text,"color" text,"brand" text,"imageName" text,"imageType" text,"internalName" text,"category" text,"min_price" integer,"max_price" integer,"availability" text,"aggregate" boolean,"clearance" text,"long_description" text,"shopbyroom" text,"dw_insert_timestamp" text)
  
[0m16:07:48.381047 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.01 seconds
[0m16:09:06.300354 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:09:06.318735 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m16:09:07.278890 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.94 seconds
[0m16:11:45.850046 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m16:11:45.869464 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: 
          insert into "postgres"."public"."rugs_usa_parent" ("pid", "product_type_id", "name", "url", "origin", "thickness", "material", "weave", "weave_feature", "color", "brand", "imageName", "imageType", "internalName", "category", "min_price", "max_price", "availability", "aggregate", "clearance", "long_description", "shopbyroom", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m16:11:46.801935 [debug] [Thread-1 (]: SQL status: INSERT 0 5562 in 0.92 seconds
[0m16:11:46.829000 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_parent"
[0m16:11:46.915475 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: COMMIT
[0m16:11:46.931217 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m16:11:46.943165 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: COMMIT
[0m16:11:46.962235 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:11:46.985609 [debug] [Thread-1 (]: finished collecting timing info
[0m16:11:47.001273 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: Close
[0m16:11:47.021659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ce6594-e519-4a9a-b507-7dbacb1e7ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1241d50>]}
[0m16:11:47.044198 [info ] [Thread-1 (]: 5 of 6 OK loaded seed file public.rugs_usa_parent .............................. [[32mINSERT 5562[0m in 242.68s]
[0m16:11:47.058649 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_parent
[0m16:11:47.075143 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_variant
[0m16:11:47.098755 [info ] [Thread-1 (]: 6 of 6 START seed file public.rugs_usa_variant ................................. [RUN]
[0m16:11:47.118191 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m16:11:47.136457 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_variant
[0m16:11:47.156250 [debug] [Thread-1 (]: finished collecting timing info
[0m16:11:47.169003 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_variant
[0m16:12:27.558402 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m16:12:27.585469 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: BEGIN
[0m16:12:27.597478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:27.669631 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m16:12:27.685472 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m16:12:27.697499 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_variant"} */

    create table "postgres"."public"."rugs_usa_variant" ("pid" text,"variant" text,"actual_size" text,"weave_feature" text,"weave_cat" text,"size_grp" text,"shipping_size" text,"shape" text,"weight" float8,"price" float8,"msrp" float8,"stock_level" integer,"depletion_level" integer,"low_stock" boolean,"estimated_delivery_date" text,"this_isd_range" text,"status" text,"origin" text,"new_arrival" text,"stockMsg" text,"stockEddMsg" text,"other_stock_core" integer,"other_stock_compass" integer,"dw_insert_timestamp" text)
  
[0m16:12:27.718495 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.01 seconds
[0m16:12:52.369922 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:12:52.383758 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m16:12:53.303352 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.91 seconds
[0m16:16:37.290543 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:16:37.310944 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m16:16:38.244659 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.92 seconds
[0m16:19:52.232528 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m16:19:52.251818 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m16:19:53.895910 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 1.63 seconds
[0m16:20:21.545701 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:20:21.568067 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m16:20:22.495312 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.91 seconds
[0m16:24:07.482170 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:24:07.503456 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m16:24:08.485269 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.96 seconds
[0m16:27:28.245983 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m16:27:28.267878 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m16:27:30.214991 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 1.91 seconds
[0m16:27:57.937830 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:27:57.952230 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m16:27:58.948937 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.98 seconds
[0m16:31:49.999879 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:31:50.041041 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m16:31:50.992593 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.94 seconds
[0m16:35:09.757366 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m16:35:09.777478 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m16:35:11.356541 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 1.57 seconds
[0m16:35:38.530951 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:35:38.551453 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m16:35:39.472851 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.91 seconds
[0m16:39:23.567621 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:39:23.588558 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m16:39:24.543799 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.94 seconds
[0m16:41:46.080463 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m16:41:46.115935 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m16:41:47.514471 [debug] [Thread-1 (]: SQL status: INSERT 0 8800 in 1.39 seconds
[0m16:41:47.556624 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_variant"
[0m16:41:47.652562 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: COMMIT
[0m16:41:47.671733 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m16:41:47.696659 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: COMMIT
[0m16:41:47.715708 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:41:47.730136 [debug] [Thread-1 (]: finished collecting timing info
[0m16:41:47.746970 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: Close
[0m16:41:47.770100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ce6594-e519-4a9a-b507-7dbacb1e7ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f31900>]}
[0m16:41:47.789883 [info ] [Thread-1 (]: 6 of 6 OK loaded seed file public.rugs_usa_variant ............................. [[32mINSERT 38800[0m in 1800.65s]
[0m16:41:47.806941 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_variant
[0m16:41:57.451625 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:41:57.455849 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m16:41:58.102876 [debug] [Thread-2 (]: SQL status: INSERT 0 7154 in 0.65 seconds
[0m16:41:58.121377 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:41:58.143742 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: COMMIT
[0m16:41:58.144985 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m16:41:58.145551 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: COMMIT
[0m16:41:58.149116 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:41:58.152448 [debug] [Thread-2 (]: finished collecting timing info
[0m16:41:58.153431 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: Close
[0m16:41:58.156708 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ce6594-e519-4a9a-b507-7dbacb1e7ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaade6e5090>]}
[0m16:41:58.158570 [info ] [Thread-2 (]: 4 of 6 OK loaded seed file public.rugs_usa_pads_upsell ......................... [[32mINSERT 97154[0m in 2261.27s]
[0m16:41:58.160850 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_pads_upsell
[0m16:41:58.187784 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:41:58.189634 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:58.190213 [debug] [MainThread]: On master: BEGIN
[0m16:41:58.190734 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:41:58.234757 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:41:58.235900 [debug] [MainThread]: On master: COMMIT
[0m16:41:58.236443 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:58.236971 [debug] [MainThread]: On master: COMMIT
[0m16:41:58.237589 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:41:58.238086 [debug] [MainThread]: On master: Close
[0m16:41:58.241111 [info ] [MainThread]: 
[0m16:41:58.242022 [info ] [MainThread]: Finished running 6 seeds in 0 hours 40 minutes and 54.47 seconds (2454.47s).
[0m16:41:58.242987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:58.243587 [debug] [MainThread]: Connection 'seed.jaffle_shop.rugs_usa_variant' was properly closed.
[0m16:41:58.244025 [debug] [MainThread]: Connection 'seed.jaffle_shop.rugs_usa_pads_upsell' was properly closed.
[0m16:41:58.281516 [info ] [MainThread]: 
[0m16:41:58.282456 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:41:58.283769 [info ] [MainThread]: 
[0m16:41:58.284633 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:41:58.286116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f33d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab12600a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaae5694a30>]}


============================== 2024-07-19 13:17:22.050485 | 32725bb4-56dd-4a26-a420-5947b6617a67 ==============================
[0m13:17:22.050849 [info ] [MainThread]: Running with dbt=1.2.0
[0m13:17:22.054010 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m13:17:22.054740 [debug] [MainThread]: Tracking: tracking
[0m13:17:22.086717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaaf703af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaaf7038e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaaf7038b0>]}
[0m13:17:22.090716 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:17:22.092239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaaf7038e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaaf703a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaaf703b50>]}


============================== 2024-07-19 13:17:38.838844 | 6bef4cf5-0801-414f-bb9e-5cda1490af54 ==============================
[0m13:17:38.839518 [info ] [MainThread]: Running with dbt=1.2.0
[0m13:17:38.843386 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m13:17:38.844502 [debug] [MainThread]: Tracking: tracking
[0m13:17:38.869660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f77940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f77850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f778b0>]}
[0m13:17:39.081592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:17:39.082703 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:17:39.122690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bef4cf5-0801-414f-bb9e-5cda1490af54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab109c0d0>]}
[0m13:17:39.168557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bef4cf5-0801-414f-bb9e-5cda1490af54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab106d690>]}
[0m13:17:39.169952 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:17:39.170909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bef4cf5-0801-414f-bb9e-5cda1490af54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab106d9f0>]}
[0m13:17:39.177800 [info ] [MainThread]: 
[0m13:17:39.179928 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m13:17:39.188484 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m13:17:39.249983 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:17:39.250892 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:17:39.251413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:39.345141 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.09 seconds
[0m13:17:39.352885 [debug] [ThreadPool]: On list_postgres: Close
[0m13:17:39.359838 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m13:17:39.391618 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m13:17:39.392671 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m13:17:39.393570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:17:39.445168 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m13:17:39.446302 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m13:17:39.446865 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:17:39.457872 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m13:17:39.465147 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m13:17:39.466393 [debug] [ThreadPool]: On list_postgres_public: Close
[0m13:17:39.489806 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:39.490712 [debug] [MainThread]: On master: BEGIN
[0m13:17:39.491282 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:17:39.529810 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m13:17:39.530950 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:39.531577 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:17:39.537113 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:17:39.543245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bef4cf5-0801-414f-bb9e-5cda1490af54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab106d6c0>]}
[0m13:17:39.544801 [debug] [MainThread]: On master: ROLLBACK
[0m13:17:39.545783 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:39.546372 [debug] [MainThread]: On master: BEGIN
[0m13:17:39.547247 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:17:39.547961 [debug] [MainThread]: On master: COMMIT
[0m13:17:39.548549 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:39.549094 [debug] [MainThread]: On master: COMMIT
[0m13:17:39.549837 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:17:39.550562 [debug] [MainThread]: On master: Close
[0m13:17:39.552011 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:17:39.552920 [info ] [MainThread]: 
[0m13:17:39.649904 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_category_map
[0m13:17:39.650996 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_color_map
[0m13:17:39.652203 [info ] [Thread-1 (]: 1 of 6 START seed file public.rugs_usa_category_map ............................ [RUN]
[0m13:17:39.653322 [info ] [Thread-2 (]: 2 of 6 START seed file public.rugs_usa_color_map ............................... [RUN]
[0m13:17:39.655080 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m13:17:39.656695 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m13:17:39.657338 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_category_map
[0m13:17:39.657953 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_color_map
[0m13:17:39.658591 [debug] [Thread-1 (]: finished collecting timing info
[0m13:17:39.659171 [debug] [Thread-2 (]: finished collecting timing info
[0m13:17:39.659818 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_category_map
[0m13:17:39.660486 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_color_map
[0m13:17:41.488854 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m13:17:41.503369 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: BEGIN
[0m13:17:41.517353 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:17:41.587257 [debug] [Thread-2 (]: SQL status: BEGIN in 0.07 seconds
[0m13:17:41.601389 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m13:17:41.614290 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_color_map"} */
truncate table "postgres"."public"."rugs_usa_color_map"
[0m13:17:41.645560 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.02 seconds
[0m13:17:43.740595 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m13:17:43.765116 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: BEGIN
[0m13:17:43.778133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:43.853275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.08 seconds
[0m13:17:43.869128 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m13:17:43.881103 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_category_map"} */
truncate table "postgres"."public"."rugs_usa_category_map"
[0m13:17:43.904567 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m13:18:56.852651 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m13:18:56.870509 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: 
          insert into "postgres"."public"."rugs_usa_color_map" ("pid", "color_id", "color_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
[0m13:18:57.184563 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.3 seconds
[0m13:18:59.925609 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m13:18:59.951707 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m13:19:00.257952 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.29 seconds
[0m13:19:51.440325 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m13:19:51.470851 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: 
          insert into "postgres"."public"."rugs_usa_color_map" ("pid", "color_id", "color_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
[0m13:19:51.727112 [debug] [Thread-2 (]: SQL status: INSERT 0 7232 in 0.24 seconds
[0m13:19:51.840936 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_color_map"
[0m13:19:52.104870 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: COMMIT
[0m13:19:52.121383 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_color_map"
[0m13:19:52.133395 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: COMMIT
[0m13:19:52.154537 [debug] [Thread-2 (]: SQL status: COMMIT in 0.01 seconds
[0m13:19:52.173965 [debug] [Thread-2 (]: finished collecting timing info
[0m13:19:52.190581 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_color_map: Close
[0m13:19:52.205819 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bef4cf5-0801-414f-bb9e-5cda1490af54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaaf793400>]}
[0m13:19:52.231244 [info ] [Thread-2 (]: 2 of 6 OK loaded seed file public.rugs_usa_color_map ........................... [[32mINSERT 17232[0m in 132.55s]
[0m13:19:52.255600 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_color_map
[0m13:19:52.275445 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_links
[0m13:19:52.293092 [info ] [Thread-2 (]: 3 of 6 START seed file public.rugs_usa_links ................................... [RUN]
[0m13:19:52.306612 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m13:19:52.329658 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_links
[0m13:19:52.341520 [debug] [Thread-2 (]: finished collecting timing info
[0m13:19:52.358440 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_links
[0m13:19:53.273067 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m13:19:53.292417 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: BEGIN
[0m13:19:53.304416 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:19:53.372543 [debug] [Thread-2 (]: SQL status: BEGIN in 0.07 seconds
[0m13:19:53.388394 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m13:19:53.400344 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_links"} */
truncate table "postgres"."public"."rugs_usa_links"
[0m13:19:53.422818 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m13:20:16.133031 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m13:20:16.161519 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m13:20:16.465644 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.29 seconds
[0m13:20:46.165781 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m13:20:46.197670 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: 
          insert into "postgres"."public"."rugs_usa_links" ("base_url", "page_links", "card_links", "request_time_stamp", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m13:20:46.456033 [debug] [Thread-2 (]: SQL status: INSERT 0 5565 in 0.24 seconds
[0m13:20:46.479637 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_links"
[0m13:20:46.566460 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: COMMIT
[0m13:20:46.582445 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_links"
[0m13:20:46.594417 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: COMMIT
[0m13:20:46.633521 [debug] [Thread-2 (]: SQL status: COMMIT in 0.03 seconds
[0m13:20:46.649938 [debug] [Thread-2 (]: finished collecting timing info
[0m13:20:46.666599 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_links: Close
[0m13:20:46.691581 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bef4cf5-0801-414f-bb9e-5cda1490af54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaade6418d0>]}
[0m13:20:46.711701 [info ] [Thread-2 (]: 3 of 6 OK loaded seed file public.rugs_usa_links ............................... [[32mINSERT 5565[0m in 54.38s]
[0m13:20:46.729221 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_links
[0m13:20:46.752970 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.rugs_usa_pads_upsell
[0m13:20:46.778653 [info ] [Thread-2 (]: 4 of 6 START seed file public.rugs_usa_pads_upsell ............................. [RUN]
[0m13:20:46.793426 [debug] [Thread-2 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m13:20:46.809572 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.rugs_usa_pads_upsell
[0m13:20:46.821512 [debug] [Thread-2 (]: finished collecting timing info
[0m13:20:46.833491 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.rugs_usa_pads_upsell
[0m13:21:33.778388 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m13:21:33.793174 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m13:21:34.127469 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.32 seconds
[0m13:21:47.524914 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m13:21:47.543452 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: BEGIN
[0m13:21:47.555372 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:21:47.632193 [debug] [Thread-2 (]: SQL status: BEGIN in 0.08 seconds
[0m13:21:47.646347 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m13:21:47.663401 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_pads_upsell"} */
truncate table "postgres"."public"."rugs_usa_pads_upsell"
[0m13:21:47.686642 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m13:22:52.537533 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m13:22:52.567308 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m13:22:52.900468 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.32 seconds
[0m13:24:12.907672 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m13:24:12.926212 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m13:24:13.206458 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.27 seconds
[0m13:24:23.358258 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m13:24:23.377246 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: 
          insert into "postgres"."public"."rugs_usa_category_map" ("pid", "category_id", "category_value", "dw_insert_timestamp") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m13:24:23.443070 [debug] [Thread-1 (]: SQL status: INSERT 0 1265 in 0.05 seconds
[0m13:24:23.467488 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_category_map"
[0m13:24:23.536817 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: COMMIT
[0m13:24:23.555094 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_category_map"
[0m13:24:23.567096 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: COMMIT
[0m13:24:23.592223 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m13:24:23.613729 [debug] [Thread-1 (]: finished collecting timing info
[0m13:24:23.633346 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_category_map: Close
[0m13:24:23.653235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bef4cf5-0801-414f-bb9e-5cda1490af54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab12dc3d0>]}
[0m13:24:23.669446 [info ] [Thread-1 (]: 1 of 6 OK loaded seed file public.rugs_usa_category_map ........................ [[32mINSERT 51265[0m in 404.00s]
[0m13:24:23.687672 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_category_map
[0m13:24:23.704532 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_parent
[0m13:24:23.720667 [info ] [Thread-1 (]: 5 of 6 START seed file public.rugs_usa_parent .................................. [RUN]
[0m13:24:23.734064 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m13:24:23.751177 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_parent
[0m13:24:23.763631 [debug] [Thread-1 (]: finished collecting timing info
[0m13:24:23.775112 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_parent
[0m13:24:27.516409 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m13:24:27.532066 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: BEGIN
[0m13:24:27.544054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:27.625608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.08 seconds
[0m13:24:27.642057 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m13:24:27.655079 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_parent"} */
truncate table "postgres"."public"."rugs_usa_parent"
[0m13:24:27.682727 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m13:25:41.080743 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m13:25:41.096967 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m13:25:42.054925 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.94 seconds
[0m13:28:31.658306 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m13:28:31.681600 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: 
          insert into "postgres"."public"."rugs_usa_parent" ("pid", "product_type_id", "name", "url", "origin", "thickness", "material", "weave", "weave_feature", "color", "brand", "imageName", "imageType", "internalName", "category", "min_price", "max_price", "availability", "aggregate", "clearance", "long_description", "shopbyroom", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m13:28:32.610200 [debug] [Thread-1 (]: SQL status: INSERT 0 5562 in 0.91 seconds
[0m13:28:32.637103 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_parent"
[0m13:28:32.716583 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: COMMIT
[0m13:28:32.734066 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_parent"
[0m13:28:32.746045 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: COMMIT
[0m13:28:32.796174 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m13:28:32.810387 [debug] [Thread-1 (]: finished collecting timing info
[0m13:28:32.826274 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_parent: Close
[0m13:28:32.844237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bef4cf5-0801-414f-bb9e-5cda1490af54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10ea9e0>]}
[0m13:28:32.868222 [info ] [Thread-1 (]: 5 of 6 OK loaded seed file public.rugs_usa_parent .............................. [[32mINSERT 5562[0m in 249.11s]
[0m13:28:32.886528 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_parent
[0m13:28:32.902421 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.rugs_usa_variant
[0m13:28:32.926615 [info ] [Thread-1 (]: 6 of 6 START seed file public.rugs_usa_variant ................................. [RUN]
[0m13:28:32.939977 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m13:28:32.959177 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.rugs_usa_variant
[0m13:28:32.971168 [debug] [Thread-1 (]: finished collecting timing info
[0m13:28:32.983113 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.rugs_usa_variant
[0m13:29:08.831559 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m13:29:08.848679 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: BEGIN
[0m13:29:08.862717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:08.938492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.08 seconds
[0m13:29:08.954792 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m13:29:08.966684 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.rugs_usa_variant"} */
truncate table "postgres"."public"."rugs_usa_variant"
[0m13:29:08.987810 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m13:29:29.010146 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m13:29:29.026798 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m13:29:29.930897 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.89 seconds
[0m13:33:19.690212 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m13:33:19.714998 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m13:33:20.725796 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 1.0 seconds
[0m13:36:41.740174 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m13:36:41.765054 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m13:36:43.423171 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 1.65 seconds
[0m13:37:04.060846 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m13:37:04.081239 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m13:37:05.031493 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.93 seconds
[0m13:40:49.692598 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m13:40:49.713897 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m13:40:50.754959 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 1.03 seconds
[0m13:44:16.239939 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m13:44:16.264301 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m13:44:17.884581 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 1.61 seconds
[0m13:44:38.128775 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m13:44:38.145138 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m13:44:39.085557 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.92 seconds
[0m13:48:21.931934 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m13:48:21.948939 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m13:48:22.915520 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.95 seconds
[0m13:51:48.539428 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m13:51:48.572806 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m13:51:50.201810 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 1.62 seconds
[0m13:52:08.213889 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m13:52:08.237068 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m13:52:09.176877 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 0.93 seconds
[0m13:55:56.408496 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m13:55:56.429643 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m13:55:57.510451 [debug] [Thread-2 (]: SQL status: INSERT 0 10000 in 1.07 seconds
[0m13:58:29.620907 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m13:58:29.642943 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: 
          insert into "postgres"."public"."rugs_usa_variant" ("pid", "variant", "actual_size", "weave_feature", "weave_cat", "size_grp", "shipping_size", "shape", "weight", "price", "msrp", "stock_level", "depletion_level", "low_stock", "estimated_delivery_date", "this_isd_range", "status", "origin", "new_arrival", "stockMsg", "stockEddMsg", "other_stock_core", "other_stock_compass", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m13:58:31.076879 [debug] [Thread-1 (]: SQL status: INSERT 0 8800 in 1.42 seconds
[0m13:58:31.118601 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_variant"
[0m13:58:31.222926 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: COMMIT
[0m13:58:31.242794 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_variant"
[0m13:58:31.254773 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: COMMIT
[0m13:58:31.287107 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m13:58:31.311917 [debug] [Thread-1 (]: finished collecting timing info
[0m13:58:31.325876 [debug] [Thread-1 (]: On seed.jaffle_shop.rugs_usa_variant: Close
[0m13:58:31.348631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bef4cf5-0801-414f-bb9e-5cda1490af54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaade83ab90>]}
[0m13:58:31.372306 [info ] [Thread-1 (]: 6 of 6 OK loaded seed file public.rugs_usa_variant ............................. [[32mINSERT 38800[0m in 1798.41s]
[0m13:58:31.390236 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.rugs_usa_variant
[0m13:58:34.727384 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m13:58:34.728366 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: 
          insert into "postgres"."public"."rugs_usa_pads_upsell" ("size", "shape", "price", "width", "sqft", "type", "stock", "height", "variant", "p_id", "pad_id", "dw_insert_timestamp") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%...
[0m13:58:35.342514 [debug] [Thread-2 (]: SQL status: INSERT 0 7154 in 0.61 seconds
[0m13:58:35.351936 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m13:58:35.367184 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: COMMIT
[0m13:58:35.368016 [debug] [Thread-2 (]: Using postgres connection "seed.jaffle_shop.rugs_usa_pads_upsell"
[0m13:58:35.368656 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: COMMIT
[0m13:58:35.378279 [debug] [Thread-2 (]: SQL status: COMMIT in 0.01 seconds
[0m13:58:35.380183 [debug] [Thread-2 (]: finished collecting timing info
[0m13:58:35.380772 [debug] [Thread-2 (]: On seed.jaffle_shop.rugs_usa_pads_upsell: Close
[0m13:58:35.382390 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bef4cf5-0801-414f-bb9e-5cda1490af54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaadda78d00>]}
[0m13:58:35.383792 [info ] [Thread-2 (]: 4 of 6 OK loaded seed file public.rugs_usa_pads_upsell ......................... [[32mINSERT 97154[0m in 2268.59s]
[0m13:58:35.385565 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.rugs_usa_pads_upsell
[0m13:58:35.423166 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m13:58:35.425562 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:35.426062 [debug] [MainThread]: On master: BEGIN
[0m13:58:35.426519 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:58:35.478133 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m13:58:35.479107 [debug] [MainThread]: On master: COMMIT
[0m13:58:35.479585 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:35.480020 [debug] [MainThread]: On master: COMMIT
[0m13:58:35.480585 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:58:35.481080 [debug] [MainThread]: On master: Close
[0m13:58:35.484605 [info ] [MainThread]: 
[0m13:58:35.485596 [info ] [MainThread]: Finished running 6 seeds in 0 hours 40 minutes and 56.30 seconds (2456.30s).
[0m13:58:35.486503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:35.487038 [debug] [MainThread]: Connection 'seed.jaffle_shop.rugs_usa_variant' was properly closed.
[0m13:58:35.487524 [debug] [MainThread]: Connection 'seed.jaffle_shop.rugs_usa_pads_upsell' was properly closed.
[0m13:58:35.527457 [info ] [MainThread]: 
[0m13:58:35.528402 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:58:35.529514 [info ] [MainThread]: 
[0m13:58:35.530282 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:58:35.531644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab106d660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaae5aee7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaae58479a0>]}


============================== 2024-07-19 20:35:29.664754 | 626e4a55-2a2d-4e96-be78-30969619ae1d ==============================
[0m20:35:29.665850 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:35:29.670739 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:35:29.671742 [debug] [MainThread]: Tracking: tracking
[0m20:35:29.711382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f26e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f25a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f26020>]}
[0m20:35:29.828439 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:35:29.829944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '626e4a55-2a2d-4e96-be78-30969619ae1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f289a0>]}
[0m20:35:29.969021 [debug] [MainThread]: Parsing macros/relations.sql
[0m20:35:29.981128 [debug] [MainThread]: Parsing macros/catalog.sql
[0m20:35:29.995155 [debug] [MainThread]: Parsing macros/adapters.sql
[0m20:35:30.150998 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m20:35:30.158151 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m20:35:30.166499 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m20:35:30.207689 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m20:35:30.209960 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m20:35:30.215742 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m20:35:30.218910 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m20:35:30.228431 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m20:35:30.278464 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m20:35:30.304409 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m20:35:30.318306 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m20:35:30.326341 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m20:35:30.335417 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m20:35:30.339745 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m20:35:30.343327 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m20:35:30.348048 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m20:35:30.355739 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m20:35:30.392216 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m20:35:30.398968 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m20:35:30.404983 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m20:35:30.410683 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m20:35:30.415386 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m20:35:30.421018 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m20:35:30.425226 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m20:35:30.435144 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m20:35:30.448409 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m20:35:30.455300 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m20:35:30.460710 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m20:35:30.466385 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m20:35:30.472334 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m20:35:30.476518 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m20:35:30.481969 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m20:35:30.486860 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m20:35:30.492492 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m20:35:30.498317 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m20:35:30.503378 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m20:35:30.515045 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m20:35:30.522387 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m20:35:30.535170 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m20:35:30.556810 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m20:35:30.572868 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m20:35:30.606111 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m20:35:30.625683 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m20:35:30.657874 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m20:35:30.670334 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m20:35:30.677310 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m20:35:30.685647 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m20:35:30.783395 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m20:35:30.808982 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m20:35:30.901615 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m20:35:30.958793 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m20:35:31.067404 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m20:35:31.110390 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m20:35:31.180180 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m20:35:31.189232 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m20:35:31.265371 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m20:35:31.366780 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m20:35:31.376690 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m20:35:31.386449 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m20:35:31.412735 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m20:35:31.428965 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m20:35:31.444009 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m20:35:31.469786 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m20:35:31.526159 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m20:35:31.567922 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m20:35:31.647162 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m20:35:31.733670 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m20:35:31.746153 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m20:35:33.082421 [debug] [MainThread]: 1699: static parser successfully parsed silver/rugs.sql
[0m20:35:33.384546 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.gold
- models.silver

[0m20:35:33.419572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '626e4a55-2a2d-4e96-be78-30969619ae1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1043fa0>]}
[0m20:35:33.462080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '626e4a55-2a2d-4e96-be78-30969619ae1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f601c0>]}
[0m20:35:33.463306 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:35:33.464219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '626e4a55-2a2d-4e96-be78-30969619ae1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1069180>]}
[0m20:35:33.470231 [info ] [MainThread]: 
[0m20:35:33.472464 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:35:33.477991 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m20:35:33.534014 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:35:33.535082 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:35:33.535639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:33.634924 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.1 seconds
[0m20:35:33.641938 [debug] [ThreadPool]: On list_postgres: Close
[0m20:35:33.648956 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m20:35:33.678980 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:35:33.679713 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:35:33.680194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:35:33.717893 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m20:35:33.718771 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:35:33.719314 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:35:33.724717 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:35:33.730746 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:35:33.731567 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:35:33.753298 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:33.754111 [debug] [MainThread]: On master: BEGIN
[0m20:35:33.754623 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:33.792287 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m20:35:33.793088 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:33.793587 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:35:33.805853 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m20:35:33.811115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '626e4a55-2a2d-4e96-be78-30969619ae1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf22e77c0>]}
[0m20:35:33.812172 [debug] [MainThread]: On master: ROLLBACK
[0m20:35:33.812862 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:33.813357 [debug] [MainThread]: On master: BEGIN
[0m20:35:33.814135 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:35:33.814739 [debug] [MainThread]: On master: COMMIT
[0m20:35:33.815216 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:33.815656 [debug] [MainThread]: On master: COMMIT
[0m20:35:33.816249 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:35:33.816748 [debug] [MainThread]: On master: Close
[0m20:35:33.818242 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:35:33.819324 [info ] [MainThread]: 
[0m20:35:33.833603 [debug] [Thread-1 (]: Began running node model.jaffle_shop.rugs
[0m20:35:33.834877 [info ] [Thread-1 (]: 1 of 1 START view model public.rugs ............................................ [RUN]
[0m20:35:33.836642 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.rugs"
[0m20:35:33.837261 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.rugs
[0m20:35:33.837860 [debug] [Thread-1 (]: Compiling model.jaffle_shop.rugs
[0m20:35:33.846179 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.rugs"
[0m20:35:33.850163 [debug] [Thread-1 (]: finished collecting timing info
[0m20:35:33.850785 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.rugs
[0m20:35:34.067560 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.rugs"
[0m20:35:34.071319 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m20:35:34.071902 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: BEGIN
[0m20:35:34.072392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:34.111365 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m20:35:34.112303 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m20:35:34.112813 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */

  create view "postgres"."public"."rugs__dbt_tmp" as (
    Select 
distinct *
from rugs_usa_parent
  );
[0m20:35:34.124669 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m20:35:34.154784 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m20:35:34.155537 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
alter table "postgres"."public"."rugs__dbt_tmp" rename to "rugs"
[0m20:35:34.157392 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:35:34.251670 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: COMMIT
[0m20:35:34.252517 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m20:35:34.253014 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: COMMIT
[0m20:35:34.258886 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m20:35:34.281966 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m20:35:34.282642 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
drop view if exists "postgres"."public"."rugs__dbt_backup" cascade
[0m20:35:34.284458 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:35:34.288823 [debug] [Thread-1 (]: finished collecting timing info
[0m20:35:34.289423 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: Close
[0m20:35:34.290858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '626e4a55-2a2d-4e96-be78-30969619ae1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf2337fd0>]}
[0m20:35:34.292125 [info ] [Thread-1 (]: 1 of 1 OK created view model public.rugs ....................................... [[32mCREATE VIEW[0m in 0.45s]
[0m20:35:34.293937 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.rugs
[0m20:35:34.299612 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:35:34.300604 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:34.301165 [debug] [MainThread]: On master: BEGIN
[0m20:35:34.301656 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:35:34.341669 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m20:35:34.342898 [debug] [MainThread]: On master: COMMIT
[0m20:35:34.343602 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:34.344150 [debug] [MainThread]: On master: COMMIT
[0m20:35:34.344925 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:35:34.345490 [debug] [MainThread]: On master: Close
[0m20:35:34.347616 [info ] [MainThread]: 
[0m20:35:34.348640 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m20:35:34.349694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:34.350274 [debug] [MainThread]: Connection 'model.jaffle_shop.rugs' was properly closed.
[0m20:35:34.384666 [info ] [MainThread]: 
[0m20:35:34.385649 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:35:34.386868 [info ] [MainThread]: 
[0m20:35:34.387800 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:35:34.389188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf237d900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf233c460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf232d810>]}


============================== 2024-07-19 20:41:42.961516 | a483988a-d5ec-4aea-a832-270f280ddc26 ==============================
[0m20:41:42.962110 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:41:42.966726 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:41:42.967687 [debug] [MainThread]: Tracking: tracking
[0m20:41:42.996877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f20370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f220e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f222f0>]}
[0m20:41:43.094523 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:41:43.095983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a483988a-d5ec-4aea-a832-270f280ddc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1cd30>]}
[0m20:41:43.194784 [debug] [MainThread]: Parsing macros/relations.sql
[0m20:41:43.206090 [debug] [MainThread]: Parsing macros/catalog.sql
[0m20:41:43.220322 [debug] [MainThread]: Parsing macros/adapters.sql
[0m20:41:43.379368 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m20:41:43.386668 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m20:41:43.395110 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m20:41:43.436362 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m20:41:43.438672 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m20:41:43.444452 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m20:41:43.447671 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m20:41:43.457147 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m20:41:43.507349 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m20:41:43.533122 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m20:41:43.547129 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m20:41:43.555198 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m20:41:43.564256 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m20:41:43.568579 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m20:41:43.572227 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m20:41:43.576986 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m20:41:43.584645 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m20:41:43.620223 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m20:41:43.626980 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m20:41:43.632974 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m20:41:43.638725 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m20:41:43.643459 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m20:41:43.649130 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m20:41:43.653316 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m20:41:43.663186 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m20:41:43.676381 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m20:41:43.683217 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m20:41:43.688114 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m20:41:43.693451 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m20:41:43.699258 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m20:41:43.703420 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m20:41:43.708896 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m20:41:43.713738 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m20:41:43.719290 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m20:41:43.725107 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m20:41:43.730506 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m20:41:43.742622 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m20:41:43.750052 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m20:41:43.763142 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m20:41:43.785170 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m20:41:43.801220 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m20:41:43.834726 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m20:41:43.854562 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m20:41:43.887679 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m20:41:43.900548 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m20:41:43.907590 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m20:41:43.915940 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m20:41:44.015010 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m20:41:44.040815 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m20:41:44.133921 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m20:41:44.191946 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m20:41:44.300204 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m20:41:44.344064 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m20:41:44.415604 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m20:41:44.424992 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m20:41:44.501473 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m20:41:44.602462 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m20:41:44.612464 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m20:41:44.622406 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m20:41:44.649249 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m20:41:44.665608 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m20:41:44.680525 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m20:41:44.706204 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m20:41:44.762593 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m20:41:44.804264 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m20:41:44.884308 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m20:41:44.970682 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m20:41:44.983575 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m20:41:46.297932 [debug] [MainThread]: 1699: static parser successfully parsed silver/rugs.sql
[0m20:41:46.593136 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.gold

[0m20:41:46.625324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a483988a-d5ec-4aea-a832-270f280ddc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1084790>]}
[0m20:41:46.664218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a483988a-d5ec-4aea-a832-270f280ddc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10680d0>]}
[0m20:41:46.665510 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:41:46.666415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a483988a-d5ec-4aea-a832-270f280ddc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0fcbeb0>]}
[0m20:41:46.673173 [info ] [MainThread]: 
[0m20:41:46.675185 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:41:46.679616 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m20:41:46.739085 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:41:46.739984 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:41:46.740509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:46.809417 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.07 seconds
[0m20:41:46.816056 [debug] [ThreadPool]: On list_postgres: Close
[0m20:41:46.824006 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m20:41:46.853527 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:41:46.854266 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:41:46.854808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:46.893996 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m20:41:46.894922 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:41:46.895487 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:41:46.899189 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m20:41:46.905810 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:41:46.906762 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:41:46.929158 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:46.930011 [debug] [MainThread]: On master: BEGIN
[0m20:41:46.930555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:41:46.967314 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m20:41:46.968188 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:46.968698 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:41:46.972738 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m20:41:46.978133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a483988a-d5ec-4aea-a832-270f280ddc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0fe2d70>]}
[0m20:41:46.979136 [debug] [MainThread]: On master: ROLLBACK
[0m20:41:46.979794 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:46.980335 [debug] [MainThread]: On master: BEGIN
[0m20:41:46.981188 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:41:46.981772 [debug] [MainThread]: On master: COMMIT
[0m20:41:46.982303 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:46.982811 [debug] [MainThread]: On master: COMMIT
[0m20:41:46.983456 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:41:46.984038 [debug] [MainThread]: On master: Close
[0m20:41:46.985234 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:41:46.986142 [info ] [MainThread]: 
[0m20:41:46.999162 [debug] [Thread-1 (]: Began running node model.jaffle_shop.rugs
[0m20:41:47.000468 [info ] [Thread-1 (]: 1 of 1 START table model public.rugs ........................................... [RUN]
[0m20:41:47.002480 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.rugs"
[0m20:41:47.003142 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.rugs
[0m20:41:47.003676 [debug] [Thread-1 (]: Compiling model.jaffle_shop.rugs
[0m20:41:47.011608 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.rugs"
[0m20:41:47.013977 [debug] [Thread-1 (]: finished collecting timing info
[0m20:41:47.015214 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.rugs
[0m20:41:47.231100 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.rugs"
[0m20:41:47.233134 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m20:41:47.233668 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: BEGIN
[0m20:41:47.234160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:47.270950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m20:41:47.271788 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m20:41:47.272278 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */


  create  table "postgres"."public"."rugs__dbt_tmp"
  as (
    Select 
distinct *
from rugs_usa_parent
  );
[0m20:41:47.375152 [debug] [Thread-1 (]: SQL status: SELECT 5547 in 0.1 seconds
[0m20:41:47.412466 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m20:41:47.413258 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
alter table "postgres"."public"."rugs" rename to "rugs__dbt_backup"
[0m20:41:47.414495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:41:47.424965 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m20:41:47.425570 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
alter table "postgres"."public"."rugs__dbt_tmp" rename to "rugs"
[0m20:41:47.426402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:41:47.550921 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: COMMIT
[0m20:41:47.551762 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m20:41:47.552289 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: COMMIT
[0m20:41:47.566573 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m20:41:47.590626 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m20:41:47.591320 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
drop view if exists "postgres"."public"."rugs__dbt_backup" cascade
[0m20:41:47.596042 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:41:47.600648 [debug] [Thread-1 (]: finished collecting timing info
[0m20:41:47.601276 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: Close
[0m20:41:47.602841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a483988a-d5ec-4aea-a832-270f280ddc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf2361630>]}
[0m20:41:47.604271 [info ] [Thread-1 (]: 1 of 1 OK created table model public.rugs ...................................... [[32mSELECT 5547[0m in 0.60s]
[0m20:41:47.606032 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.rugs
[0m20:41:47.612344 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:41:47.613307 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:47.613845 [debug] [MainThread]: On master: BEGIN
[0m20:41:47.614372 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:41:47.651486 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m20:41:47.652476 [debug] [MainThread]: On master: COMMIT
[0m20:41:47.653020 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:47.653568 [debug] [MainThread]: On master: COMMIT
[0m20:41:47.654242 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:41:47.654780 [debug] [MainThread]: On master: Close
[0m20:41:47.656514 [info ] [MainThread]: 
[0m20:41:47.657444 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m20:41:47.658438 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:47.659152 [debug] [MainThread]: Connection 'model.jaffle_shop.rugs' was properly closed.
[0m20:41:47.693250 [info ] [MainThread]: 
[0m20:41:47.694274 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:41:47.695491 [info ] [MainThread]: 
[0m20:41:47.696920 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:41:47.698568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10bf610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf2362d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf2326050>]}


============================== 2024-07-19 20:47:09.384957 | d544fcb0-8aae-4f40-a545-7492d5a49697 ==============================
[0m20:47:09.385654 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:47:09.389797 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:47:09.390996 [debug] [MainThread]: Tracking: tracking
[0m20:47:09.419336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f33ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f32170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f31f30>]}
[0m20:47:09.516751 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:47:09.518086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd544fcb0-8aae-4f40-a545-7492d5a49697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1ab90>]}
[0m20:47:09.606697 [debug] [MainThread]: Parsing macros/relations.sql
[0m20:47:09.617559 [debug] [MainThread]: Parsing macros/catalog.sql
[0m20:47:09.631621 [debug] [MainThread]: Parsing macros/adapters.sql
[0m20:47:09.805702 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m20:47:09.813168 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m20:47:09.821656 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m20:47:09.863416 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m20:47:09.865740 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m20:47:09.871789 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m20:47:09.875101 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m20:47:09.884797 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m20:47:09.935891 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m20:47:09.962594 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m20:47:09.976866 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m20:47:09.985104 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m20:47:09.994387 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m20:47:09.998810 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m20:47:10.002471 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m20:47:10.007566 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m20:47:10.015570 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m20:47:10.052826 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m20:47:10.059897 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m20:47:10.066146 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m20:47:10.072300 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m20:47:10.077334 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m20:47:10.083234 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m20:47:10.087726 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m20:47:10.098088 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m20:47:10.111779 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m20:47:10.118771 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m20:47:10.123779 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m20:47:10.129313 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m20:47:10.135320 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m20:47:10.139631 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m20:47:10.145266 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m20:47:10.150257 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m20:47:10.156018 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m20:47:10.162043 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m20:47:10.167233 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m20:47:10.179214 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m20:47:10.186669 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m20:47:10.199799 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m20:47:10.222125 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m20:47:10.238700 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m20:47:10.272846 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m20:47:10.293051 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m20:47:10.326134 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m20:47:10.338995 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m20:47:10.346247 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m20:47:10.354916 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m20:47:10.454080 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m20:47:10.480512 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m20:47:10.575744 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m20:47:10.634841 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m20:47:10.745723 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m20:47:10.789203 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m20:47:10.861110 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m20:47:10.870408 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m20:47:10.948815 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m20:47:11.052735 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m20:47:11.062985 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m20:47:11.073113 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m20:47:11.100537 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m20:47:11.117247 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m20:47:11.132518 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m20:47:11.158828 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m20:47:11.216242 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m20:47:11.258729 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m20:47:11.340400 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m20:47:11.427123 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m20:47:11.439735 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m20:47:12.786282 [debug] [MainThread]: 1699: static parser successfully parsed silver/rugs.sql
[0m20:47:13.093119 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.gold

[0m20:47:13.124158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd544fcb0-8aae-4f40-a545-7492d5a49697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1084100>]}
[0m20:47:13.162923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd544fcb0-8aae-4f40-a545-7492d5a49697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1068130>]}
[0m20:47:13.164099 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:47:13.165022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd544fcb0-8aae-4f40-a545-7492d5a49697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0fbd180>]}
[0m20:47:13.171254 [info ] [MainThread]: 
[0m20:47:13.173302 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:47:13.177810 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m20:47:13.229653 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:47:13.230499 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:47:13.230999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:13.299054 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.07 seconds
[0m20:47:13.306616 [debug] [ThreadPool]: On list_postgres: Close
[0m20:47:13.309241 [debug] [ThreadPool]: Acquiring new postgres connection "create_postgres_public_silver"
[0m20:47:13.310481 [debug] [ThreadPool]: Acquiring new postgres connection "create_postgres_public_silver"
[0m20:47:13.311240 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='postgres', schema='public_silver', identifier=None)"
[0m20:47:13.338093 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_silver"
[0m20:47:13.338864 [debug] [ThreadPool]: On create_postgres_public_silver: BEGIN
[0m20:47:13.339371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:47:13.376754 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m20:47:13.377751 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_silver"
[0m20:47:13.378279 [debug] [ThreadPool]: On create_postgres_public_silver: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_postgres_public_silver"} */
create schema if not exists "public_silver"
[0m20:47:13.380513 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m20:47:13.384591 [debug] [ThreadPool]: On create_postgres_public_silver: COMMIT
[0m20:47:13.385390 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_silver"
[0m20:47:13.385953 [debug] [ThreadPool]: On create_postgres_public_silver: COMMIT
[0m20:47:13.387556 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m20:47:13.388204 [debug] [ThreadPool]: On create_postgres_public_silver: Close
[0m20:47:13.395574 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_silver"
[0m20:47:13.397403 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m20:47:13.434800 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_silver"
[0m20:47:13.449891 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:47:13.450376 [debug] [ThreadPool]: On list_postgres_public_silver: BEGIN
[0m20:47:13.450981 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:47:13.451580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:47:13.452224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:13.491138 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m20:47:13.492418 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_silver"
[0m20:47:13.492974 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m20:47:13.493620 [debug] [ThreadPool]: On list_postgres_public_silver: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_silver"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
  
[0m20:47:13.494240 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:47:13.495244 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:47:13.498610 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:47:13.499108 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:47:13.504295 [debug] [ThreadPool]: On list_postgres_public_silver: ROLLBACK
[0m20:47:13.509810 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:47:13.510799 [debug] [ThreadPool]: On list_postgres_public_silver: Close
[0m20:47:13.511414 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:47:13.534284 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:13.535089 [debug] [MainThread]: On master: BEGIN
[0m20:47:13.535590 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:47:13.572798 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m20:47:13.573704 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:13.574229 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:47:13.578160 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:47:13.583424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd544fcb0-8aae-4f40-a545-7492d5a49697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0fe2e90>]}
[0m20:47:13.584489 [debug] [MainThread]: On master: ROLLBACK
[0m20:47:13.585158 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:13.585659 [debug] [MainThread]: On master: BEGIN
[0m20:47:13.586530 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:47:13.587161 [debug] [MainThread]: On master: COMMIT
[0m20:47:13.587702 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:13.588197 [debug] [MainThread]: On master: COMMIT
[0m20:47:13.588798 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:47:13.589359 [debug] [MainThread]: On master: Close
[0m20:47:13.590605 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:47:13.591573 [info ] [MainThread]: 
[0m20:47:13.603638 [debug] [Thread-1 (]: Began running node model.jaffle_shop.rugs
[0m20:47:13.604902 [info ] [Thread-1 (]: 1 of 1 START table model public_silver.rugs .................................... [RUN]
[0m20:47:13.606724 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.rugs"
[0m20:47:13.607448 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.rugs
[0m20:47:13.608137 [debug] [Thread-1 (]: Compiling model.jaffle_shop.rugs
[0m20:47:13.615699 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.rugs"
[0m20:47:13.617693 [debug] [Thread-1 (]: finished collecting timing info
[0m20:47:13.618355 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.rugs
[0m20:47:13.838499 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.rugs"
[0m20:47:13.841322 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m20:47:13.841862 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: BEGIN
[0m20:47:13.842371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:13.879337 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m20:47:13.880199 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m20:47:13.880769 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */


  create  table "postgres"."public_silver"."rugs__dbt_tmp"
  as (
    Select 
distinct *
from rugs_usa_parent
  );
[0m20:47:13.909721 [debug] [Thread-1 (]: SQL status: SELECT 5547 in 0.03 seconds
[0m20:47:13.939989 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m20:47:13.940735 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
alter table "postgres"."public_silver"."rugs__dbt_tmp" rename to "rugs"
[0m20:47:13.941733 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:47:14.058870 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: COMMIT
[0m20:47:14.059777 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m20:47:14.060300 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: COMMIT
[0m20:47:14.077568 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m20:47:14.101733 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m20:47:14.102451 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
drop table if exists "postgres"."public_silver"."rugs__dbt_backup" cascade
[0m20:47:14.103431 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:47:14.107905 [debug] [Thread-1 (]: finished collecting timing info
[0m20:47:14.108520 [debug] [Thread-1 (]: On model.jaffle_shop.rugs: Close
[0m20:47:14.109976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd544fcb0-8aae-4f40-a545-7492d5a49697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10bcdc0>]}
[0m20:47:14.111278 [info ] [Thread-1 (]: 1 of 1 OK created table model public_silver.rugs ............................... [[32mSELECT 5547[0m in 0.50s]
[0m20:47:14.112885 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.rugs
[0m20:47:14.117720 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:47:14.118469 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:14.118993 [debug] [MainThread]: On master: BEGIN
[0m20:47:14.119480 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:47:14.155830 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m20:47:14.156688 [debug] [MainThread]: On master: COMMIT
[0m20:47:14.157230 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:14.157710 [debug] [MainThread]: On master: COMMIT
[0m20:47:14.158313 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:47:14.158852 [debug] [MainThread]: On master: Close
[0m20:47:14.160537 [info ] [MainThread]: 
[0m20:47:14.161403 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m20:47:14.162391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:47:14.162949 [debug] [MainThread]: Connection 'list_postgres_public_silver' was properly closed.
[0m20:47:14.163439 [debug] [MainThread]: Connection 'model.jaffle_shop.rugs' was properly closed.
[0m20:47:14.195521 [info ] [MainThread]: 
[0m20:47:14.196484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:47:14.197669 [info ] [MainThread]: 
[0m20:47:14.198578 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:47:14.199806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab108d9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf2326e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab109e560>]}


============================== 2024-07-21 16:08:07.420601 | 9c4b6dd1-dccb-42ad-9540-e0b93ef47d2a ==============================
[0m16:08:07.421154 [info ] [MainThread]: Running with dbt=1.2.0
[0m16:08:07.424836 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:08:07.425800 [debug] [MainThread]: Tracking: tracking
[0m16:08:07.454154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f347f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f376d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f37790>]}
[0m16:08:07.598702 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:08:07.600176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9c4b6dd1-dccb-42ad-9540-e0b93ef47d2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1d570>]}
[0m16:08:07.740839 [debug] [MainThread]: Parsing macros/relations.sql
[0m16:08:07.752879 [debug] [MainThread]: Parsing macros/catalog.sql
[0m16:08:07.767212 [debug] [MainThread]: Parsing macros/adapters.sql
[0m16:08:07.929736 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:08:07.937162 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:08:07.945770 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:08:07.987181 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:08:07.989624 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:08:07.995494 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:08:07.998835 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m16:08:08.008498 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m16:08:08.059022 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m16:08:08.085593 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m16:08:08.099645 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m16:08:08.107787 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m16:08:08.117011 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m16:08:08.121351 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m16:08:08.124991 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m16:08:08.129727 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m16:08:08.137469 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m16:08:08.173368 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m16:08:08.180188 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m16:08:08.186437 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m16:08:08.192507 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m16:08:08.197323 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m16:08:08.203054 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m16:08:08.207458 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:08:08.217591 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:08:08.231047 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:08:08.238626 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m16:08:08.243909 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m16:08:08.249563 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m16:08:08.255692 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m16:08:08.260066 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m16:08:08.265773 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:08:08.270880 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m16:08:08.276539 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m16:08:08.282495 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m16:08:08.287629 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:08:08.299366 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:08:08.306766 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m16:08:08.319741 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m16:08:08.341787 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m16:08:08.358063 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m16:08:08.391750 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m16:08:08.411625 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m16:08:08.444172 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m16:08:08.456799 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m16:08:08.463788 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m16:08:08.472354 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m16:08:08.571277 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m16:08:08.598186 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m16:08:08.692951 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m16:08:08.751110 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m16:08:08.861228 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m16:08:08.903967 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m16:08:08.975409 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m16:08:08.984888 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m16:08:09.061816 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m16:08:09.164329 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m16:08:09.174491 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m16:08:09.184645 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m16:08:09.211766 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m16:08:09.228357 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m16:08:09.243527 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m16:08:09.269772 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m16:08:09.327116 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m16:08:09.369363 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m16:08:09.451628 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m16:08:09.538567 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m16:08:09.551138 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m16:08:10.908819 [debug] [MainThread]: 1699: static parser successfully parsed staging/rugs_usa_parent.sql
[0m16:08:10.975585 [debug] [MainThread]: 1699: static parser successfully parsed silver/rugs.sql
[0m16:08:11.225798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab107a1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10be350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab108ae90>]}


============================== 2024-07-21 16:09:29.188074 | e31946b0-a47e-4092-ba6b-249a4b60d9de ==============================
[0m16:09:29.188653 [info ] [MainThread]: Running with dbt=1.2.0
[0m16:09:29.192799 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:09:29.193747 [debug] [MainThread]: Tracking: tracking
[0m16:09:29.220638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f227a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f23d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f22620>]}
[0m16:09:29.409137 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:09:29.410828 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/parent_product.sql
[0m16:09:29.411546 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/staging/rugs_usa_parent.sql
[0m16:09:29.497116 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_product.sql
[0m16:09:29.587984 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.gold

[0m16:09:29.617534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e31946b0-a47e-4092-ba6b-249a4b60d9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10dd240>]}
[0m16:09:29.659467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e31946b0-a47e-4092-ba6b-249a4b60d9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1073be0>]}
[0m16:09:29.660758 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:09:29.661901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e31946b0-a47e-4092-ba6b-249a4b60d9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1ea70>]}
[0m16:09:29.668262 [info ] [MainThread]: 
[0m16:09:29.670240 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:09:29.675417 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m16:09:29.677741 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m16:09:29.760158 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:09:29.761123 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:09:29.761830 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:09:29.762445 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:09:29.762994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:29.763618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:29.851048 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.09 seconds
[0m16:09:29.851825 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.09 seconds
[0m16:09:29.858242 [debug] [ThreadPool]: On list_postgres: Close
[0m16:09:29.863103 [debug] [ThreadPool]: On list_postgres: Close
[0m16:09:29.866721 [debug] [ThreadPool]: Acquiring new postgres connection "create_postgres_public_staging"
[0m16:09:29.868011 [debug] [ThreadPool]: Acquiring new postgres connection "create_postgres_public_staging"
[0m16:09:29.868748 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='postgres', schema='public_staging', identifier=None)"
[0m16:09:29.895016 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m16:09:29.895799 [debug] [ThreadPool]: On create_postgres_public_staging: BEGIN
[0m16:09:29.896351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:29.933719 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m16:09:29.934617 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m16:09:29.935158 [debug] [ThreadPool]: On create_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_postgres_public_staging"} */
create schema if not exists "public_staging"
[0m16:09:29.937083 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m16:09:29.940759 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m16:09:29.941318 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m16:09:29.941840 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m16:09:29.944183 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m16:09:29.944773 [debug] [ThreadPool]: On create_postgres_public_staging: Close
[0m16:09:29.952260 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m16:09:29.954019 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m16:09:29.993389 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m16:09:30.007989 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m16:09:30.007585 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:09:30.008649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:30.009390 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:09:30.011159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:30.048744 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m16:09:30.049432 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m16:09:30.050129 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:09:30.050755 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m16:09:30.051373 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:09:30.051949 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m16:09:30.058566 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m16:09:30.064798 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:09:30.065328 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m16:09:30.066279 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:09:30.070714 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m16:09:30.072652 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_silver"
[0m16:09:30.074038 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m16:09:30.081346 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_silver"
[0m16:09:30.082995 [debug] [ThreadPool]: On list_postgres_public_silver: BEGIN
[0m16:09:30.083521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:30.120099 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m16:09:30.120982 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_silver"
[0m16:09:30.121489 [debug] [ThreadPool]: On list_postgres_public_silver: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_silver"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
  
[0m16:09:30.124781 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:09:30.129953 [debug] [ThreadPool]: On list_postgres_public_silver: ROLLBACK
[0m16:09:30.130613 [debug] [ThreadPool]: On list_postgres_public_silver: Close
[0m16:09:30.151779 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:30.152659 [debug] [MainThread]: On master: BEGIN
[0m16:09:30.153154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:30.196455 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:09:30.197398 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:30.197908 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:09:30.208118 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m16:09:30.213432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e31946b0-a47e-4092-ba6b-249a4b60d9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1073f40>]}
[0m16:09:30.214524 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:30.215196 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:30.215702 [debug] [MainThread]: On master: BEGIN
[0m16:09:30.216546 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:30.217143 [debug] [MainThread]: On master: COMMIT
[0m16:09:30.217627 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:30.218088 [debug] [MainThread]: On master: COMMIT
[0m16:09:30.218695 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:09:30.219226 [debug] [MainThread]: On master: Close
[0m16:09:30.220480 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:09:30.221453 [info ] [MainThread]: 
[0m16:09:30.233298 [debug] [Thread-1 (]: Began running node model.jaffle_shop.parent_product
[0m16:09:30.234078 [debug] [Thread-2 (]: Began running node model.jaffle_shop.rugs
[0m16:09:30.235343 [info ] [Thread-1 (]: 1 of 2 START view model public_staging.parent_product .......................... [RUN]
[0m16:09:30.236625 [info ] [Thread-2 (]: 2 of 2 START table model public_silver.rugs .................................... [RUN]
[0m16:09:30.238741 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.parent_product"
[0m16:09:30.241007 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.rugs"
[0m16:09:30.241876 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.parent_product
[0m16:09:30.242537 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.rugs
[0m16:09:30.243160 [debug] [Thread-1 (]: Compiling model.jaffle_shop.parent_product
[0m16:09:30.243771 [debug] [Thread-2 (]: Compiling model.jaffle_shop.rugs
[0m16:09:30.251477 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.parent_product"
[0m16:09:30.258240 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.rugs"
[0m16:09:30.260957 [debug] [Thread-2 (]: finished collecting timing info
[0m16:09:30.261755 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.rugs
[0m16:09:30.262120 [debug] [Thread-1 (]: finished collecting timing info
[0m16:09:30.282717 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.parent_product
[0m16:09:30.634562 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.parent_product"
[0m16:09:30.644487 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.rugs"
[0m16:09:30.647077 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:09:30.648115 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: BEGIN
[0m16:09:30.648636 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:30.647746 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:09:30.651309 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: BEGIN
[0m16:09:30.655408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:30.687890 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m16:09:30.693601 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:09:30.694186 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */


  create  table "postgres"."public_silver"."rugs__dbt_tmp"
  as (
    Select 
distinct *
from rugs_usa_parent
  );
[0m16:09:30.695239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m16:09:30.695995 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:09:30.696609 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */

  create view "postgres"."public_staging"."parent_product__dbt_tmp" as (
    Select
pid as parent_product_id,
parent_product_type_id,
name as parent_product_name,
url as parent_product_url,
split_part(url, '/', 5) as color_derived_url,
thickness,
material,
weave_feature, 
brand,
category,
availability,
clearance,
dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc
from (Select distinct * from rugs_usa_parent) as rugs_usa_parent
  );
[0m16:09:30.699462 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "parent_product_type_id" does not exist
LINE 6: parent_product_type_id,
        ^

[0m16:09:30.700285 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: ROLLBACK
[0m16:09:30.701555 [debug] [Thread-1 (]: finished collecting timing info
[0m16:09:30.702240 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: Close
[0m16:09:30.703967 [debug] [Thread-1 (]: Database Error in model parent_product (models/staging/parent_product.sql)
  column "parent_product_type_id" does not exist
  LINE 6: parent_product_type_id,
          ^
  compiled SQL at target/run/jaffle_shop/models/staging/parent_product.sql
[0m16:09:30.705292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e31946b0-a47e-4092-ba6b-249a4b60d9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf22ff760>]}
[0m16:09:30.706630 [error] [Thread-1 (]: 1 of 2 ERROR creating view model public_staging.parent_product ................. [[31mERROR[0m in 0.47s]
[0m16:09:30.708737 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.parent_product
[0m16:09:30.797980 [debug] [Thread-2 (]: SQL status: SELECT 5547 in 0.1 seconds
[0m16:09:30.829158 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:09:30.829967 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
alter table "postgres"."public_silver"."rugs" rename to "rugs__dbt_backup"
[0m16:09:30.831019 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:30.841089 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:09:30.841712 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
alter table "postgres"."public_silver"."rugs__dbt_tmp" rename to "rugs"
[0m16:09:30.842583 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:30.970892 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: COMMIT
[0m16:09:30.972111 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:09:30.972717 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: COMMIT
[0m16:09:30.988722 [debug] [Thread-2 (]: SQL status: COMMIT in 0.02 seconds
[0m16:09:31.013402 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:09:31.014244 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
drop table if exists "postgres"."public_silver"."rugs__dbt_backup" cascade
[0m16:09:31.023705 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.01 seconds
[0m16:09:31.028966 [debug] [Thread-2 (]: finished collecting timing info
[0m16:09:31.029707 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: Close
[0m16:09:31.031347 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e31946b0-a47e-4092-ba6b-249a4b60d9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf2315ae0>]}
[0m16:09:31.032797 [info ] [Thread-2 (]: 2 of 2 OK created table model public_silver.rugs ............................... [[32mSELECT 5547[0m in 0.79s]
[0m16:09:31.034329 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.rugs
[0m16:09:31.039211 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:09:31.040074 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:31.040689 [debug] [MainThread]: On master: BEGIN
[0m16:09:31.041174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:31.079625 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:09:31.080556 [debug] [MainThread]: On master: COMMIT
[0m16:09:31.081063 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:31.081530 [debug] [MainThread]: On master: COMMIT
[0m16:09:31.082097 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:09:31.082621 [debug] [MainThread]: On master: Close
[0m16:09:31.084332 [info ] [MainThread]: 
[0m16:09:31.085227 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m16:09:31.086277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:31.086833 [debug] [MainThread]: Connection 'model.jaffle_shop.rugs' was properly closed.
[0m16:09:31.087287 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_product' was properly closed.
[0m16:09:31.121122 [info ] [MainThread]: 
[0m16:09:31.122059 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:09:31.123249 [info ] [MainThread]: 
[0m16:09:31.124216 [error] [MainThread]: [33mDatabase Error in model parent_product (models/staging/parent_product.sql)[0m
[0m16:09:31.125138 [error] [MainThread]:   column "parent_product_type_id" does not exist
[0m16:09:31.126020 [error] [MainThread]:   LINE 6: parent_product_type_id,
[0m16:09:31.126828 [error] [MainThread]:           ^
[0m16:09:31.127603 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/staging/parent_product.sql
[0m16:09:31.128420 [info ] [MainThread]: 
[0m16:09:31.129231 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:09:31.130512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf233f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf238a170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1072440>]}


============================== 2024-07-21 16:10:44.824317 | 15c6f8ac-9127-41ad-8282-009421b4fcbe ==============================
[0m16:10:44.824846 [info ] [MainThread]: Running with dbt=1.2.0
[0m16:10:44.829052 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:10:44.829909 [debug] [MainThread]: Tracking: tracking
[0m16:10:44.853378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f31a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f30280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f301f0>]}
[0m16:10:45.042303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:10:45.044351 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/parent_product.sql
[0m16:10:45.127709 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_product.sql
[0m16:10:45.213079 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.gold

[0m16:10:45.243445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15c6f8ac-9127-41ad-8282-009421b4fcbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10d5240>]}
[0m16:10:45.287942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15c6f8ac-9127-41ad-8282-009421b4fcbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10711b0>]}
[0m16:10:45.290384 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:10:45.292597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15c6f8ac-9127-41ad-8282-009421b4fcbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1073ca0>]}
[0m16:10:45.299636 [info ] [MainThread]: 
[0m16:10:45.301660 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:10:45.306619 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m16:10:45.308683 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m16:10:45.401841 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:10:45.411661 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:10:45.412138 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:10:45.412768 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:10:45.413460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:45.414083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:45.491788 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.08 seconds
[0m16:10:45.492535 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.08 seconds
[0m16:10:45.498755 [debug] [ThreadPool]: On list_postgres: Close
[0m16:10:45.503687 [debug] [ThreadPool]: On list_postgres: Close
[0m16:10:45.512198 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m16:10:45.513813 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_silver"
[0m16:10:45.544004 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m16:10:45.551006 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_silver"
[0m16:10:45.551723 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m16:10:45.552311 [debug] [ThreadPool]: On list_postgres_public_silver: BEGIN
[0m16:10:45.552948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:45.553556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:45.592544 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m16:10:45.593777 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m16:10:45.594325 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m16:10:45.594932 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m16:10:45.595511 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_silver"
[0m16:10:45.596442 [debug] [ThreadPool]: On list_postgres_public_silver: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_silver"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
  
[0m16:10:45.598815 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:10:45.599510 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:10:45.604445 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m16:10:45.609383 [debug] [ThreadPool]: On list_postgres_public_silver: ROLLBACK
[0m16:10:45.610289 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m16:10:45.610886 [debug] [ThreadPool]: On list_postgres_public_silver: Close
[0m16:10:45.612620 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m16:10:45.621257 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:10:45.621811 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:10:45.622315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:45.658763 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m16:10:45.659617 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:10:45.660146 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:10:45.662559 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:10:45.668174 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:10:45.668863 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:10:45.693248 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:45.694132 [debug] [MainThread]: On master: BEGIN
[0m16:10:45.694666 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:45.732747 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:10:45.733579 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:45.734056 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:10:45.738890 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:10:45.743995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15c6f8ac-9127-41ad-8282-009421b4fcbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1073ee0>]}
[0m16:10:45.745087 [debug] [MainThread]: On master: ROLLBACK
[0m16:10:45.745729 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:45.746246 [debug] [MainThread]: On master: BEGIN
[0m16:10:45.747064 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:10:45.747633 [debug] [MainThread]: On master: COMMIT
[0m16:10:45.748172 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:45.748765 [debug] [MainThread]: On master: COMMIT
[0m16:10:45.749525 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:10:45.750084 [debug] [MainThread]: On master: Close
[0m16:10:45.751319 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:10:45.752233 [info ] [MainThread]: 
[0m16:10:45.764825 [debug] [Thread-1 (]: Began running node model.jaffle_shop.parent_product
[0m16:10:45.765517 [debug] [Thread-2 (]: Began running node model.jaffle_shop.rugs
[0m16:10:45.766630 [info ] [Thread-1 (]: 1 of 2 START view model public_staging.parent_product .......................... [RUN]
[0m16:10:45.767692 [info ] [Thread-2 (]: 2 of 2 START table model public_silver.rugs .................................... [RUN]
[0m16:10:45.769413 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.parent_product"
[0m16:10:45.771162 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.rugs"
[0m16:10:45.771840 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.parent_product
[0m16:10:45.772528 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.rugs
[0m16:10:45.773163 [debug] [Thread-1 (]: Compiling model.jaffle_shop.parent_product
[0m16:10:45.773789 [debug] [Thread-2 (]: Compiling model.jaffle_shop.rugs
[0m16:10:45.782287 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.parent_product"
[0m16:10:45.789589 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.rugs"
[0m16:10:45.792434 [debug] [Thread-1 (]: finished collecting timing info
[0m16:10:45.793212 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.parent_product
[0m16:10:45.793599 [debug] [Thread-2 (]: finished collecting timing info
[0m16:10:45.814089 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.rugs
[0m16:10:46.176036 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.parent_product"
[0m16:10:46.181659 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.rugs"
[0m16:10:46.184834 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:10:46.185334 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:10:46.186349 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: BEGIN
[0m16:10:46.186868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:46.185828 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: BEGIN
[0m16:10:46.189595 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:46.225667 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m16:10:46.226657 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:10:46.227244 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */

  create view "postgres"."public_staging"."parent_product__dbt_tmp" as (
    Select
pid as parent_product_id,
product_type_id as parent_product_type_id,
name as parent_product_name,
url as parent_product_url,
split_part(url, '/', 5) as color_derived_url,
thickness,
material,
weave_feature, 
brand,
category,
availability,
clearance,
dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc
from (Select distinct * from rugs_usa_parent) as rugs_usa_parent
  );
[0m16:10:46.228018 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m16:10:46.228875 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:10:46.229488 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */


  create  table "postgres"."public_silver"."rugs__dbt_tmp"
  as (
    Select 
distinct *
from rugs_usa_parent
  );
[0m16:10:46.233987 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:10:46.268976 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:10:46.270339 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product__dbt_tmp" rename to "parent_product"
[0m16:10:46.272496 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:10:46.313556 [debug] [Thread-2 (]: SQL status: SELECT 5547 in 0.08 seconds
[0m16:10:46.356592 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:10:46.372938 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
alter table "postgres"."public_silver"."rugs" rename to "rugs__dbt_backup"
[0m16:10:46.387123 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: COMMIT
[0m16:10:46.387583 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:10:46.388236 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:10:46.399579 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: COMMIT
[0m16:10:46.399035 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:10:46.400427 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
alter table "postgres"."public_silver"."rugs__dbt_tmp" rename to "rugs"
[0m16:10:46.401320 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:10:46.438055 [debug] [Thread-1 (]: SQL status: COMMIT in 0.04 seconds
[0m16:10:46.449759 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: COMMIT
[0m16:10:46.474167 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:10:46.474691 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: COMMIT
[0m16:10:46.473691 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:10:46.475589 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
drop view if exists "postgres"."public_staging"."parent_product__dbt_backup" cascade
[0m16:10:46.476142 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:10:46.477120 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:10:46.484765 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:10:46.489921 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
drop table if exists "postgres"."public_silver"."rugs__dbt_backup" cascade
[0m16:10:46.489322 [debug] [Thread-1 (]: finished collecting timing info
[0m16:10:46.490863 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: Close
[0m16:10:46.493277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15c6f8ac-9127-41ad-8282-009421b4fcbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf238b190>]}
[0m16:10:46.493902 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:10:46.495197 [info ] [Thread-1 (]: 1 of 2 OK created view model public_staging.parent_product ..................... [[32mCREATE VIEW[0m in 0.72s]
[0m16:10:46.499955 [debug] [Thread-2 (]: finished collecting timing info
[0m16:10:46.502273 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: Close
[0m16:10:46.501535 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.parent_product
[0m16:10:46.504449 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15c6f8ac-9127-41ad-8282-009421b4fcbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf2372e00>]}
[0m16:10:46.507109 [info ] [Thread-2 (]: 2 of 2 OK created table model public_silver.rugs ............................... [[32mSELECT 5547[0m in 0.73s]
[0m16:10:46.508546 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.rugs
[0m16:10:46.514355 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:10:46.515353 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:46.515889 [debug] [MainThread]: On master: BEGIN
[0m16:10:46.516406 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:46.553714 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:10:46.554649 [debug] [MainThread]: On master: COMMIT
[0m16:10:46.555182 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:46.555714 [debug] [MainThread]: On master: COMMIT
[0m16:10:46.556405 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:10:46.556995 [debug] [MainThread]: On master: Close
[0m16:10:46.558733 [info ] [MainThread]: 
[0m16:10:46.559699 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m16:10:46.560773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:46.561491 [debug] [MainThread]: Connection 'model.jaffle_shop.rugs' was properly closed.
[0m16:10:46.562047 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_product' was properly closed.
[0m16:10:46.597986 [info ] [MainThread]: 
[0m16:10:46.599088 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:46.600225 [info ] [MainThread]: 
[0m16:10:46.601060 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:10:46.602342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1073850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1073880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf23abe80>]}


============================== 2024-07-21 16:24:15.340093 | 6d111386-c18c-4a49-81e2-e3c00c1dc55f ==============================
[0m16:24:15.340750 [info ] [MainThread]: Running with dbt=1.2.0
[0m16:24:15.345103 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:24:15.346049 [debug] [MainThread]: Tracking: tracking
[0m16:24:15.391115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f347f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f376d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f37790>]}
[0m16:24:15.489990 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:24:15.491344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d111386-c18c-4a49-81e2-e3c00c1dc55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1e7a0>]}
[0m16:24:15.583237 [debug] [MainThread]: Parsing macros/relations.sql
[0m16:24:15.594045 [debug] [MainThread]: Parsing macros/catalog.sql
[0m16:24:15.607709 [debug] [MainThread]: Parsing macros/adapters.sql
[0m16:24:15.765147 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:24:15.772404 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:24:15.780818 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:24:15.821506 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:24:15.823843 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:24:15.829613 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:24:15.832821 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m16:24:15.842299 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m16:24:15.892021 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m16:24:15.917866 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m16:24:15.931818 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m16:24:15.940091 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m16:24:15.949240 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m16:24:15.953602 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m16:24:15.957150 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m16:24:15.961850 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m16:24:15.969553 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m16:24:16.004915 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m16:24:16.011736 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m16:24:16.017819 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m16:24:16.023524 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m16:24:16.028328 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m16:24:16.034200 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m16:24:16.038406 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:24:16.048413 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:24:16.061615 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:24:16.068447 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m16:24:16.073315 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m16:24:16.078673 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m16:24:16.084467 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m16:24:16.088587 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m16:24:16.093980 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:24:16.098886 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m16:24:16.104444 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m16:24:16.110269 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m16:24:16.115323 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:24:16.126969 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:24:16.135147 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m16:24:16.148317 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m16:24:16.170363 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m16:24:16.186530 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m16:24:16.220225 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m16:24:16.239806 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m16:24:16.272331 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m16:24:16.285246 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m16:24:16.292280 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m16:24:16.300649 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m16:24:16.398014 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m16:24:16.423402 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m16:24:16.516081 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m16:24:16.572489 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m16:24:16.682821 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m16:24:16.724554 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m16:24:16.795468 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m16:24:16.804837 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m16:24:16.880732 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m16:24:16.978863 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m16:24:16.988782 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m16:24:16.998652 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m16:24:17.025219 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m16:24:17.041520 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m16:24:17.056484 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m16:24:17.081957 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m16:24:17.138207 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m16:24:17.192555 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m16:24:17.272266 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m16:24:17.358368 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m16:24:17.370934 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m16:24:18.675872 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_product.sql
[0m16:24:18.737686 [debug] [MainThread]: 1699: static parser successfully parsed silver/rugs.sql
[0m16:24:18.980628 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.gold

[0m16:24:19.012969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d111386-c18c-4a49-81e2-e3c00c1dc55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10904f0>]}
[0m16:24:19.057031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d111386-c18c-4a49-81e2-e3c00c1dc55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10da6e0>]}
[0m16:24:19.058410 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:24:19.059608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d111386-c18c-4a49-81e2-e3c00c1dc55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0fbde40>]}
[0m16:24:19.066169 [info ] [MainThread]: 
[0m16:24:19.068287 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:24:19.073462 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m16:24:19.076122 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m16:24:19.160303 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:24:19.161334 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:24:19.162092 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:24:19.162718 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:24:19.163252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:19.163849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:19.245716 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.08 seconds
[0m16:24:19.246490 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.08 seconds
[0m16:24:19.252805 [debug] [ThreadPool]: On list_postgres: Close
[0m16:24:19.257690 [debug] [ThreadPool]: On list_postgres: Close
[0m16:24:19.265820 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m16:24:19.267286 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m16:24:19.297428 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m16:24:19.304365 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:24:19.305088 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m16:24:19.305732 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:24:19.306315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:24:19.306885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:24:19.346029 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m16:24:19.347117 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m16:24:19.347565 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m16:24:19.348190 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:24:19.348757 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m16:24:19.349335 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:24:19.352878 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:24:19.353387 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:24:19.358624 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m16:24:19.363916 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:24:19.364914 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m16:24:19.365502 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:24:19.367115 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_silver"
[0m16:24:19.376259 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_silver"
[0m16:24:19.376867 [debug] [ThreadPool]: On list_postgres_public_silver: BEGIN
[0m16:24:19.377332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:24:19.415075 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m16:24:19.416103 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_silver"
[0m16:24:19.416643 [debug] [ThreadPool]: On list_postgres_public_silver: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_silver"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
  
[0m16:24:19.419343 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:24:19.424421 [debug] [ThreadPool]: On list_postgres_public_silver: ROLLBACK
[0m16:24:19.425125 [debug] [ThreadPool]: On list_postgres_public_silver: Close
[0m16:24:19.446185 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:19.446987 [debug] [MainThread]: On master: BEGIN
[0m16:24:19.447477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:24:19.483576 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:24:19.484395 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:19.484913 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:24:19.488858 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:24:19.494137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d111386-c18c-4a49-81e2-e3c00c1dc55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10904f0>]}
[0m16:24:19.495119 [debug] [MainThread]: On master: ROLLBACK
[0m16:24:19.495769 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:19.496297 [debug] [MainThread]: On master: BEGIN
[0m16:24:19.497170 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:24:19.497753 [debug] [MainThread]: On master: COMMIT
[0m16:24:19.498266 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:19.498819 [debug] [MainThread]: On master: COMMIT
[0m16:24:19.499508 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:24:19.500103 [debug] [MainThread]: On master: Close
[0m16:24:19.501390 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:24:19.502308 [info ] [MainThread]: 
[0m16:24:19.516195 [debug] [Thread-1 (]: Began running node model.jaffle_shop.parent_product
[0m16:24:19.517113 [debug] [Thread-2 (]: Began running node model.jaffle_shop.rugs
[0m16:24:19.518389 [info ] [Thread-1 (]: 1 of 2 START view model public_staging.parent_product .......................... [RUN]
[0m16:24:19.519551 [info ] [Thread-2 (]: 2 of 2 START table model public_silver.rugs .................................... [RUN]
[0m16:24:19.521451 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.parent_product"
[0m16:24:19.524040 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.rugs"
[0m16:24:19.525105 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.parent_product
[0m16:24:19.525856 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.rugs
[0m16:24:19.526593 [debug] [Thread-1 (]: Compiling model.jaffle_shop.parent_product
[0m16:24:19.527273 [debug] [Thread-2 (]: Compiling model.jaffle_shop.rugs
[0m16:24:19.538974 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.parent_product"
[0m16:24:19.547076 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.rugs"
[0m16:24:19.550527 [debug] [Thread-1 (]: finished collecting timing info
[0m16:24:19.550930 [debug] [Thread-2 (]: finished collecting timing info
[0m16:24:19.552188 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.rugs
[0m16:24:19.551543 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.parent_product
[0m16:24:19.918380 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.parent_product"
[0m16:24:19.945865 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.rugs"
[0m16:24:19.947055 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:24:19.947909 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: BEGIN
[0m16:24:19.948753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:19.949744 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:24:19.951256 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: BEGIN
[0m16:24:19.952616 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:24:19.989479 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m16:24:19.991045 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:24:19.991591 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */

  create view "postgres"."public_staging"."parent_product__dbt_tmp" as (
    with base as (
    Select
        md5(pid || split_part(url, '/', 5)) as parent_product_uuid,
        pid as parent_product_id,
        product_type_id as parent_product_type_id,
        name as parent_product_name,
        url as parent_product_url,
        split_part(url, '/', 5) as color_derived_url,
        thickness,
        material,
        weave_feature, 
        brand,
        category,
        availability,
        clearance,
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, split_part(url, '/', 5) order by dw_insert_timestamp desc) as row_num
    from rugs_usa_parent
)


Select *
from base 
where row_num = 1
  );
[0m16:24:19.990591 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m16:24:19.992459 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:24:19.993077 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */


  create  table "postgres"."public_silver"."rugs__dbt_tmp"
  as (
    Select 
distinct *
from rugs_usa_parent
  );
[0m16:24:19.997585 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:24:20.035103 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:24:20.036219 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product" rename to "parent_product__dbt_backup"
[0m16:24:20.037917 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:24:20.050382 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:24:20.051687 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product__dbt_tmp" rename to "parent_product"
[0m16:24:20.051017 [debug] [Thread-2 (]: SQL status: SELECT 5547 in 0.06 seconds
[0m16:24:20.059876 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m16:24:20.063052 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:24:20.093940 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
alter table "postgres"."public_silver"."rugs" rename to "rugs__dbt_backup"
[0m16:24:20.114204 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m16:24:20.219100 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:24:20.235932 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
alter table "postgres"."public_silver"."rugs__dbt_tmp" rename to "rugs"
[0m16:24:20.250156 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: COMMIT
[0m16:24:20.250572 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:24:20.251222 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:24:20.276931 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: COMMIT
[0m16:24:20.279455 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: COMMIT
[0m16:24:20.280401 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:24:20.280907 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: COMMIT
[0m16:24:20.307581 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m16:24:20.318455 [debug] [Thread-2 (]: SQL status: COMMIT in 0.04 seconds
[0m16:24:20.334032 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:24:20.342367 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
drop view if exists "postgres"."public_staging"."parent_product__dbt_backup" cascade
[0m16:24:20.341465 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:24:20.343283 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
drop table if exists "postgres"."public_silver"."rugs__dbt_backup" cascade
[0m16:24:20.344911 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:24:20.350194 [debug] [Thread-1 (]: finished collecting timing info
[0m16:24:20.351273 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: Close
[0m16:24:20.350638 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.01 seconds
[0m16:24:20.352942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d111386-c18c-4a49-81e2-e3c00c1dc55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaaf6df610>]}
[0m16:24:20.357312 [debug] [Thread-2 (]: finished collecting timing info
[0m16:24:20.359604 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: Close
[0m16:24:20.360995 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d111386-c18c-4a49-81e2-e3c00c1dc55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf232e440>]}
[0m16:24:20.362234 [info ] [Thread-2 (]: 2 of 2 OK created table model public_silver.rugs ............................... [[32mSELECT 5547[0m in 0.84s]
[0m16:24:20.358644 [info ] [Thread-1 (]: 1 of 2 OK created view model public_staging.parent_product ..................... [[32mCREATE VIEW[0m in 0.83s]
[0m16:24:20.363851 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.rugs
[0m16:24:20.365493 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.parent_product
[0m16:24:20.371429 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:24:20.372352 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:20.373070 [debug] [MainThread]: On master: BEGIN
[0m16:24:20.373923 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:24:20.413363 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:24:20.414402 [debug] [MainThread]: On master: COMMIT
[0m16:24:20.414928 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:20.415424 [debug] [MainThread]: On master: COMMIT
[0m16:24:20.416135 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:24:20.416718 [debug] [MainThread]: On master: Close
[0m16:24:20.418487 [info ] [MainThread]: 
[0m16:24:20.419363 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m16:24:20.420587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:20.421376 [debug] [MainThread]: Connection 'model.jaffle_shop.rugs' was properly closed.
[0m16:24:20.421959 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_product' was properly closed.
[0m16:24:20.456998 [info ] [MainThread]: 
[0m16:24:20.458214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:24:20.459490 [info ] [MainThread]: 
[0m16:24:20.460362 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:24:20.461604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd143a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd14520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd14a60>]}


============================== 2024-07-21 16:24:57.899278 | 0c12a9c1-09d2-4140-80b4-7c4eb081b024 ==============================
[0m16:24:57.899855 [info ] [MainThread]: Running with dbt=1.2.0
[0m16:24:57.904564 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:24:57.905516 [debug] [MainThread]: Tracking: tracking
[0m16:24:57.930796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f74070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f74160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f74100>]}
[0m16:24:58.034367 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:24:58.035861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0c12a9c1-09d2-4140-80b4-7c4eb081b024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f2b040>]}
[0m16:24:58.136004 [debug] [MainThread]: Parsing macros/relations.sql
[0m16:24:58.147154 [debug] [MainThread]: Parsing macros/catalog.sql
[0m16:24:58.161926 [debug] [MainThread]: Parsing macros/adapters.sql
[0m16:24:58.335429 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:24:58.343193 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:24:58.351832 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:24:58.394403 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:24:58.396844 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:24:58.402783 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:24:58.406069 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m16:24:58.416010 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m16:24:58.467532 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m16:24:58.495708 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m16:24:58.510445 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m16:24:58.518717 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m16:24:58.528065 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m16:24:58.532529 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m16:24:58.536233 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m16:24:58.541094 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m16:24:58.549045 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m16:24:58.585659 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m16:24:58.592663 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m16:24:58.598859 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m16:24:58.604800 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m16:24:58.609768 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m16:24:58.615685 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m16:24:58.620037 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:24:58.630294 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:24:58.643950 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:24:58.650884 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m16:24:58.655833 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m16:24:58.661283 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m16:24:58.667254 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m16:24:58.671557 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m16:24:58.677360 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:24:58.682384 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m16:24:58.688156 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m16:24:58.694123 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m16:24:58.699291 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:24:58.711182 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:24:58.718651 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m16:24:58.731921 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m16:24:58.754564 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m16:24:58.774583 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m16:24:58.812123 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m16:24:58.833145 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m16:24:58.867179 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m16:24:58.880354 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m16:24:58.887566 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m16:24:58.896165 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m16:24:58.998776 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m16:24:59.025357 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m16:24:59.122205 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m16:24:59.181271 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m16:24:59.294309 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m16:24:59.337518 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m16:24:59.412406 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m16:24:59.422324 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m16:24:59.501477 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m16:24:59.610653 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m16:24:59.621658 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m16:24:59.631947 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m16:24:59.659730 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m16:24:59.676652 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m16:24:59.692059 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m16:24:59.718590 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m16:24:59.777550 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m16:24:59.821076 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m16:24:59.903333 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m16:24:59.991964 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m16:25:00.004573 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m16:25:01.336245 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_product.sql
[0m16:25:01.399804 [debug] [MainThread]: 1699: static parser successfully parsed silver/rugs.sql
[0m16:25:01.650384 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.gold

[0m16:25:01.683645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c12a9c1-09d2-4140-80b4-7c4eb081b024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1090730>]}
[0m16:25:01.721359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c12a9c1-09d2-4140-80b4-7c4eb081b024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f2aa10>]}
[0m16:25:01.722531 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:25:01.723457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c12a9c1-09d2-4140-80b4-7c4eb081b024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10da6e0>]}
[0m16:25:01.729919 [info ] [MainThread]: 
[0m16:25:01.731890 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:25:01.736921 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m16:25:01.738863 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m16:25:01.826214 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:25:01.833764 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:25:01.834486 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:25:01.835090 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:25:01.835673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:01.836321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:01.920899 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.08 seconds
[0m16:25:01.921669 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.09 seconds
[0m16:25:01.927899 [debug] [ThreadPool]: On list_postgres: Close
[0m16:25:01.932845 [debug] [ThreadPool]: On list_postgres: Close
[0m16:25:01.941453 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m16:25:01.942872 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m16:25:01.980083 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:25:01.996988 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:25:01.996473 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m16:25:01.997662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:01.998322 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m16:25:02.000190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:02.038956 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m16:25:02.039615 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m16:25:02.040340 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m16:25:02.040932 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:25:02.041507 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m16:25:02.042074 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:25:02.045367 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:25:02.045891 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:25:02.051823 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:25:02.056909 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m16:25:02.057934 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:25:02.058513 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m16:25:02.060385 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_silver"
[0m16:25:02.069955 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_silver"
[0m16:25:02.070542 [debug] [ThreadPool]: On list_postgres_public_silver: BEGIN
[0m16:25:02.071027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:02.124428 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m16:25:02.126342 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_silver"
[0m16:25:02.127495 [debug] [ThreadPool]: On list_postgres_public_silver: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_silver"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
  
[0m16:25:02.131327 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:25:02.138157 [debug] [ThreadPool]: On list_postgres_public_silver: ROLLBACK
[0m16:25:02.139376 [debug] [ThreadPool]: On list_postgres_public_silver: Close
[0m16:25:02.163859 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:02.164791 [debug] [MainThread]: On master: BEGIN
[0m16:25:02.165305 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:25:02.203628 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:25:02.204556 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:02.205077 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:25:02.209687 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:25:02.215399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c12a9c1-09d2-4140-80b4-7c4eb081b024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10c3f70>]}
[0m16:25:02.216459 [debug] [MainThread]: On master: ROLLBACK
[0m16:25:02.217184 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:02.217691 [debug] [MainThread]: On master: BEGIN
[0m16:25:02.218584 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:25:02.219191 [debug] [MainThread]: On master: COMMIT
[0m16:25:02.219701 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:02.220232 [debug] [MainThread]: On master: COMMIT
[0m16:25:02.220931 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:25:02.221468 [debug] [MainThread]: On master: Close
[0m16:25:02.222743 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:25:02.223658 [info ] [MainThread]: 
[0m16:25:02.236996 [debug] [Thread-1 (]: Began running node model.jaffle_shop.parent_product
[0m16:25:02.237689 [debug] [Thread-2 (]: Began running node model.jaffle_shop.rugs
[0m16:25:02.238778 [info ] [Thread-1 (]: 1 of 2 START view model public_staging.parent_product .......................... [RUN]
[0m16:25:02.239819 [info ] [Thread-2 (]: 2 of 2 START table model public_silver.rugs .................................... [RUN]
[0m16:25:02.241571 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.parent_product"
[0m16:25:02.243272 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.rugs"
[0m16:25:02.243964 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.parent_product
[0m16:25:02.244628 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.rugs
[0m16:25:02.245221 [debug] [Thread-1 (]: Compiling model.jaffle_shop.parent_product
[0m16:25:02.245844 [debug] [Thread-2 (]: Compiling model.jaffle_shop.rugs
[0m16:25:02.270350 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.parent_product"
[0m16:25:02.277712 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.rugs"
[0m16:25:02.281119 [debug] [Thread-1 (]: finished collecting timing info
[0m16:25:02.281951 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.parent_product
[0m16:25:02.282331 [debug] [Thread-2 (]: finished collecting timing info
[0m16:25:02.305032 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.rugs
[0m16:25:02.721022 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.parent_product"
[0m16:25:02.726390 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.rugs"
[0m16:25:02.729286 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:25:02.729810 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:25:02.730894 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: BEGIN
[0m16:25:02.731424 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:25:02.730339 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: BEGIN
[0m16:25:02.733347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:02.772512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m16:25:02.773713 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:25:02.774517 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */

  create view "postgres"."public_staging"."parent_product__dbt_tmp" as (
    with base as (
    Select
        md5(pid || split_part(url, '/', 5)) as parent_product_uuid,
        pid as parent_product_id,
        product_type_id as parent_product_type_id,
        name as parent_product_name,
        url as parent_product_url,
        split_part(url, '/', 5) as color_derived_url,
        thickness,
        material,
        weave_feature, 
        brand,
        category,
        availability,
        clearance,
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, split_part(url, '/', 5) order by dw_insert_timestamp desc) as row_num
    from rugs_usa_parent
)


Select *
from base 
where row_num = 1
  );
[0m16:25:02.775026 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m16:25:02.776017 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:25:02.776778 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */


  create  table "postgres"."public_silver"."rugs__dbt_tmp"
  as (
    Select 
distinct *
from rugs_usa_parent
  );
[0m16:25:02.778896 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:25:02.817927 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:25:02.819332 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product" rename to "parent_product__dbt_backup"
[0m16:25:02.818626 [debug] [Thread-2 (]: SQL status: SELECT 5547 in 0.04 seconds
[0m16:25:02.829894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m16:25:02.831643 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:25:02.843057 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
alter table "postgres"."public_silver"."rugs" rename to "rugs__dbt_backup"
[0m16:25:02.842411 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:25:02.843938 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product__dbt_tmp" rename to "parent_product"
[0m16:25:02.844349 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:25:02.853708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m16:25:02.858364 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:25:02.887702 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
alter table "postgres"."public_silver"."rugs__dbt_tmp" rename to "rugs"
[0m16:25:02.905728 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m16:25:03.096258 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: COMMIT
[0m16:25:03.098469 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:25:03.099057 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: COMMIT
[0m16:25:03.097700 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: COMMIT
[0m16:25:03.099947 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:25:03.100504 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: COMMIT
[0m16:25:03.130631 [debug] [Thread-2 (]: SQL status: COMMIT in 0.03 seconds
[0m16:25:03.131276 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m16:25:03.156647 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:25:03.164988 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
drop table if exists "postgres"."public_silver"."rugs__dbt_backup" cascade
[0m16:25:03.164318 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:25:03.165860 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
drop view if exists "postgres"."public_staging"."parent_product__dbt_backup" cascade
[0m16:25:03.167991 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:25:03.173301 [debug] [Thread-1 (]: finished collecting timing info
[0m16:25:03.174415 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: Close
[0m16:25:03.173769 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.01 seconds
[0m16:25:03.176082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c12a9c1-09d2-4140-80b4-7c4eb081b024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0efdf60>]}
[0m16:25:03.181837 [info ] [Thread-1 (]: 1 of 2 OK created view model public_staging.parent_product ..................... [[32mCREATE VIEW[0m in 0.93s]
[0m16:25:03.180484 [debug] [Thread-2 (]: finished collecting timing info
[0m16:25:03.183683 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.parent_product
[0m16:25:03.184413 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: Close
[0m16:25:03.187201 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c12a9c1-09d2-4140-80b4-7c4eb081b024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1d690>]}
[0m16:25:03.188739 [info ] [Thread-2 (]: 2 of 2 OK created table model public_silver.rugs ............................... [[32mSELECT 5547[0m in 0.94s]
[0m16:25:03.190138 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.rugs
[0m16:25:03.195215 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:25:03.196064 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:03.196581 [debug] [MainThread]: On master: BEGIN
[0m16:25:03.197082 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:25:03.235472 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:25:03.236462 [debug] [MainThread]: On master: COMMIT
[0m16:25:03.237016 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:03.237563 [debug] [MainThread]: On master: COMMIT
[0m16:25:03.238242 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:25:03.238810 [debug] [MainThread]: On master: Close
[0m16:25:03.240594 [info ] [MainThread]: 
[0m16:25:03.241543 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 1.51 seconds (1.51s).
[0m16:25:03.242546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:03.243152 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_product' was properly closed.
[0m16:25:03.243645 [debug] [MainThread]: Connection 'model.jaffle_shop.rugs' was properly closed.
[0m16:25:03.278340 [info ] [MainThread]: 
[0m16:25:03.279317 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:25:03.280516 [info ] [MainThread]: 
[0m16:25:03.281364 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:25:03.282706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f17910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1d6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0efeef0>]}


============================== 2024-07-21 16:25:24.210045 | 233d8214-65dc-43ae-8c83-e858361ad2e8 ==============================
[0m16:25:24.210591 [info ] [MainThread]: Running with dbt=1.2.0
[0m16:25:24.213838 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m16:25:24.214780 [debug] [MainThread]: Tracking: tracking
[0m16:25:24.241120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f70070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f70160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f70100>]}
[0m16:25:24.443470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:25:24.444595 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:25:24.447229 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.gold

[0m16:25:24.487355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '233d8214-65dc-43ae-8c83-e858361ad2e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10ac0d0>]}
[0m16:25:24.529278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '233d8214-65dc-43ae-8c83-e858361ad2e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10024d0>]}
[0m16:25:24.530549 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:25:24.531458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '233d8214-65dc-43ae-8c83-e858361ad2e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10022f0>]}
[0m16:25:24.536777 [info ] [MainThread]: 
[0m16:25:24.537821 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m16:25:24.572641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1001c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1001bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1001c30>]}


============================== 2024-07-21 16:27:02.514344 | c7f21bba-5a45-4708-81c6-766af4fae5c1 ==============================
[0m16:27:02.514944 [info ] [MainThread]: Running with dbt=1.2.0
[0m16:27:02.519254 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m16:27:02.520852 [debug] [MainThread]: Tracking: tracking
[0m16:27:02.546673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f225f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f23c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f23df0>]}
[0m16:27:02.651962 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:27:02.653650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c7f21bba-5a45-4708-81c6-766af4fae5c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f014e0>]}
[0m16:27:02.753535 [debug] [MainThread]: Parsing macros/relations.sql
[0m16:27:02.764479 [debug] [MainThread]: Parsing macros/catalog.sql
[0m16:27:02.778350 [debug] [MainThread]: Parsing macros/adapters.sql
[0m16:27:02.935576 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:27:02.942829 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:27:02.951192 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:27:02.992235 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:27:02.994616 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:27:03.000586 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:27:03.004167 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m16:27:03.014928 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m16:27:03.066117 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m16:27:03.092260 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m16:27:03.106205 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m16:27:03.114338 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m16:27:03.123504 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m16:27:03.127855 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m16:27:03.131507 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m16:27:03.136243 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m16:27:03.143930 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m16:27:03.179532 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m16:27:03.186290 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m16:27:03.192315 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m16:27:03.198078 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m16:27:03.202857 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m16:27:03.208558 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m16:27:03.212847 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:27:03.222879 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:27:03.236099 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:27:03.242848 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m16:27:03.247686 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m16:27:03.253034 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m16:27:03.258788 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m16:27:03.262956 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m16:27:03.268429 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:27:03.273240 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m16:27:03.278768 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m16:27:03.284630 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m16:27:03.289679 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:27:03.301246 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:27:03.308455 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m16:27:03.321848 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m16:27:03.344274 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m16:27:03.360436 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m16:27:03.393814 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m16:27:03.413293 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m16:27:03.445373 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m16:27:03.458011 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m16:27:03.465124 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m16:27:03.473528 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m16:27:03.571181 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m16:27:03.597800 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m16:27:03.691197 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m16:27:03.747773 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m16:27:03.856429 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m16:27:03.897693 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m16:27:03.988552 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m16:27:03.998005 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m16:27:04.074635 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m16:27:04.175484 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m16:27:04.185347 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m16:27:04.195108 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m16:27:04.221451 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m16:27:04.237691 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m16:27:04.252615 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m16:27:04.278277 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m16:27:04.334159 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m16:27:04.376479 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m16:27:04.455838 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m16:27:04.542046 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m16:27:04.554575 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m16:27:05.861992 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_product.sql
[0m16:27:05.923360 [debug] [MainThread]: 1699: static parser successfully parsed silver/rugs.sql
[0m16:27:06.264150 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.gold

[0m16:27:06.295541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7f21bba-5a45-4708-81c6-766af4fae5c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0fe3b80>]}
[0m16:27:06.336721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7f21bba-5a45-4708-81c6-766af4fae5c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10ef910>]}
[0m16:27:06.338147 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:27:06.339118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7f21bba-5a45-4708-81c6-766af4fae5c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1062ce0>]}
[0m16:27:06.346343 [info ] [MainThread]: 
[0m16:27:06.348493 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:27:06.355347 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m16:27:06.357212 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_silver"
[0m16:27:06.448780 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_silver"
[0m16:27:06.443669 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m16:27:06.449691 [debug] [ThreadPool]: On list_postgres_public_silver: BEGIN
[0m16:27:06.450274 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m16:27:06.450870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:27:06.451444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:27:06.528486 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
[0m16:27:06.529208 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
[0m16:27:06.530038 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m16:27:06.530662 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_silver"
[0m16:27:06.531214 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m16:27:06.531837 [debug] [ThreadPool]: On list_postgres_public_silver: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_silver"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
  
[0m16:27:06.536578 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:27:06.537122 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:27:06.543328 [debug] [ThreadPool]: On list_postgres_public_silver: ROLLBACK
[0m16:27:06.548195 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m16:27:06.549171 [debug] [ThreadPool]: On list_postgres_public_silver: Close
[0m16:27:06.549646 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m16:27:06.552136 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m16:27:06.561096 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:27:06.561733 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:27:06.562275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:06.598771 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m16:27:06.599612 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:27:06.600211 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:27:06.602710 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:27:06.608368 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:27:06.609111 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:27:06.631387 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:06.632160 [debug] [MainThread]: On master: BEGIN
[0m16:27:06.632639 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:27:06.669219 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:27:06.670080 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:06.670573 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:27:06.674443 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:27:06.679735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7f21bba-5a45-4708-81c6-766af4fae5c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0fe3a60>]}
[0m16:27:06.680765 [debug] [MainThread]: On master: ROLLBACK
[0m16:27:06.681433 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:06.681954 [debug] [MainThread]: On master: BEGIN
[0m16:27:06.683509 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:27:06.684138 [debug] [MainThread]: On master: COMMIT
[0m16:27:06.684657 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:06.685184 [debug] [MainThread]: On master: COMMIT
[0m16:27:06.685838 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:27:06.686383 [debug] [MainThread]: On master: Close
[0m16:27:06.687577 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:27:06.688481 [info ] [MainThread]: 
[0m16:27:06.702024 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76
[0m16:27:06.703030 [info ] [Thread-1 (]: 1 of 1 START test unique_parent_product_parent_product_id ...................... [RUN]
[0m16:27:06.704805 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76"
[0m16:27:06.705454 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76
[0m16:27:06.706093 [debug] [Thread-1 (]: Compiling test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76
[0m16:27:06.762804 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76"
[0m16:27:06.766169 [debug] [Thread-1 (]: finished collecting timing info
[0m16:27:06.766837 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76
[0m16:27:06.859323 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76"
[0m16:27:06.862064 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76"
[0m16:27:06.862616 [debug] [Thread-1 (]: On test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76: BEGIN
[0m16:27:06.863107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:06.900906 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m16:27:06.901817 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76"
[0m16:27:06.902399 [debug] [Thread-1 (]: On test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    parent_product_id as unique_field,
    count(*) as n_records

from "postgres"."public_staging"."parent_product"
where parent_product_id is not null
group by parent_product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:27:06.917557 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m16:27:06.927479 [debug] [Thread-1 (]: finished collecting timing info
[0m16:27:06.928186 [debug] [Thread-1 (]: On test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76: ROLLBACK
[0m16:27:06.928837 [debug] [Thread-1 (]: On test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76: Close
[0m16:27:06.930156 [error] [Thread-1 (]: 1 of 1 FAIL 964 unique_parent_product_parent_product_id ........................ [[31mFAIL 964[0m in 0.23s]
[0m16:27:06.931896 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76
[0m16:27:06.938722 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:27:06.939754 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:06.940403 [debug] [MainThread]: On master: BEGIN
[0m16:27:06.940952 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:27:06.978874 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:27:06.979959 [debug] [MainThread]: On master: COMMIT
[0m16:27:06.980499 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:06.981016 [debug] [MainThread]: On master: COMMIT
[0m16:27:06.981734 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:27:06.982296 [debug] [MainThread]: On master: Close
[0m16:27:06.983972 [info ] [MainThread]: 
[0m16:27:06.984869 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m16:27:06.985898 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:27:06.986500 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76' was properly closed.
[0m16:27:06.987051 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m16:27:07.022283 [info ] [MainThread]: 
[0m16:27:07.023258 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:27:07.024338 [info ] [MainThread]: 
[0m16:27:07.025618 [error] [MainThread]: [31mFailure in test unique_parent_product_parent_product_id (models/staging/schema.yaml)[0m
[0m16:27:07.027063 [error] [MainThread]:   Got 964 results, configured to fail if != 0
[0m16:27:07.028033 [info ] [MainThread]: 
[0m16:27:07.028908 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/staging/schema.yaml/unique_parent_product_parent_product_id.sql
[0m16:27:07.029747 [info ] [MainThread]: 
[0m16:27:07.030905 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:27:07.032319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0fe3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf233d9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf233c9d0>]}


============================== 2024-07-21 16:27:51.072714 | 1cea720b-cdae-4e90-81bc-c75cde8c2966 ==============================
[0m16:27:51.073277 [info ] [MainThread]: Running with dbt=1.2.0
[0m16:27:51.077209 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m16:27:51.078312 [debug] [MainThread]: Tracking: tracking
[0m16:27:51.101685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1c220>]}
[0m16:27:51.303292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:27:51.305718 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/staging/schema.yaml
[0m16:27:51.385692 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_product.sql
[0m16:27:51.568228 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.gold

[0m16:27:51.601665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cea720b-cdae-4e90-81bc-c75cde8c2966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10d3910>]}
[0m16:27:51.642654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cea720b-cdae-4e90-81bc-c75cde8c2966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1077f70>]}
[0m16:27:51.643939 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:27:51.644862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cea720b-cdae-4e90-81bc-c75cde8c2966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f26ef0>]}
[0m16:27:51.652954 [info ] [MainThread]: 
[0m16:27:51.655077 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:27:51.662011 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m16:27:51.663578 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_silver"
[0m16:27:51.756294 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m16:27:51.767088 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_silver"
[0m16:27:51.767554 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m16:27:51.768206 [debug] [ThreadPool]: On list_postgres_public_silver: BEGIN
[0m16:27:51.768771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:27:51.769371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:27:51.851359 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
[0m16:27:51.852107 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
[0m16:27:51.853002 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_silver"
[0m16:27:51.853586 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m16:27:51.854195 [debug] [ThreadPool]: On list_postgres_public_silver: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_silver"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
  
[0m16:27:51.854783 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m16:27:51.859798 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:27:51.860319 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:27:51.866316 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m16:27:51.871311 [debug] [ThreadPool]: On list_postgres_public_silver: ROLLBACK
[0m16:27:51.872366 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m16:27:51.872987 [debug] [ThreadPool]: On list_postgres_public_silver: Close
[0m16:27:51.874926 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m16:27:51.884235 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:27:51.884878 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:27:51.885343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:51.921971 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m16:27:51.922873 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:27:51.923409 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:27:51.925827 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:27:51.931581 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:27:51.932278 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:27:51.955092 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:51.955894 [debug] [MainThread]: On master: BEGIN
[0m16:27:51.956424 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:27:51.992551 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:27:51.993370 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:51.993887 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:27:51.998031 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:27:52.003356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cea720b-cdae-4e90-81bc-c75cde8c2966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf2344490>]}
[0m16:27:52.004402 [debug] [MainThread]: On master: ROLLBACK
[0m16:27:52.005087 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:52.005605 [debug] [MainThread]: On master: BEGIN
[0m16:27:52.006448 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:27:52.007058 [debug] [MainThread]: On master: COMMIT
[0m16:27:52.007577 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:52.008107 [debug] [MainThread]: On master: COMMIT
[0m16:27:52.008793 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:27:52.009347 [debug] [MainThread]: On master: Close
[0m16:27:52.010488 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:27:52.011362 [info ] [MainThread]: 
[0m16:27:52.023455 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138
[0m16:27:52.024467 [info ] [Thread-1 (]: 1 of 1 START test unique_parent_product_parent_product_uuid .................... [RUN]
[0m16:27:52.026257 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138"
[0m16:27:52.026986 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138
[0m16:27:52.027775 [debug] [Thread-1 (]: Compiling test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138
[0m16:27:52.083985 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138"
[0m16:27:52.086699 [debug] [Thread-1 (]: finished collecting timing info
[0m16:27:52.087414 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138
[0m16:27:52.183525 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138"
[0m16:27:52.186539 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138"
[0m16:27:52.187069 [debug] [Thread-1 (]: On test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138: BEGIN
[0m16:27:52.187565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:52.224483 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m16:27:52.225348 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138"
[0m16:27:52.225882 [debug] [Thread-1 (]: On test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    parent_product_uuid as unique_field,
    count(*) as n_records

from "postgres"."public_staging"."parent_product"
where parent_product_uuid is not null
group by parent_product_uuid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:27:52.253609 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m16:27:52.264128 [debug] [Thread-1 (]: finished collecting timing info
[0m16:27:52.264861 [debug] [Thread-1 (]: On test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138: ROLLBACK
[0m16:27:52.265584 [debug] [Thread-1 (]: On test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138: Close
[0m16:27:52.267012 [info ] [Thread-1 (]: 1 of 1 PASS unique_parent_product_parent_product_uuid .......................... [[32mPASS[0m in 0.24s]
[0m16:27:52.268830 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138
[0m16:27:52.275048 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:27:52.275953 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:52.276471 [debug] [MainThread]: On master: BEGIN
[0m16:27:52.276953 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:27:52.314057 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:27:52.315022 [debug] [MainThread]: On master: COMMIT
[0m16:27:52.315587 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:52.316097 [debug] [MainThread]: On master: COMMIT
[0m16:27:52.316792 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:27:52.317791 [debug] [MainThread]: On master: Close
[0m16:27:52.319715 [info ] [MainThread]: 
[0m16:27:52.320640 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m16:27:52.321638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:27:52.322188 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138' was properly closed.
[0m16:27:52.322697 [debug] [MainThread]: Connection 'list_postgres_public_silver' was properly closed.
[0m16:27:52.357586 [info ] [MainThread]: 
[0m16:27:52.358554 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:27:52.359648 [info ] [MainThread]: 
[0m16:27:52.360488 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:27:52.361890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1084cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1085240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1085a20>]}


============================== 2024-07-21 16:35:37.806988 | acf59c9f-8829-4372-b540-3ea7bedbeb67 ==============================
[0m16:35:37.807570 [info ] [MainThread]: Running with dbt=1.2.0
[0m16:35:37.811600 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:35:37.812634 [debug] [MainThread]: Tracking: tracking
[0m16:35:37.836145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f2aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f280a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f2b790>]}
[0m16:35:38.035273 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:35:38.038017 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/staging/schema.yaml
[0m16:35:38.122556 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_product.sql
[0m16:35:38.304095 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.gold

[0m16:35:38.339848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acf59c9f-8829-4372-b540-3ea7bedbeb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10d0640>]}
[0m16:35:38.380301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acf59c9f-8829-4372-b540-3ea7bedbeb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1077f10>]}
[0m16:35:38.381528 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:35:38.382459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acf59c9f-8829-4372-b540-3ea7bedbeb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1077f40>]}
[0m16:35:38.389260 [info ] [MainThread]: 
[0m16:35:38.391225 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:35:38.396225 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m16:35:38.398770 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m16:35:38.484590 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:35:38.485605 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:35:38.486335 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:35:38.486983 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:35:38.487557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:38.488173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:38.571240 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.08 seconds
[0m16:35:38.572004 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.08 seconds
[0m16:35:38.578288 [debug] [ThreadPool]: On list_postgres: Close
[0m16:35:38.583134 [debug] [ThreadPool]: On list_postgres: Close
[0m16:35:38.591680 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m16:35:38.593128 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_silver"
[0m16:35:38.623731 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m16:35:38.631004 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_silver"
[0m16:35:38.631752 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m16:35:38.632370 [debug] [ThreadPool]: On list_postgres_public_silver: BEGIN
[0m16:35:38.633005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:38.633598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:38.672209 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m16:35:38.673338 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m16:35:38.673975 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m16:35:38.674376 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m16:35:38.674972 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_silver"
[0m16:35:38.675871 [debug] [ThreadPool]: On list_postgres_public_silver: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_silver"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
  
[0m16:35:38.678280 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:35:38.683743 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m16:35:38.684419 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m16:35:38.685114 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m16:35:38.689730 [debug] [ThreadPool]: On list_postgres_public_silver: ROLLBACK
[0m16:35:38.691627 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m16:35:38.692676 [debug] [ThreadPool]: On list_postgres_public_silver: Close
[0m16:35:38.700190 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:35:38.701896 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:35:38.702442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:38.738395 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m16:35:38.739235 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:35:38.739749 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:35:38.742252 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:35:38.747865 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:35:38.748564 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:35:38.770308 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:38.771078 [debug] [MainThread]: On master: BEGIN
[0m16:35:38.771564 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:35:38.807368 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:35:38.808228 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:38.808737 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:35:38.812796 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:35:38.818074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acf59c9f-8829-4372-b540-3ea7bedbeb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10765f0>]}
[0m16:35:38.819073 [debug] [MainThread]: On master: ROLLBACK
[0m16:35:38.819743 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:38.820300 [debug] [MainThread]: On master: BEGIN
[0m16:35:38.821166 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:35:38.821765 [debug] [MainThread]: On master: COMMIT
[0m16:35:38.822279 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:38.822765 [debug] [MainThread]: On master: COMMIT
[0m16:35:38.823423 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:35:38.823974 [debug] [MainThread]: On master: Close
[0m16:35:38.825156 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:35:38.826035 [info ] [MainThread]: 
[0m16:35:38.838566 [debug] [Thread-1 (]: Began running node model.jaffle_shop.parent_product
[0m16:35:38.839180 [debug] [Thread-2 (]: Began running node model.jaffle_shop.rugs
[0m16:35:38.840222 [info ] [Thread-1 (]: 1 of 2 START view model public_staging.parent_product .......................... [RUN]
[0m16:35:38.841303 [info ] [Thread-2 (]: 2 of 2 START table model public_silver.rugs .................................... [RUN]
[0m16:35:38.843027 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.parent_product"
[0m16:35:38.844656 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.rugs"
[0m16:35:38.845418 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.parent_product
[0m16:35:38.846118 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.rugs
[0m16:35:38.846862 [debug] [Thread-1 (]: Compiling model.jaffle_shop.parent_product
[0m16:35:38.847886 [debug] [Thread-2 (]: Compiling model.jaffle_shop.rugs
[0m16:35:38.859138 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.parent_product"
[0m16:35:38.867078 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.rugs"
[0m16:35:38.870251 [debug] [Thread-1 (]: finished collecting timing info
[0m16:35:38.870827 [debug] [Thread-2 (]: finished collecting timing info
[0m16:35:38.871864 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.rugs
[0m16:35:38.871264 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.parent_product
[0m16:35:39.257016 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.parent_product"
[0m16:35:39.280086 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.rugs"
[0m16:35:39.281779 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:35:39.282723 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: BEGIN
[0m16:35:39.283856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:39.283444 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:35:39.286470 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: BEGIN
[0m16:35:39.287065 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:35:39.324280 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m16:35:39.325411 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:35:39.326007 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */

  create view "postgres"."public_staging"."parent_product__dbt_tmp" as (
    with base as (
    Select
        md5(pid || split_part(url, '/', 5)) as parent_product_uuid,
        pid as parent_product_id,
        product_type_id as parent_product_type_id,
        name as parent_product_name,
        url as parent_product_url,
        split_part(url, '/', 5) as color_derived_url,
        thickness,
        material,
        weave_feature, 
        brand,
        category,
        availability,
        clearance,
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, split_part(url, '/', 5) order by dw_insert_timestamp desc) as row_num
    from rugs_usa_parent
)


Select *
from base 
where row_num = 1
  );
[0m16:35:39.329755 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m16:35:39.331023 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:35:39.331563 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */


  create  table "postgres"."public_silver"."rugs__dbt_tmp"
  as (
    Select 
distinct *
from rugs_usa_parent
  );
[0m16:35:39.330383 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:35:39.369402 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:35:39.370788 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product" rename to "parent_product__dbt_backup"
[0m16:35:39.370128 [debug] [Thread-2 (]: SQL status: SELECT 5547 in 0.04 seconds
[0m16:35:39.378967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m16:35:39.382772 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:35:39.393578 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
alter table "postgres"."public_silver"."rugs" rename to "rugs__dbt_backup"
[0m16:35:39.392983 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:35:39.394436 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product__dbt_tmp" rename to "parent_product"
[0m16:35:39.394819 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:35:39.403862 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m16:35:39.408733 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:35:39.436046 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
alter table "postgres"."public_silver"."rugs__dbt_tmp" rename to "rugs"
[0m16:35:39.454051 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m16:35:39.575014 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: COMMIT
[0m16:35:39.583502 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:35:39.584021 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: COMMIT
[0m16:35:39.582798 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: COMMIT
[0m16:35:39.584938 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:35:39.585496 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: COMMIT
[0m16:35:39.614007 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m16:35:39.614704 [debug] [Thread-2 (]: SQL status: COMMIT in 0.03 seconds
[0m16:35:39.646261 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.rugs"
[0m16:35:39.647635 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rugs"} */
drop table if exists "postgres"."public_silver"."rugs__dbt_backup" cascade
[0m16:35:39.647072 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m16:35:39.648497 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
drop view if exists "postgres"."public_staging"."parent_product__dbt_backup" cascade
[0m16:35:39.650811 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:35:39.651561 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:35:39.656005 [debug] [Thread-1 (]: finished collecting timing info
[0m16:35:39.660876 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: Close
[0m16:35:39.660205 [debug] [Thread-2 (]: finished collecting timing info
[0m16:35:39.663129 [debug] [Thread-2 (]: On model.jaffle_shop.rugs: Close
[0m16:35:39.662475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acf59c9f-8829-4372-b540-3ea7bedbeb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f2b790>]}
[0m16:35:39.665878 [info ] [Thread-1 (]: 1 of 2 OK created view model public_staging.parent_product ..................... [[32mCREATE VIEW[0m in 0.82s]
[0m16:35:39.664481 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acf59c9f-8829-4372-b540-3ea7bedbeb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10a5b70>]}
[0m16:35:39.667740 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.parent_product
[0m16:35:39.669151 [info ] [Thread-2 (]: 2 of 2 OK created table model public_silver.rugs ............................... [[32mSELECT 5547[0m in 0.82s]
[0m16:35:39.671683 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.rugs
[0m16:35:39.676794 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:35:39.677643 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:39.678249 [debug] [MainThread]: On master: BEGIN
[0m16:35:39.678801 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:35:39.718006 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m16:35:39.719176 [debug] [MainThread]: On master: COMMIT
[0m16:35:39.719852 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:39.720594 [debug] [MainThread]: On master: COMMIT
[0m16:35:39.721466 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:35:39.722157 [debug] [MainThread]: On master: Close
[0m16:35:39.724673 [info ] [MainThread]: 
[0m16:35:39.725893 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m16:35:39.726950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:39.727527 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_product' was properly closed.
[0m16:35:39.728033 [debug] [MainThread]: Connection 'model.jaffle_shop.rugs' was properly closed.
[0m16:35:39.764136 [info ] [MainThread]: 
[0m16:35:39.765369 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:39.766548 [info ] [MainThread]: 
[0m16:35:39.767499 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:35:39.768860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10a5b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10e65c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1085cc0>]}


============================== 2024-07-21 17:50:32.685815 | e1b75b40-3b74-4f7b-b883-e37c893838a7 ==============================
[0m17:50:32.686382 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:50:32.690691 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:50:32.691732 [debug] [MainThread]: Tracking: tracking
[0m17:50:32.726542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f22590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f23d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f23e20>]}
[0m17:50:32.835142 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:50:32.836469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e1b75b40-3b74-4f7b-b883-e37c893838a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f035e0>]}
[0m17:50:32.944315 [debug] [MainThread]: Parsing macros/relations.sql
[0m17:50:32.955123 [debug] [MainThread]: Parsing macros/catalog.sql
[0m17:50:32.968897 [debug] [MainThread]: Parsing macros/adapters.sql
[0m17:50:33.126267 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m17:50:33.133517 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:50:33.141932 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:50:33.182977 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m17:50:33.185399 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:50:33.191356 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:50:33.194627 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m17:50:33.204205 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m17:50:33.255647 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m17:50:33.282143 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m17:50:33.296340 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m17:50:33.304514 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m17:50:33.313760 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m17:50:33.318225 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m17:50:33.321881 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m17:50:33.326645 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m17:50:33.334439 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m17:50:33.370537 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m17:50:33.377406 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m17:50:33.383535 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m17:50:33.389460 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m17:50:33.394727 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m17:50:33.400677 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m17:50:33.405083 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m17:50:33.415347 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:50:33.428926 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:50:33.435794 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m17:50:33.440759 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m17:50:33.446909 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m17:50:33.453224 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m17:50:33.458132 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m17:50:33.464137 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m17:50:33.469176 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m17:50:33.474912 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m17:50:33.481102 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m17:50:33.486375 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:50:33.498261 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:50:33.505774 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m17:50:33.519002 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m17:50:33.541398 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m17:50:33.557803 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m17:50:33.591750 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m17:50:33.612092 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m17:50:33.645178 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m17:50:33.658109 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m17:50:33.665214 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m17:50:33.673702 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m17:50:33.772367 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m17:50:33.798688 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m17:50:33.894442 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m17:50:33.953135 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m17:50:34.062853 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m17:50:34.106238 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m17:50:34.187305 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m17:50:34.201424 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m17:50:34.282033 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m17:50:34.385387 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m17:50:34.396111 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m17:50:34.406446 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m17:50:34.434039 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m17:50:34.450696 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m17:50:34.465927 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m17:50:34.492023 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m17:50:34.549300 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m17:50:34.591403 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m17:50:34.673373 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m17:50:34.760448 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m17:50:34.773031 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m17:50:36.111977 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_variant_map.sql
[0m17:50:36.175051 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_product.sql
[0m17:50:36.186580 [debug] [MainThread]: 1699: static parser successfully parsed silver/rugs.sql
[0m17:50:36.402802 [warn ] [MainThread]: [[33mWARNING[0m]: 'rugs_usa_variant' is a seed node, but it is specified in the models section of
seeds/schema.yml. To fix this error, place the `rugs_usa_variant` specification
under the seeds key instead.
[0m17:50:36.639659 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.gold

[0m17:50:36.670934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1b75b40-3b74-4f7b-b883-e37c893838a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab108bd60>]}
[0m17:50:36.713757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1b75b40-3b74-4f7b-b883-e37c893838a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1083d30>]}
[0m17:50:36.715032 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:50:36.715954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1b75b40-3b74-4f7b-b883-e37c893838a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10742b0>]}
[0m17:50:36.723770 [info ] [MainThread]: 
[0m17:50:36.726605 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:50:36.733760 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m17:50:36.735622 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:50:36.830999 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m17:50:36.840931 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:50:36.841375 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m17:50:36.842096 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:50:36.842653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:36.843285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:36.918933 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
[0m17:50:36.919675 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
[0m17:50:36.920528 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:50:36.921152 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m17:50:36.921833 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:50:36.922423 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m17:50:36.929207 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m17:50:36.929830 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m17:50:36.937813 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m17:50:36.943388 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:50:36.944501 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m17:50:36.945163 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:50:36.947691 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_silver"
[0m17:50:36.958385 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_silver"
[0m17:50:36.959350 [debug] [ThreadPool]: On list_postgres_public_silver: BEGIN
[0m17:50:36.959924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:36.998103 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m17:50:36.999042 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_silver"
[0m17:50:36.999554 [debug] [ThreadPool]: On list_postgres_public_silver: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_silver"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
  
[0m17:50:37.002333 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:50:37.007597 [debug] [ThreadPool]: On list_postgres_public_silver: ROLLBACK
[0m17:50:37.008351 [debug] [ThreadPool]: On list_postgres_public_silver: Close
[0m17:50:37.031616 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:37.032399 [debug] [MainThread]: On master: BEGIN
[0m17:50:37.032899 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:37.069083 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m17:50:37.069913 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:37.070476 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:50:37.074589 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m17:50:37.079948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1b75b40-3b74-4f7b-b883-e37c893838a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab108b790>]}
[0m17:50:37.080993 [debug] [MainThread]: On master: ROLLBACK
[0m17:50:37.081673 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:37.082205 [debug] [MainThread]: On master: BEGIN
[0m17:50:37.083103 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:50:37.083672 [debug] [MainThread]: On master: COMMIT
[0m17:50:37.084193 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:37.084692 [debug] [MainThread]: On master: COMMIT
[0m17:50:37.085329 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:50:37.085897 [debug] [MainThread]: On master: Close
[0m17:50:37.087195 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:50:37.088130 [info ] [MainThread]: 
[0m17:50:37.100996 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168
[0m17:50:37.101624 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_rugs_usa_variant_new_arrival.969b4ebb29
[0m17:50:37.102479 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_rugs_usa_variant_new_arrival__Y__N ........... [RUN]
[0m17:50:37.103420 [info ] [Thread-2 (]: 2 of 3 START test not_rugs_usa_variant_new_arrival ............................. [RUN]
[0m17:50:37.105163 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168"
[0m17:50:37.107416 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_rugs_usa_variant_new_arrival.969b4ebb29"
[0m17:50:37.108836 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168
[0m17:50:37.109648 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_rugs_usa_variant_new_arrival.969b4ebb29
[0m17:50:37.110343 [debug] [Thread-1 (]: Compiling test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168
[0m17:50:37.111022 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_rugs_usa_variant_new_arrival.969b4ebb29
[0m17:50:37.135080 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168"
[0m17:50:37.155840 [debug] [Thread-2 (]: finished collecting timing info
[0m17:50:37.158090 [debug] [Thread-2 (]: Compilation Error in test not_rugs_usa_variant_new_arrival (seeds/schema.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:50:37.159319 [debug] [Thread-1 (]: finished collecting timing info
[0m17:50:37.159952 [error] [Thread-2 (]: 2 of 3 ERROR not_rugs_usa_variant_new_arrival .................................. [[31mERROR[0m in 0.05s]
[0m17:50:37.160915 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168
[0m17:50:37.162258 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_rugs_usa_variant_new_arrival.969b4ebb29
[0m17:50:37.185815 [debug] [Thread-2 (]: Began running node test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76
[0m17:50:37.209640 [info ] [Thread-2 (]: 3 of 3 START test unique_parent_product_parent_product_id ...................... [RUN]
[0m17:50:37.234942 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76"
[0m17:50:37.251123 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76
[0m17:50:37.263133 [debug] [Thread-2 (]: Compiling test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76
[0m17:50:37.286603 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168"
[0m17:50:37.310001 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76"
[0m17:50:37.312040 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168"
[0m17:50:37.313679 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168: BEGIN
[0m17:50:37.315141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:37.314750 [debug] [Thread-2 (]: finished collecting timing info
[0m17:50:37.317046 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76
[0m17:50:37.328649 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76"
[0m17:50:37.330577 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76"
[0m17:50:37.331146 [debug] [Thread-2 (]: On test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76: BEGIN
[0m17:50:37.331634 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:50:37.355793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m17:50:37.360070 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168"
[0m17:50:37.360675 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        new_arrival as value_field,
        count(*) as n_records

    from "postgres"."public"."rugs_usa_variant"
    group by new_arrival

)

select *
from all_values
where value_field not in (
    'Y','N'
)



      
    ) dbt_internal_test
[0m17:50:37.372187 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m17:50:37.372944 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:50:37.373714 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76"
[0m17:50:37.388070 [debug] [Thread-2 (]: On test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    parent_product_id as unique_field,
    count(*) as n_records

from "postgres"."public_staging"."parent_product"
where parent_product_id is not null
group by parent_product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:50:37.387445 [debug] [Thread-1 (]: finished collecting timing info
[0m17:50:37.389122 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168: ROLLBACK
[0m17:50:37.389853 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168: Close
[0m17:50:37.391867 [info ] [Thread-1 (]: 1 of 3 PASS accepted_values_rugs_usa_variant_new_arrival__Y__N ................. [[32mPASS[0m in 0.29s]
[0m17:50:37.393836 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168
[0m17:50:37.405000 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.02 seconds
[0m17:50:37.412347 [debug] [Thread-2 (]: finished collecting timing info
[0m17:50:37.413197 [debug] [Thread-2 (]: On test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76: ROLLBACK
[0m17:50:37.413890 [debug] [Thread-2 (]: On test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76: Close
[0m17:50:37.415210 [error] [Thread-2 (]: 3 of 3 FAIL 964 unique_parent_product_parent_product_id ........................ [[31mFAIL 964[0m in 0.18s]
[0m17:50:37.416728 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76
[0m17:50:37.423651 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:50:37.424712 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:37.425534 [debug] [MainThread]: On master: BEGIN
[0m17:50:37.426324 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:37.464637 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m17:50:37.465647 [debug] [MainThread]: On master: COMMIT
[0m17:50:37.466197 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:37.466709 [debug] [MainThread]: On master: COMMIT
[0m17:50:37.467399 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:50:37.467962 [debug] [MainThread]: On master: Close
[0m17:50:37.469759 [info ] [MainThread]: 
[0m17:50:37.470729 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m17:50:37.471748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:37.472432 [debug] [MainThread]: Connection 'test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168' was properly closed.
[0m17:50:37.472941 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76' was properly closed.
[0m17:50:37.576775 [info ] [MainThread]: 
[0m17:50:37.577791 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:50:37.579033 [info ] [MainThread]: 
[0m17:50:37.580360 [error] [MainThread]: [33mCompilation Error in test not_rugs_usa_variant_new_arrival (seeds/schema.yml)[0m
[0m17:50:37.581455 [error] [MainThread]:   'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:50:37.582306 [info ] [MainThread]: 
[0m17:50:37.583245 [error] [MainThread]: [31mFailure in test unique_parent_product_parent_product_id (models/staging/schema.yaml)[0m
[0m17:50:37.584202 [error] [MainThread]:   Got 964 results, configured to fail if != 0
[0m17:50:37.585318 [info ] [MainThread]: 
[0m17:50:37.586384 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/staging/schema.yaml/unique_parent_product_parent_product_id.sql
[0m17:50:37.587342 [info ] [MainThread]: 
[0m17:50:37.588255 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m17:50:37.589500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaaf6de080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaaf790ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaaf792290>]}


============================== 2024-07-21 17:51:44.602270 | f083df1b-2d16-4225-ab3b-e9173b2d1936 ==============================
[0m17:51:44.602874 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:51:44.607735 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:51:44.608812 [debug] [MainThread]: Tracking: tracking
[0m17:51:44.647185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f225f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f23c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f23df0>]}
[0m17:51:44.853008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:51:44.856978 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://seeds/schema.yml
[0m17:51:44.908461 [warn ] [MainThread]: [[33mWARNING[0m]: 'rugs_usa_variant' is a seed node, but it is specified in the models section of
seeds/schema.yml. To fix this error, place the `rugs_usa_variant` specification
under the seeds key instead.
[0m17:51:45.112235 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.gold

[0m17:51:45.143988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f083df1b-2d16-4225-ab3b-e9173b2d1936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab12e00d0>]}
[0m17:51:45.188581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f083df1b-2d16-4225-ab3b-e9173b2d1936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10ce380>]}
[0m17:51:45.189842 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:51:45.190749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f083df1b-2d16-4225-ab3b-e9173b2d1936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10cfbe0>]}
[0m17:51:45.197932 [info ] [MainThread]: 
[0m17:51:45.200029 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:51:45.209349 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:51:45.211775 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_silver"
[0m17:51:45.305399 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:51:45.311354 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_silver"
[0m17:51:45.312134 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:51:45.312771 [debug] [ThreadPool]: On list_postgres_public_silver: BEGIN
[0m17:51:45.313360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:45.313966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:45.391149 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
[0m17:51:45.391879 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
[0m17:51:45.392719 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_silver"
[0m17:51:45.393332 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:51:45.393916 [debug] [ThreadPool]: On list_postgres_public_silver: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_silver"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
  
[0m17:51:45.394485 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:51:45.399574 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:51:45.400118 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m17:51:45.406710 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:51:45.411592 [debug] [ThreadPool]: On list_postgres_public_silver: ROLLBACK
[0m17:51:45.412626 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:51:45.413226 [debug] [ThreadPool]: On list_postgres_public_silver: Close
[0m17:51:45.415181 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m17:51:45.424785 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m17:51:45.425387 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m17:51:45.425857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:45.462091 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m17:51:45.462888 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m17:51:45.463412 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m17:51:45.465804 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:51:45.470918 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m17:51:45.471615 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m17:51:45.494704 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:45.495545 [debug] [MainThread]: On master: BEGIN
[0m17:51:45.496046 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:45.532071 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m17:51:45.532881 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:45.533390 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:51:45.537520 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m17:51:45.542821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f083df1b-2d16-4225-ab3b-e9173b2d1936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10cd300>]}
[0m17:51:45.543880 [debug] [MainThread]: On master: ROLLBACK
[0m17:51:45.544551 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:45.545061 [debug] [MainThread]: On master: BEGIN
[0m17:51:45.545886 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:51:45.546501 [debug] [MainThread]: On master: COMMIT
[0m17:51:45.546993 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:45.547455 [debug] [MainThread]: On master: COMMIT
[0m17:51:45.548065 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:51:45.548592 [debug] [MainThread]: On master: Close
[0m17:51:45.549744 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:51:45.550600 [info ] [MainThread]: 
[0m17:51:45.563111 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__F__N.a309abef15
[0m17:51:45.563783 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6
[0m17:51:45.564578 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_rugs_usa_variant_new_arrival__F__N ........... [RUN]
[0m17:51:45.565403 [info ] [Thread-2 (]: 2 of 3 START test not_null_rugs_usa_variant_new_arrival ........................ [RUN]
[0m17:51:45.567092 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__F__N.a309abef15"
[0m17:51:45.568860 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6"
[0m17:51:45.569520 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__F__N.a309abef15
[0m17:51:45.570525 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6
[0m17:51:45.571497 [debug] [Thread-1 (]: Compiling test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__F__N.a309abef15
[0m17:51:45.572485 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6
[0m17:51:45.594961 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__F__N.a309abef15"
[0m17:51:45.647530 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6"
[0m17:51:45.648753 [debug] [Thread-1 (]: finished collecting timing info
[0m17:51:45.649851 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__F__N.a309abef15
[0m17:51:45.667726 [debug] [Thread-2 (]: finished collecting timing info
[0m17:51:45.687810 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6
[0m17:51:45.767802 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__F__N.a309abef15"
[0m17:51:45.798418 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6"
[0m17:51:45.799598 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__F__N.a309abef15"
[0m17:51:45.800725 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__F__N.a309abef15: BEGIN
[0m17:51:45.801287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:45.801816 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6"
[0m17:51:45.804516 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6: BEGIN
[0m17:51:45.805144 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:51:45.840157 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m17:51:45.842062 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__F__N.a309abef15"
[0m17:51:45.842834 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m17:51:45.843868 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6"
[0m17:51:45.844352 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_arrival
from "postgres"."public"."rugs_usa_variant"
where new_arrival is null



      
    ) dbt_internal_test
[0m17:51:45.843279 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__F__N.a309abef15: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__F__N.a309abef15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        new_arrival as value_field,
        count(*) as n_records

    from "postgres"."public"."rugs_usa_variant"
    group by new_arrival

)

select *
from all_values
where value_field not in (
    'F','N'
)



      
    ) dbt_internal_test
[0m17:51:45.854403 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:51:45.855067 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.01 seconds
[0m17:51:45.864582 [debug] [Thread-1 (]: finished collecting timing info
[0m17:51:45.870592 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__F__N.a309abef15: ROLLBACK
[0m17:51:45.869934 [debug] [Thread-2 (]: finished collecting timing info
[0m17:51:45.871689 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6: ROLLBACK
[0m17:51:45.871302 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__F__N.a309abef15: Close
[0m17:51:45.872366 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6: Close
[0m17:51:45.873544 [error] [Thread-1 (]: 1 of 3 FAIL 1 accepted_values_rugs_usa_variant_new_arrival__F__N ............... [[31mFAIL 1[0m in 0.31s]
[0m17:51:45.875117 [info ] [Thread-2 (]: 2 of 3 PASS not_null_rugs_usa_variant_new_arrival .............................. [[32mPASS[0m in 0.31s]
[0m17:51:45.876638 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__F__N.a309abef15
[0m17:51:45.878071 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6
[0m17:51:45.879362 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76
[0m17:51:45.881084 [info ] [Thread-1 (]: 3 of 3 START test unique_parent_product_parent_product_id ...................... [RUN]
[0m17:51:45.882806 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76"
[0m17:51:45.883451 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76
[0m17:51:45.884027 [debug] [Thread-1 (]: Compiling test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76
[0m17:51:45.917011 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76"
[0m17:51:45.920514 [debug] [Thread-1 (]: finished collecting timing info
[0m17:51:45.921845 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76
[0m17:51:45.934026 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76"
[0m17:51:45.936236 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76"
[0m17:51:45.937355 [debug] [Thread-1 (]: On test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76: BEGIN
[0m17:51:45.937941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:45.985616 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m17:51:45.988227 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76"
[0m17:51:45.989947 [debug] [Thread-1 (]: On test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    parent_product_id as unique_field,
    count(*) as n_records

from "postgres"."public_staging"."parent_product"
where parent_product_id is not null
group by parent_product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:51:46.007715 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m17:51:46.015069 [debug] [Thread-1 (]: finished collecting timing info
[0m17:51:46.016048 [debug] [Thread-1 (]: On test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76: ROLLBACK
[0m17:51:46.016802 [debug] [Thread-1 (]: On test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76: Close
[0m17:51:46.018202 [error] [Thread-1 (]: 3 of 3 FAIL 964 unique_parent_product_parent_product_id ........................ [[31mFAIL 964[0m in 0.14s]
[0m17:51:46.019778 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76
[0m17:51:46.025817 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:51:46.026801 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:46.027333 [debug] [MainThread]: On master: BEGIN
[0m17:51:46.027828 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:51:46.064800 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m17:51:46.065873 [debug] [MainThread]: On master: COMMIT
[0m17:51:46.066401 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:46.066935 [debug] [MainThread]: On master: COMMIT
[0m17:51:46.067687 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:51:46.068259 [debug] [MainThread]: On master: Close
[0m17:51:46.070121 [info ] [MainThread]: 
[0m17:51:46.071824 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m17:51:46.072954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:46.073663 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_parent_product_parent_product_id.213565fb76' was properly closed.
[0m17:51:46.074174 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6' was properly closed.
[0m17:51:46.110105 [info ] [MainThread]: 
[0m17:51:46.111109 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:51:46.112251 [info ] [MainThread]: 
[0m17:51:46.113116 [error] [MainThread]: [31mFailure in test accepted_values_rugs_usa_variant_new_arrival__F__N (seeds/schema.yml)[0m
[0m17:51:46.113996 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:51:46.114924 [info ] [MainThread]: 
[0m17:51:46.115735 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/seeds/schema.yml/accepted_values_rugs_usa_variant_new_arrival__F__N.sql
[0m17:51:46.116604 [info ] [MainThread]: 
[0m17:51:46.117556 [error] [MainThread]: [31mFailure in test unique_parent_product_parent_product_id (models/staging/schema.yaml)[0m
[0m17:51:46.118679 [error] [MainThread]:   Got 964 results, configured to fail if != 0
[0m17:51:46.119831 [info ] [MainThread]: 
[0m17:51:46.120870 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/staging/schema.yaml/unique_parent_product_parent_product_id.sql
[0m17:51:46.122480 [info ] [MainThread]: 
[0m17:51:46.123494 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m17:51:46.125353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1325630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab13255a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab13249d0>]}


============================== 2024-07-21 18:01:39.949336 | 276a7514-4d4a-4b98-913b-123ec6fa6d71 ==============================
[0m18:01:39.949975 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:01:39.953782 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:01:39.954602 [debug] [MainThread]: Tracking: tracking
[0m18:01:39.982899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f23f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f23e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f23dc0>]}
[0m18:01:40.189201 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 3 files changed.
[0m18:01:40.191709 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/staging/schema.yaml
[0m18:01:40.192977 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://seeds/schema.yml
[0m18:01:40.193647 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/silver/rugs.sql
[0m18:01:40.194934 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/parent_variant_map.sql
[0m18:01:40.275908 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_product.sql
[0m18:01:40.340949 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_variant_map.sql
[0m18:01:40.461291 [warn ] [MainThread]: [[33mWARNING[0m]: 'rugs_usa_variant' is a seed node, but it is specified in the models section of
seeds/schema.yml. To fix this error, place the `rugs_usa_variant` specification
under the seeds key instead.
[0m18:01:40.575241 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.gold
- models.jaffle_shop.silver

[0m18:01:40.607754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '276a7514-4d4a-4b98-913b-123ec6fa6d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10f2230>]}
[0m18:01:40.653128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '276a7514-4d4a-4b98-913b-123ec6fa6d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1cdf0>]}
[0m18:01:40.654416 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:01:40.655420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '276a7514-4d4a-4b98-913b-123ec6fa6d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1065090>]}
[0m18:01:40.663037 [info ] [MainThread]: 
[0m18:01:40.665170 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:01:40.670771 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m18:01:40.729067 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:01:40.730149 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:01:40.730746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:40.799990 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.07 seconds
[0m18:01:40.806661 [debug] [ThreadPool]: On list_postgres: Close
[0m18:01:40.813348 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m18:01:40.814968 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:01:40.852992 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m18:01:40.866752 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m18:01:40.866370 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:01:40.867334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:40.868003 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:01:40.869930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:40.907201 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m18:01:40.908478 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m18:01:40.909006 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m18:01:40.909589 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m18:01:40.910178 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:01:40.911116 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:01:40.913773 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:01:40.914245 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:01:40.920226 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m18:01:40.925535 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:01:40.926470 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m18:01:40.927081 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:01:40.950131 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:40.950989 [debug] [MainThread]: On master: BEGIN
[0m18:01:40.951496 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:40.988212 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m18:01:40.989059 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:40.989646 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:01:41.001015 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:01:41.006568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '276a7514-4d4a-4b98-913b-123ec6fa6d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf2345480>]}
[0m18:01:41.007648 [debug] [MainThread]: On master: ROLLBACK
[0m18:01:41.008386 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:41.008909 [debug] [MainThread]: On master: BEGIN
[0m18:01:41.009781 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:01:41.010357 [debug] [MainThread]: On master: COMMIT
[0m18:01:41.010858 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:41.011336 [debug] [MainThread]: On master: COMMIT
[0m18:01:41.011989 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:01:41.012556 [debug] [MainThread]: On master: Close
[0m18:01:41.013999 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:01:41.014923 [info ] [MainThread]: 
[0m18:01:41.029825 [debug] [Thread-1 (]: Began running node model.jaffle_shop.parent_product
[0m18:01:41.030457 [debug] [Thread-2 (]: Began running node model.jaffle_shop.parent_variant_map
[0m18:01:41.031569 [info ] [Thread-1 (]: 1 of 2 START view model public_staging.parent_product .......................... [RUN]
[0m18:01:41.032646 [info ] [Thread-2 (]: 2 of 2 START view model public_staging.parent_variant_map ...................... [RUN]
[0m18:01:41.034350 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.parent_product"
[0m18:01:41.036188 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.parent_variant_map"
[0m18:01:41.037550 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.parent_product
[0m18:01:41.038576 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.parent_variant_map
[0m18:01:41.039248 [debug] [Thread-1 (]: Compiling model.jaffle_shop.parent_product
[0m18:01:41.039859 [debug] [Thread-2 (]: Compiling model.jaffle_shop.parent_variant_map
[0m18:01:41.056369 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.parent_product"
[0m18:01:41.065209 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.parent_variant_map"
[0m18:01:41.068053 [debug] [Thread-1 (]: finished collecting timing info
[0m18:01:41.068762 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.parent_product
[0m18:01:41.069191 [debug] [Thread-2 (]: finished collecting timing info
[0m18:01:41.092138 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.parent_variant_map
[0m18:01:41.457927 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.parent_variant_map"
[0m18:01:41.458626 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.parent_product"
[0m18:01:41.461056 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m18:01:41.462120 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: BEGIN
[0m18:01:41.462596 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:41.461803 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m18:01:41.465200 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: BEGIN
[0m18:01:41.468582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:41.500912 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m18:01:41.501787 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m18:01:41.502307 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */

  create view "postgres"."public_staging"."parent_variant_map__dbt_tmp" as (
    with base as (
    Select
        md5(pid || variant) as parent_variant_map_uuid,
        pid as product_product_id,
        variant as variant_id,
        actual_size,
        weave_feature,
        weave_cat,
        size_grp,
        shipping_size,
        shape,
        cast(weight as float) as weight,
        cast(price as decimal(10,2)) as price,
        cast(msrp as decimal(10,2)) as msrp,    
        min(stock_level, 0) as stock_level,
        min(depletion_level, 0) as depletion_level,
        low_stock as low_stock_flag,
        cast(estimated_delivery_date as date) as estimated_delivery_date,
        case when new_arrival = 'Y' then true else false end as new_arrival_flag,   
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, variant order by dw_insert_timestamp desc) as row_num
    from rugs_usa_variant
)


Select *
from base 
where row_num = 1
  );
[0m18:01:41.504829 [debug] [Thread-2 (]: Postgres adapter: Postgres error: function min(integer, integer) does not exist
LINE 18:         min(stock_level, 0) as stock_level,
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:01:41.505490 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: ROLLBACK
[0m18:01:41.506517 [debug] [Thread-2 (]: finished collecting timing info
[0m18:01:41.507119 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: Close
[0m18:01:41.508392 [debug] [Thread-2 (]: Database Error in model parent_variant_map (models/staging/parent_variant_map.sql)
  function min(integer, integer) does not exist
  LINE 18:         min(stock_level, 0) as stock_level,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/jaffle_shop/models/staging/parent_variant_map.sql
[0m18:01:41.509478 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '276a7514-4d4a-4b98-913b-123ec6fa6d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf23b9ba0>]}
[0m18:01:41.510758 [error] [Thread-2 (]: 2 of 2 ERROR creating view model public_staging.parent_variant_map ............. [[31mERROR[0m in 0.47s]
[0m18:01:41.511948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m18:01:41.513169 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.parent_variant_map
[0m18:01:41.513932 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m18:01:41.515632 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */

  create view "postgres"."public_staging"."parent_product__dbt_tmp" as (
    with base as (
    Select
        md5(pid || split_part(url, '/', 5)) as parent_product_uuid,
        pid as parent_product_id,
        product_type_id as parent_product_type_id,
        name as parent_product_name,
        url as parent_product_url,
        split_part(url, '/', 5) as color_derived_url,
        thickness,
        material,
        weave_feature, 
        brand,
        category,
        availability,
        clearance,
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, split_part(url, '/', 5) order by dw_insert_timestamp desc) as row_num
    from rugs_usa_parent
)


Select *
from base 
where row_num = 1
  );
[0m18:01:41.525901 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m18:01:41.559591 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m18:01:41.560468 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product" rename to "parent_product__dbt_backup"
[0m18:01:41.561652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:01:41.573869 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m18:01:41.574780 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product__dbt_tmp" rename to "parent_product"
[0m18:01:41.575902 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:01:41.680744 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: COMMIT
[0m18:01:41.681572 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m18:01:41.682107 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: COMMIT
[0m18:01:41.684149 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:01:41.706982 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m18:01:41.707658 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
drop view if exists "postgres"."public_staging"."parent_product__dbt_backup" cascade
[0m18:01:41.709831 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:01:41.714250 [debug] [Thread-1 (]: finished collecting timing info
[0m18:01:41.714855 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: Close
[0m18:01:41.716323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '276a7514-4d4a-4b98-913b-123ec6fa6d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf23b7730>]}
[0m18:01:41.717571 [info ] [Thread-1 (]: 1 of 2 OK created view model public_staging.parent_product ..................... [[32mCREATE VIEW[0m in 0.68s]
[0m18:01:41.718954 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.parent_product
[0m18:01:41.724420 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:01:41.725384 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:41.725935 [debug] [MainThread]: On master: BEGIN
[0m18:01:41.726416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:01:41.763692 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m18:01:41.764714 [debug] [MainThread]: On master: COMMIT
[0m18:01:41.765263 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:41.765819 [debug] [MainThread]: On master: COMMIT
[0m18:01:41.766528 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:01:41.767110 [debug] [MainThread]: On master: Close
[0m18:01:41.768814 [info ] [MainThread]: 
[0m18:01:41.770106 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m18:01:41.771450 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:41.772122 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_variant_map' was properly closed.
[0m18:01:41.772643 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_product' was properly closed.
[0m18:01:41.811184 [info ] [MainThread]: 
[0m18:01:41.812230 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:01:41.813384 [info ] [MainThread]: 
[0m18:01:41.814237 [error] [MainThread]: [33mDatabase Error in model parent_variant_map (models/staging/parent_variant_map.sql)[0m
[0m18:01:41.815126 [error] [MainThread]:   function min(integer, integer) does not exist
[0m18:01:41.816023 [error] [MainThread]:   LINE 18:         min(stock_level, 0) as stock_level,
[0m18:01:41.816873 [error] [MainThread]:                    ^
[0m18:01:41.817651 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m18:01:41.818588 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/staging/parent_variant_map.sql
[0m18:01:41.820104 [info ] [MainThread]: 
[0m18:01:41.821852 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:01:41.823802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd304f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd31cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd32380>]}


============================== 2024-07-21 20:33:59.554536 | f7e64c5c-fdc1-42c5-a9b6-bf213070a248 ==============================
[0m20:33:59.555480 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:33:59.561032 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:33:59.562568 [debug] [MainThread]: Tracking: tracking
[0m20:33:59.616563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f20bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f20370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f20d90>]}
[0m20:33:59.777888 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:33:59.779789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f7e64c5c-fdc1-42c5-a9b6-bf213070a248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f2a290>]}
[0m20:33:59.913118 [debug] [MainThread]: Parsing macros/relations.sql
[0m20:33:59.925723 [debug] [MainThread]: Parsing macros/catalog.sql
[0m20:33:59.940569 [debug] [MainThread]: Parsing macros/adapters.sql
[0m20:34:00.104353 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m20:34:00.111821 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m20:34:00.120230 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m20:34:00.161650 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m20:34:00.164217 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m20:34:00.170378 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m20:34:00.173832 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m20:34:00.183450 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m20:34:00.233766 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m20:34:00.259927 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m20:34:00.274103 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m20:34:00.282404 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m20:34:00.291742 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m20:34:00.296202 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m20:34:00.299849 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m20:34:00.304595 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m20:34:00.312421 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m20:34:00.348776 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m20:34:00.356301 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m20:34:00.362840 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m20:34:00.368878 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m20:34:00.373818 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m20:34:00.379646 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m20:34:00.383982 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m20:34:00.394148 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m20:34:00.407600 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m20:34:00.415210 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m20:34:00.420867 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m20:34:00.426877 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m20:34:00.433010 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m20:34:00.437414 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m20:34:00.443599 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m20:34:00.448763 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m20:34:00.454457 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m20:34:00.460412 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m20:34:00.465552 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m20:34:00.477249 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m20:34:00.484752 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m20:34:00.497874 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m20:34:00.520107 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m20:34:00.536439 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m20:34:00.571011 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m20:34:00.591686 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m20:34:00.624881 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m20:34:00.637809 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m20:34:00.644869 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m20:34:00.653300 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m20:34:00.755151 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m20:34:00.781723 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m20:34:00.875997 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m20:34:00.934006 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m20:34:01.044363 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m20:34:01.087189 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m20:34:01.158635 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m20:34:01.167956 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m20:34:01.246866 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m20:34:01.351876 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m20:34:01.362362 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m20:34:01.372480 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m20:34:01.399584 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m20:34:01.416100 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m20:34:01.431245 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m20:34:01.457194 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m20:34:01.513999 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m20:34:01.556207 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m20:34:01.637966 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m20:34:01.724678 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m20:34:01.737584 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m20:34:03.098592 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_variant_map.sql
[0m20:34:03.162316 [debug] [MainThread]: 1699: static parser successfully parsed staging/pad_product_map.sql
[0m20:34:03.173855 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_product.sql
[0m20:34:03.391166 [warn ] [MainThread]: [[33mWARNING[0m]: 'rugs_usa_variant' is a seed node, but it is specified in the models section of
seeds/schema.yml. To fix this error, place the `rugs_usa_variant` specification
under the seeds key instead.
[0m20:34:03.692408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7e64c5c-fdc1-42c5-a9b6-bf213070a248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f87c70>]}
[0m20:34:03.739392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7e64c5c-fdc1-42c5-a9b6-bf213070a248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10efd60>]}
[0m20:34:03.741144 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:34:03.743610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7e64c5c-fdc1-42c5-a9b6-bf213070a248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f8cbe0>]}
[0m20:34:03.753097 [info ] [MainThread]: 
[0m20:34:03.755745 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:34:03.761907 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m20:34:03.829744 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:34:03.830826 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:34:03.831536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:03.919337 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.09 seconds
[0m20:34:03.926668 [debug] [ThreadPool]: On list_postgres: Close
[0m20:34:03.934803 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m20:34:03.939017 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m20:34:03.986415 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:34:03.996704 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:34:03.997541 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m20:34:03.998185 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m20:34:03.998803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:34:03.999413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:04.040000 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m20:34:04.041263 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m20:34:04.041782 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m20:34:04.042408 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m20:34:04.043023 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:34:04.043634 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m20:34:04.049407 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m20:34:04.050043 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m20:34:04.056402 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m20:34:04.062362 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m20:34:04.063571 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m20:34:04.064169 [debug] [ThreadPool]: On list_postgres_public: Close
[0m20:34:04.088996 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:04.089957 [debug] [MainThread]: On master: BEGIN
[0m20:34:04.090507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:34:04.127784 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m20:34:04.128809 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:04.129422 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:34:04.134291 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m20:34:04.140053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7e64c5c-fdc1-42c5-a9b6-bf213070a248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f874f0>]}
[0m20:34:04.141173 [debug] [MainThread]: On master: ROLLBACK
[0m20:34:04.141897 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:04.142425 [debug] [MainThread]: On master: BEGIN
[0m20:34:04.143327 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:34:04.143955 [debug] [MainThread]: On master: COMMIT
[0m20:34:04.144554 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:04.145067 [debug] [MainThread]: On master: COMMIT
[0m20:34:04.145744 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:34:04.146388 [debug] [MainThread]: On master: Close
[0m20:34:04.147885 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:34:04.148857 [info ] [MainThread]: 
[0m20:34:04.163413 [debug] [Thread-1 (]: Began running node model.jaffle_shop.parent_product
[0m20:34:04.164141 [debug] [Thread-2 (]: Began running node model.jaffle_shop.parent_variant_map
[0m20:34:04.165248 [info ] [Thread-1 (]: 1 of 2 START view model public_staging.parent_product .......................... [RUN]
[0m20:34:04.166369 [info ] [Thread-2 (]: 2 of 2 START view model public_staging.parent_variant_map ...................... [RUN]
[0m20:34:04.168147 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.parent_product"
[0m20:34:04.169865 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.parent_variant_map"
[0m20:34:04.170632 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.parent_product
[0m20:34:04.171287 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.parent_variant_map
[0m20:34:04.171898 [debug] [Thread-1 (]: Compiling model.jaffle_shop.parent_product
[0m20:34:04.172495 [debug] [Thread-2 (]: Compiling model.jaffle_shop.parent_variant_map
[0m20:34:04.181120 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.parent_product"
[0m20:34:04.188759 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.parent_variant_map"
[0m20:34:04.191864 [debug] [Thread-1 (]: finished collecting timing info
[0m20:34:04.192478 [debug] [Thread-2 (]: finished collecting timing info
[0m20:34:04.192913 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.parent_product
[0m20:34:04.193603 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.parent_variant_map
[0m20:34:04.681888 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.parent_product"
[0m20:34:04.682594 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.parent_variant_map"
[0m20:34:04.686890 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m20:34:04.687403 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m20:34:04.688408 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: BEGIN
[0m20:34:04.688872 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:34:04.687907 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: BEGIN
[0m20:34:04.690633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:34:04.730123 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m20:34:04.731478 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m20:34:04.732132 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */

  create view "postgres"."public_staging"."parent_variant_map__dbt_tmp" as (
    with base as (
    Select
        md5(pid || variant) as parent_variant_map_uuid,
        pid as product_product_id,
        variant as variant_id,
        actual_size,
        weave_feature,
        weave_cat,
        size_grp,
        shipping_size,
        shape,
        cast(weight as float) as weight,
        cast(price as decimal(10,2)) as price,
        cast(msrp as decimal(10,2)) as msrp,    
        least(stock_level, 0) as stock_level,  --assuming stock level can't be negative
        least(depletion_level, 0) as depletion_level,
        low_stock as low_stock_flag,
        cast(estimated_delivery_date as date) as estimated_delivery_date,
        case when new_arrival = 'Y' then true else false end as new_arrival_flag,   
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, variant order by dw_insert_timestamp desc) as row_num
    from rugs_usa_variant
)


Select *
from base 
where row_num = 1
  );
[0m20:34:04.734069 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m20:34:04.734878 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m20:34:04.735477 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */

  create view "postgres"."public_staging"."parent_product__dbt_tmp" as (
    with base as (
    Select
        md5(pid || split_part(url, '/', 5)) as parent_product_uuid,
        pid as parent_product_id,
        product_type_id as parent_product_type_id,
        name as parent_product_name,
        url as parent_product_url,
        split_part(url, '/', 5) as color_derived_url,
        thickness,
        material,
        weave_feature, 
        brand,
        category,
        availability,
        clearance,
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, split_part(url, '/', 5) order by dw_insert_timestamp desc) as row_num
    from rugs_usa_parent
)


Select *
from base 
where row_num = 1
  );
[0m20:34:04.740993 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m20:34:04.741692 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m20:34:04.789120 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m20:34:04.791327 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product" rename to "parent_product__dbt_backup"
[0m20:34:04.790450 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m20:34:04.792434 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map__dbt_tmp" rename to "parent_variant_map"
[0m20:34:04.795579 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:34:04.795988 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:34:04.807177 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m20:34:04.838454 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product__dbt_tmp" rename to "parent_product"
[0m20:34:04.860489 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m20:34:04.943625 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m20:34:04.944973 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: COMMIT
[0m20:34:04.946266 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m20:34:04.946786 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: COMMIT
[0m20:34:04.945738 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m20:34:04.947677 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m20:34:04.951333 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:34:04.951966 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:34:04.988115 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m20:34:04.988935 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m20:34:04.990305 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
drop view if exists "postgres"."public_staging"."parent_product__dbt_backup" cascade
[0m20:34:04.989744 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
drop view if exists "postgres"."public_staging"."parent_variant_map__dbt_backup" cascade
[0m20:34:04.991625 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:34:04.996612 [debug] [Thread-2 (]: finished collecting timing info
[0m20:34:04.997727 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: Close
[0m20:34:04.997050 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m20:34:04.999445 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7e64c5c-fdc1-42c5-a9b6-bf213070a248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd46a40>]}
[0m20:34:05.005559 [info ] [Thread-2 (]: 2 of 2 OK created view model public_staging.parent_variant_map ................. [[32mCREATE VIEW[0m in 0.83s]
[0m20:34:05.004031 [debug] [Thread-1 (]: finished collecting timing info
[0m20:34:05.008444 [debug] [Thread-1 (]: On model.jaffle_shop.parent_product: Close
[0m20:34:05.007583 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.parent_variant_map
[0m20:34:05.011931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7e64c5c-fdc1-42c5-a9b6-bf213070a248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd46f50>]}
[0m20:34:05.014147 [info ] [Thread-1 (]: 1 of 2 OK created view model public_staging.parent_product ..................... [[32mCREATE VIEW[0m in 0.84s]
[0m20:34:05.015631 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.parent_product
[0m20:34:05.021044 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m20:34:05.021995 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:05.022533 [debug] [MainThread]: On master: BEGIN
[0m20:34:05.023013 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:34:05.062856 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m20:34:05.063875 [debug] [MainThread]: On master: COMMIT
[0m20:34:05.064393 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:05.064868 [debug] [MainThread]: On master: COMMIT
[0m20:34:05.065515 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:34:05.066061 [debug] [MainThread]: On master: Close
[0m20:34:05.068227 [info ] [MainThread]: 
[0m20:34:05.069316 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.31 seconds (1.31s).
[0m20:34:05.070483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:34:05.071246 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_product' was properly closed.
[0m20:34:05.071897 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_variant_map' was properly closed.
[0m20:34:05.113222 [info ] [MainThread]: 
[0m20:34:05.114535 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:34:05.116420 [info ] [MainThread]: 
[0m20:34:05.117534 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:34:05.119268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f7e6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f7cbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd463b0>]}


============================== 2024-07-21 23:49:57.624786 | 6c6ebc69-185d-4b0a-b950-bb43ab56139e ==============================
[0m23:49:57.625399 [info ] [MainThread]: Running with dbt=1.2.0
[0m23:49:57.632839 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:49:57.633824 [debug] [MainThread]: Tracking: tracking
[0m23:49:57.692768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f37f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f34bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f37130>]}
[0m23:49:57.919373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m23:49:57.921223 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/link_product_map.sql
[0m23:49:57.923304 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/staging/schema.yaml
[0m23:49:57.924590 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://seeds/schema.yml
[0m23:49:58.019480 [debug] [MainThread]: 1699: static parser successfully parsed staging/link_product_map.sql
[0m23:49:58.090836 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_variant_map.sql
[0m23:49:58.272506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c6ebc69-185d-4b0a-b950-bb43ab56139e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10e18a0>]}
[0m23:49:58.331616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c6ebc69-185d-4b0a-b950-bb43ab56139e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab107bf40>]}
[0m23:49:58.333308 [info ] [MainThread]: Found 4 models, 5 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:49:58.334546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c6ebc69-185d-4b0a-b950-bb43ab56139e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1d360>]}
[0m23:49:58.343437 [info ] [MainThread]: 
[0m23:49:58.345715 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m23:49:58.356957 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m23:49:58.419110 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:49:58.420077 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:49:58.420781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:58.509773 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.09 seconds
[0m23:49:58.517138 [debug] [ThreadPool]: On list_postgres: Close
[0m23:49:58.526150 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m23:49:58.527957 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m23:49:58.567304 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m23:49:58.582705 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:49:58.583116 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m23:49:58.583764 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m23:49:58.584355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:58.584982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:58.625346 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m23:49:58.625997 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m23:49:58.626815 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m23:49:58.627449 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:49:58.628036 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m23:49:58.628618 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:49:58.635745 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m23:49:58.636278 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m23:49:58.641903 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m23:49:58.647754 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m23:49:58.648786 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m23:49:58.649390 [debug] [ThreadPool]: On list_postgres_public: Close
[0m23:49:58.674061 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:58.674945 [debug] [MainThread]: On master: BEGIN
[0m23:49:58.675519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:49:58.712527 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m23:49:58.713479 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:58.714017 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:49:58.720151 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
[0m23:49:58.726022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c6ebc69-185d-4b0a-b950-bb43ab56139e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf2340df0>]}
[0m23:49:58.727130 [debug] [MainThread]: On master: ROLLBACK
[0m23:49:58.727843 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:58.728413 [debug] [MainThread]: On master: BEGIN
[0m23:49:58.729370 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:49:58.730006 [debug] [MainThread]: On master: COMMIT
[0m23:49:58.730571 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:58.731070 [debug] [MainThread]: On master: COMMIT
[0m23:49:58.731746 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:49:58.732332 [debug] [MainThread]: On master: Close
[0m23:49:58.733666 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m23:49:58.734604 [info ] [MainThread]: 
[0m23:49:58.749120 [debug] [Thread-1 (]: Began running node model.jaffle_shop.link_product_map
[0m23:49:58.749806 [debug] [Thread-2 (]: Began running node model.jaffle_shop.parent_product
[0m23:49:58.750909 [info ] [Thread-1 (]: 1 of 3 START view model public_staging.link_product_map ........................ [RUN]
[0m23:49:58.751995 [info ] [Thread-2 (]: 2 of 3 START view model public_staging.parent_product .......................... [RUN]
[0m23:49:58.754249 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.link_product_map"
[0m23:49:58.756713 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.parent_product"
[0m23:49:58.757462 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.link_product_map
[0m23:49:58.758107 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.parent_product
[0m23:49:58.758766 [debug] [Thread-1 (]: Compiling model.jaffle_shop.link_product_map
[0m23:49:58.759345 [debug] [Thread-2 (]: Compiling model.jaffle_shop.parent_product
[0m23:49:58.767535 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.link_product_map"
[0m23:49:58.778356 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.parent_product"
[0m23:49:58.781974 [debug] [Thread-1 (]: finished collecting timing info
[0m23:49:58.782543 [debug] [Thread-2 (]: finished collecting timing info
[0m23:49:58.783780 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.parent_product
[0m23:49:58.783154 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.link_product_map
[0m23:49:59.189606 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.parent_product"
[0m23:49:59.190136 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.link_product_map"
[0m23:49:59.193066 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m23:49:59.194116 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: BEGIN
[0m23:49:59.194582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:59.193790 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:49:59.196388 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: BEGIN
[0m23:49:59.196939 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:49:59.236943 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m23:49:59.238015 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m23:49:59.239051 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */

  create view "postgres"."public_staging"."link_product_map__dbt_tmp" as (
    with base as (
    Select *, row_number() over (partition by card_links order by page_rank) as row_num
    from (
        Select
        md5(card_links) as link_product_map_uuid,
        split_part(split_part(card_links, '/', -1), '-', 1) as pid, --the last element of the card_links is the pid
        split_part(card_links, '/', -2) as color, --the penultimate element of the card_links is the color
        case when split_part(split_part(page_links, '/', -1), '?', 2) = '' then 1
            else cast(
                    split_part(
                        split_part(split_part(page_links, '/', -1), '?', 2),
                        '=',
                        2
                    ) as int) end as page_rank,    --the second element of the query string is the page rank
        request_timestamp::timestamptz as request_timestamp_utc --assuming timestamp is in utc at the source
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc --assuming timestamp is in utc at the source
        card_links, 
        page_links,
        from rugs_usa_links) links
)

Select *
from base
where row_num = 1
  );
[0m23:49:59.238517 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m23:49:59.241706 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:49:59.242208 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */

  create view "postgres"."public_staging"."parent_product__dbt_tmp" as (
    with base as (
    Select
        md5(pid || split_part(url, '/', 5)) as parent_product_uuid,
        pid as parent_product_id,
        product_type_id as parent_product_type_id,
        name as parent_product_name,
        url as parent_product_url,
        split_part(url, '/', 5) as color_derived_url,
        thickness,
        material,
        weave_feature, 
        brand,
        category,
        availability,
        clearance,
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, split_part(url, '/', 5) order by dw_insert_timestamp desc) as row_num
    from rugs_usa_parent
)


Select *
from base 
where row_num = 1
  );
[0m23:49:59.241282 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "dw_insert_timestamp"
LINE 19:         dw_insert_timestamp::timestamptz as dw_insert_timest...
                 ^

[0m23:49:59.242956 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: ROLLBACK
[0m23:49:59.244002 [debug] [Thread-1 (]: finished collecting timing info
[0m23:49:59.244656 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: Close
[0m23:49:59.246303 [debug] [Thread-1 (]: Database Error in model link_product_map (models/staging/link_product_map.sql)
  syntax error at or near "dw_insert_timestamp"
  LINE 19:         dw_insert_timestamp::timestamptz as dw_insert_timest...
                   ^
  compiled SQL at target/run/jaffle_shop/models/staging/link_product_map.sql
[0m23:49:59.247762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c6ebc69-185d-4b0a-b950-bb43ab56139e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10a8760>]}
[0m23:49:59.249270 [error] [Thread-1 (]: 1 of 3 ERROR creating view model public_staging.link_product_map ............... [[31mERROR[0m in 0.49s]
[0m23:49:59.251376 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.link_product_map
[0m23:49:59.252560 [debug] [Thread-1 (]: Began running node model.jaffle_shop.parent_variant_map
[0m23:49:59.255635 [info ] [Thread-1 (]: 3 of 3 START view model public_staging.parent_variant_map ...................... [RUN]
[0m23:49:59.254306 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m23:49:59.257476 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:49:59.287540 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.parent_variant_map
[0m23:49:59.295078 [debug] [Thread-1 (]: Compiling model.jaffle_shop.parent_variant_map
[0m23:49:59.294262 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:49:59.303294 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product" rename to "parent_product__dbt_backup"
[0m23:49:59.302659 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.parent_variant_map"
[0m23:49:59.305881 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:49:59.306743 [debug] [Thread-1 (]: finished collecting timing info
[0m23:49:59.318880 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.parent_variant_map
[0m23:49:59.318068 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:49:59.339040 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product__dbt_tmp" rename to "parent_product"
[0m23:49:59.338532 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.parent_variant_map"
[0m23:49:59.340197 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:49:59.369423 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:49:59.386489 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: BEGIN
[0m23:49:59.403246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:59.454939 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m23:49:59.456066 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:49:59.457162 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m23:49:59.456590 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m23:49:59.457995 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:49:59.458562 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */

  create view "postgres"."public_staging"."parent_variant_map__dbt_tmp" as (
    with base as (
    Select
        md5(pid || variant) as parent_variant_map_uuid,
        pid as product_product_id,
        variant as variant_id,
        actual_size,
        weave_feature,
        weave_cat,
        size_grp,
        shipping_size,
        shape,
        cast(weight as float) as weight,
        cast(price as decimal(10,2)) as price,
        cast(msrp as decimal(10,2)) as msrp,    
        least(stock_level, 0) as stock_level,  --assuming stock level can't be negative
        least(depletion_level, 0) as depletion_level,
        low_stock as low_stock_flag,
        cast(estimated_delivery_date as date) as estimated_delivery_date,
        case when new_arrival = 'Y' then true else false end as new_arrival_flag,   
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, variant order by dw_insert_timestamp desc) as row_num
    from rugs_usa_variant
)


Select *
from base 
where row_num = 1
  );
[0m23:49:59.462021 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:49:59.473329 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m23:49:59.501525 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:49:59.504003 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:49:59.505204 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map" rename to "parent_variant_map__dbt_backup"
[0m23:49:59.504651 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
drop view if exists "postgres"."public_staging"."parent_product__dbt_backup" cascade
[0m23:49:59.506391 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:49:59.515652 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.01 seconds
[0m23:49:59.518537 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:49:59.523416 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map__dbt_tmp" rename to "parent_variant_map"
[0m23:49:59.522852 [debug] [Thread-2 (]: finished collecting timing info
[0m23:49:59.524294 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: Close
[0m23:49:59.524688 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:49:59.526231 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c6ebc69-185d-4b0a-b950-bb43ab56139e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf23402e0>]}
[0m23:49:59.534851 [info ] [Thread-2 (]: 2 of 3 OK created view model public_staging.parent_product ..................... [[32mCREATE VIEW[0m in 0.77s]
[0m23:49:59.533455 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m23:49:59.536406 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.parent_product
[0m23:49:59.537029 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:49:59.538292 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m23:49:59.539749 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:49:59.548164 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:49:59.548759 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
drop view if exists "postgres"."public_staging"."parent_variant_map__dbt_backup" cascade
[0m23:49:59.550759 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:49:59.556351 [debug] [Thread-1 (]: finished collecting timing info
[0m23:49:59.557247 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: Close
[0m23:49:59.558834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c6ebc69-185d-4b0a-b950-bb43ab56139e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd20c40>]}
[0m23:49:59.560081 [info ] [Thread-1 (]: 3 of 3 OK created view model public_staging.parent_variant_map ................. [[32mCREATE VIEW[0m in 0.30s]
[0m23:49:59.561479 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.parent_variant_map
[0m23:49:59.567032 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m23:49:59.567932 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:59.568448 [debug] [MainThread]: On master: BEGIN
[0m23:49:59.568969 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:49:59.606818 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m23:49:59.607774 [debug] [MainThread]: On master: COMMIT
[0m23:49:59.608294 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:59.608816 [debug] [MainThread]: On master: COMMIT
[0m23:49:59.609493 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:49:59.610065 [debug] [MainThread]: On master: Close
[0m23:49:59.611908 [info ] [MainThread]: 
[0m23:49:59.612835 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m23:49:59.613851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:49:59.614480 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_product' was properly closed.
[0m23:49:59.614947 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_variant_map' was properly closed.
[0m23:49:59.658220 [info ] [MainThread]: 
[0m23:49:59.659314 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:49:59.660437 [info ] [MainThread]: 
[0m23:49:59.661377 [error] [MainThread]: [33mDatabase Error in model link_product_map (models/staging/link_product_map.sql)[0m
[0m23:49:59.662360 [error] [MainThread]:   syntax error at or near "dw_insert_timestamp"
[0m23:49:59.663159 [error] [MainThread]:   LINE 19:         dw_insert_timestamp::timestamptz as dw_insert_timest...
[0m23:49:59.663957 [error] [MainThread]:                    ^
[0m23:49:59.664837 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/staging/link_product_map.sql
[0m23:49:59.665879 [info ] [MainThread]: 
[0m23:49:59.667307 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:49:59.669223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10a8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10a9240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf23418d0>]}


============================== 2024-07-21 23:51:10.555140 | 7e33096f-c18b-46f0-b59b-e25f78c1517c ==============================
[0m23:51:10.555736 [info ] [MainThread]: Running with dbt=1.2.0
[0m23:51:10.559688 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:51:10.560645 [debug] [MainThread]: Tracking: tracking
[0m23:51:10.595931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f20bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f20370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f21810>]}
[0m23:51:10.795306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:51:10.797501 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/link_product_map.sql
[0m23:51:10.878276 [debug] [MainThread]: 1699: static parser successfully parsed staging/link_product_map.sql
[0m23:51:11.092912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e33096f-c18b-46f0-b59b-e25f78c1517c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10d3190>]}
[0m23:51:11.136803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e33096f-c18b-46f0-b59b-e25f78c1517c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1081f60>]}
[0m23:51:11.138081 [info ] [MainThread]: Found 4 models, 5 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:51:11.139097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e33096f-c18b-46f0-b59b-e25f78c1517c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1083fa0>]}
[0m23:51:11.146368 [info ] [MainThread]: 
[0m23:51:11.148286 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m23:51:11.156649 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m23:51:11.215758 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:51:11.216647 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:51:11.217151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:11.284926 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.07 seconds
[0m23:51:11.291399 [debug] [ThreadPool]: On list_postgres: Close
[0m23:51:11.299197 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m23:51:11.300735 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m23:51:11.338897 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:51:11.353758 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m23:51:11.354147 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m23:51:11.354781 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m23:51:11.355370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:11.355976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:11.396169 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m23:51:11.396845 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m23:51:11.397588 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:51:11.398215 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m23:51:11.398796 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:51:11.399396 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m23:51:11.403311 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:51:11.403836 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m23:51:11.409480 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m23:51:11.414976 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m23:51:11.416007 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m23:51:11.416593 [debug] [ThreadPool]: On list_postgres_public: Close
[0m23:51:11.441738 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:11.442618 [debug] [MainThread]: On master: BEGIN
[0m23:51:11.443111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:11.480029 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m23:51:11.480913 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:11.481445 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:51:11.486637 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:51:11.492190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e33096f-c18b-46f0-b59b-e25f78c1517c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f2a5f0>]}
[0m23:51:11.493213 [debug] [MainThread]: On master: ROLLBACK
[0m23:51:11.493871 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:11.494343 [debug] [MainThread]: On master: BEGIN
[0m23:51:11.495156 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:51:11.495770 [debug] [MainThread]: On master: COMMIT
[0m23:51:11.496301 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:11.496769 [debug] [MainThread]: On master: COMMIT
[0m23:51:11.497432 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:51:11.497978 [debug] [MainThread]: On master: Close
[0m23:51:11.499188 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m23:51:11.500095 [info ] [MainThread]: 
[0m23:51:11.513066 [debug] [Thread-1 (]: Began running node model.jaffle_shop.link_product_map
[0m23:51:11.513698 [debug] [Thread-2 (]: Began running node model.jaffle_shop.parent_product
[0m23:51:11.514786 [info ] [Thread-1 (]: 1 of 3 START view model public_staging.link_product_map ........................ [RUN]
[0m23:51:11.515824 [info ] [Thread-2 (]: 2 of 3 START view model public_staging.parent_product .......................... [RUN]
[0m23:51:11.517872 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.link_product_map"
[0m23:51:11.520607 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.parent_product"
[0m23:51:11.521428 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.link_product_map
[0m23:51:11.522084 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.parent_product
[0m23:51:11.522686 [debug] [Thread-1 (]: Compiling model.jaffle_shop.link_product_map
[0m23:51:11.523288 [debug] [Thread-2 (]: Compiling model.jaffle_shop.parent_product
[0m23:51:11.531100 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.link_product_map"
[0m23:51:11.539482 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.parent_product"
[0m23:51:11.542185 [debug] [Thread-1 (]: finished collecting timing info
[0m23:51:11.542930 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.link_product_map
[0m23:51:11.543539 [debug] [Thread-2 (]: finished collecting timing info
[0m23:51:11.567916 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.parent_product
[0m23:51:11.944882 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.parent_product"
[0m23:51:11.938840 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.link_product_map"
[0m23:51:11.947893 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:51:11.948409 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m23:51:11.949385 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: BEGIN
[0m23:51:11.949825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:11.948895 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: BEGIN
[0m23:51:11.952398 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:11.988303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m23:51:11.989418 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m23:51:11.990641 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */

  create view "postgres"."public_staging"."link_product_map__dbt_tmp" as (
    with base as (
    Select *, row_number() over (partition by card_links order by page_rank) as row_num
    from (
        Select
        md5(card_links) as link_product_map_uuid,
        split_part(split_part(card_links, '/', -1), '-', 1) as pid, --the last element of the card_links is the pid
        split_part(card_links, '/', -2) as color, --the penultimate element of the card_links is the color
        case when split_part(split_part(page_links, '/', -1), '?', 2) = '' then 1
            else cast(
                    split_part(
                        split_part(split_part(page_links, '/', -1), '?', 2),
                        '=',
                        2
                    ) as int) end as page_rank,    --the second element of the query string is the page rank
        request_timestamp::timestamptz as request_timestamp_utc, --assuming timestamp is in utc at the source
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc --assuming timestamp is in utc at the source
        card_links, 
        page_links,
        from rugs_usa_links) links
)

Select *
from base
where row_num = 1
  );
[0m23:51:11.990187 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m23:51:11.991586 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:51:11.994106 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */

  create view "postgres"."public_staging"."parent_product__dbt_tmp" as (
    with base as (
    Select
        md5(pid || split_part(url, '/', 5)) as parent_product_uuid,
        pid as parent_product_id,
        product_type_id as parent_product_type_id,
        name as parent_product_name,
        url as parent_product_url,
        split_part(url, '/', 5) as color_derived_url,
        thickness,
        material,
        weave_feature, 
        brand,
        category,
        availability,
        clearance,
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, split_part(url, '/', 5) order by dw_insert_timestamp desc) as row_num
    from rugs_usa_parent
)


Select *
from base 
where row_num = 1
  );
[0m23:51:11.993550 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "card_links"
LINE 20:         card_links, 
                 ^

[0m23:51:11.995067 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: ROLLBACK
[0m23:51:11.996122 [debug] [Thread-1 (]: finished collecting timing info
[0m23:51:11.996808 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: Close
[0m23:51:11.998362 [debug] [Thread-1 (]: Database Error in model link_product_map (models/staging/link_product_map.sql)
  syntax error at or near "card_links"
  LINE 20:         card_links, 
                   ^
  compiled SQL at target/run/jaffle_shop/models/staging/link_product_map.sql
[0m23:51:11.999663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e33096f-c18b-46f0-b59b-e25f78c1517c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf238a800>]}
[0m23:51:12.001142 [error] [Thread-1 (]: 1 of 3 ERROR creating view model public_staging.link_product_map ............... [[31mERROR[0m in 0.48s]
[0m23:51:12.003281 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.link_product_map
[0m23:51:12.003989 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m23:51:12.005493 [debug] [Thread-1 (]: Began running node model.jaffle_shop.parent_variant_map
[0m23:51:12.041999 [info ] [Thread-1 (]: 3 of 3 START view model public_staging.parent_variant_map ...................... [RUN]
[0m23:51:12.041157 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:51:12.044449 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product" rename to "parent_product__dbt_backup"
[0m23:51:12.043757 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:51:12.045450 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.parent_variant_map
[0m23:51:12.046510 [debug] [Thread-1 (]: Compiling model.jaffle_shop.parent_variant_map
[0m23:51:12.046070 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:51:12.054856 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.parent_variant_map"
[0m23:51:12.066038 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:51:12.067214 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product__dbt_tmp" rename to "parent_product"
[0m23:51:12.068304 [debug] [Thread-1 (]: finished collecting timing info
[0m23:51:12.069840 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.parent_variant_map
[0m23:51:12.068808 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:51:12.089001 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.parent_variant_map"
[0m23:51:12.141539 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:51:12.153354 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: BEGIN
[0m23:51:12.165322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:12.205026 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m23:51:12.206827 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:51:12.213297 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m23:51:12.214920 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m23:51:12.216058 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:51:12.216597 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */

  create view "postgres"."public_staging"."parent_variant_map__dbt_tmp" as (
    with base as (
    Select
        md5(pid || variant) as parent_variant_map_uuid,
        pid as product_product_id,
        variant as variant_id,
        actual_size,
        weave_feature,
        weave_cat,
        size_grp,
        shipping_size,
        shape,
        cast(weight as float) as weight,
        cast(price as decimal(10,2)) as price,
        cast(msrp as decimal(10,2)) as msrp,    
        least(stock_level, 0) as stock_level,  --assuming stock level can't be negative
        least(depletion_level, 0) as depletion_level,
        low_stock as low_stock_flag,
        cast(estimated_delivery_date as date) as estimated_delivery_date,
        case when new_arrival = 'Y' then true else false end as new_arrival_flag,   
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, variant order by dw_insert_timestamp desc) as row_num
    from rugs_usa_variant
)


Select *
from base 
where row_num = 1
  );
[0m23:51:12.215461 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:51:12.226449 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m23:51:12.244907 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:51:12.256376 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
drop view if exists "postgres"."public_staging"."parent_product__dbt_backup" cascade
[0m23:51:12.255751 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:51:12.257263 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map" rename to "parent_variant_map__dbt_backup"
[0m23:51:12.258370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:51:12.264908 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.01 seconds
[0m23:51:12.269577 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:51:12.274440 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map__dbt_tmp" rename to "parent_variant_map"
[0m23:51:12.273852 [debug] [Thread-2 (]: finished collecting timing info
[0m23:51:12.275331 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: Close
[0m23:51:12.275711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:51:12.277169 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e33096f-c18b-46f0-b59b-e25f78c1517c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf23db2b0>]}
[0m23:51:12.284277 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m23:51:12.286612 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:51:12.287132 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m23:51:12.285918 [info ] [Thread-2 (]: 2 of 3 OK created view model public_staging.parent_product ..................... [[32mCREATE VIEW[0m in 0.76s]
[0m23:51:12.288945 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.parent_product
[0m23:51:12.289454 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:51:12.299281 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:51:12.299996 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
drop view if exists "postgres"."public_staging"."parent_variant_map__dbt_backup" cascade
[0m23:51:12.302843 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:51:12.308090 [debug] [Thread-1 (]: finished collecting timing info
[0m23:51:12.308810 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: Close
[0m23:51:12.310338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e33096f-c18b-46f0-b59b-e25f78c1517c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf237b490>]}
[0m23:51:12.311568 [info ] [Thread-1 (]: 3 of 3 OK created view model public_staging.parent_variant_map ................. [[32mCREATE VIEW[0m in 0.27s]
[0m23:51:12.312957 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.parent_variant_map
[0m23:51:12.318152 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m23:51:12.319071 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:12.319872 [debug] [MainThread]: On master: BEGIN
[0m23:51:12.320569 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:51:12.364744 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m23:51:12.366017 [debug] [MainThread]: On master: COMMIT
[0m23:51:12.366623 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:12.367156 [debug] [MainThread]: On master: COMMIT
[0m23:51:12.367860 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:51:12.368520 [debug] [MainThread]: On master: Close
[0m23:51:12.371033 [info ] [MainThread]: 
[0m23:51:12.372119 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m23:51:12.373157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:12.373735 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_variant_map' was properly closed.
[0m23:51:12.374201 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_product' was properly closed.
[0m23:51:12.410559 [info ] [MainThread]: 
[0m23:51:12.411622 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:51:12.412668 [info ] [MainThread]: 
[0m23:51:12.413595 [error] [MainThread]: [33mDatabase Error in model link_product_map (models/staging/link_product_map.sql)[0m
[0m23:51:12.414459 [error] [MainThread]:   syntax error at or near "card_links"
[0m23:51:12.415327 [error] [MainThread]:   LINE 20:         card_links, 
[0m23:51:12.416150 [error] [MainThread]:                    ^
[0m23:51:12.416933 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/staging/link_product_map.sql
[0m23:51:12.417836 [info ] [MainThread]: 
[0m23:51:12.419206 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:51:12.421415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10c0b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10c23b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf2351330>]}


============================== 2024-07-21 23:52:01.909032 | 374c936f-4cf8-49e0-964e-0aef00e59009 ==============================
[0m23:52:01.909608 [info ] [MainThread]: Running with dbt=1.2.0
[0m23:52:01.913392 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:52:01.914392 [debug] [MainThread]: Tracking: tracking
[0m23:52:01.945657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1beb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1aa10>]}
[0m23:52:02.156023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:52:02.158654 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/link_product_map.sql
[0m23:52:02.243738 [debug] [MainThread]: 1699: static parser successfully parsed staging/link_product_map.sql
[0m23:52:02.468105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '374c936f-4cf8-49e0-964e-0aef00e59009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10d3190>]}
[0m23:52:02.511657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '374c936f-4cf8-49e0-964e-0aef00e59009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1081f60>]}
[0m23:52:02.512937 [info ] [MainThread]: Found 4 models, 5 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:52:02.513884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '374c936f-4cf8-49e0-964e-0aef00e59009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1083fa0>]}
[0m23:52:02.525143 [info ] [MainThread]: 
[0m23:52:02.527572 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m23:52:02.534432 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m23:52:02.602049 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:52:02.603156 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:52:02.603878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:02.675368 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.07 seconds
[0m23:52:02.682225 [debug] [ThreadPool]: On list_postgres: Close
[0m23:52:02.690554 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m23:52:02.692038 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m23:52:02.723442 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m23:52:02.730736 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:52:02.731482 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m23:52:02.732120 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m23:52:02.732682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:52:02.733272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:02.773707 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m23:52:02.774368 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m23:52:02.775089 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m23:52:02.775691 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:52:02.776276 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m23:52:02.776929 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:52:02.781052 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:52:02.781656 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m23:52:02.788740 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m23:52:02.794513 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m23:52:02.795605 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m23:52:02.796242 [debug] [ThreadPool]: On list_postgres_public: Close
[0m23:52:02.821269 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:02.822176 [debug] [MainThread]: On master: BEGIN
[0m23:52:02.822746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:52:02.859534 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m23:52:02.860419 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:02.860937 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:52:02.864995 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:52:02.870470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '374c936f-4cf8-49e0-964e-0aef00e59009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f37190>]}
[0m23:52:02.871613 [debug] [MainThread]: On master: ROLLBACK
[0m23:52:02.872347 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:02.872929 [debug] [MainThread]: On master: BEGIN
[0m23:52:02.873834 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:52:02.874468 [debug] [MainThread]: On master: COMMIT
[0m23:52:02.874999 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:02.875489 [debug] [MainThread]: On master: COMMIT
[0m23:52:02.876238 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:52:02.876802 [debug] [MainThread]: On master: Close
[0m23:52:02.878095 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m23:52:02.879011 [info ] [MainThread]: 
[0m23:52:02.891930 [debug] [Thread-1 (]: Began running node model.jaffle_shop.link_product_map
[0m23:52:02.892594 [debug] [Thread-2 (]: Began running node model.jaffle_shop.parent_product
[0m23:52:02.893672 [info ] [Thread-1 (]: 1 of 3 START view model public_staging.link_product_map ........................ [RUN]
[0m23:52:02.894924 [info ] [Thread-2 (]: 2 of 3 START view model public_staging.parent_product .......................... [RUN]
[0m23:52:02.897665 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.link_product_map"
[0m23:52:02.899494 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.parent_product"
[0m23:52:02.900300 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.link_product_map
[0m23:52:02.900973 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.parent_product
[0m23:52:02.901615 [debug] [Thread-1 (]: Compiling model.jaffle_shop.link_product_map
[0m23:52:02.902241 [debug] [Thread-2 (]: Compiling model.jaffle_shop.parent_product
[0m23:52:02.910458 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.link_product_map"
[0m23:52:02.918579 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.parent_product"
[0m23:52:02.921119 [debug] [Thread-1 (]: finished collecting timing info
[0m23:52:02.921722 [debug] [Thread-2 (]: finished collecting timing info
[0m23:52:02.922823 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.parent_product
[0m23:52:02.922180 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.link_product_map
[0m23:52:03.322889 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.link_product_map"
[0m23:52:03.323822 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.parent_product"
[0m23:52:03.326483 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m23:52:03.326999 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:52:03.328057 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: BEGIN
[0m23:52:03.328512 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:52:03.327528 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: BEGIN
[0m23:52:03.331279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:52:03.367937 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m23:52:03.368948 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:52:03.369504 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */

  create view "postgres"."public_staging"."parent_product__dbt_tmp" as (
    with base as (
    Select
        md5(pid || split_part(url, '/', 5)) as parent_product_uuid,
        pid as parent_product_id,
        product_type_id as parent_product_type_id,
        name as parent_product_name,
        url as parent_product_url,
        split_part(url, '/', 5) as color_derived_url,
        thickness,
        material,
        weave_feature, 
        brand,
        category,
        availability,
        clearance,
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, split_part(url, '/', 5) order by dw_insert_timestamp desc) as row_num
    from rugs_usa_parent
)


Select *
from base 
where row_num = 1
  );
[0m23:52:03.373205 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:52:03.373800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m23:52:03.398955 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m23:52:03.405987 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */

  create view "postgres"."public_staging"."link_product_map__dbt_tmp" as (
    with base as (
    Select *, row_number() over (partition by card_links order by page_rank) as row_num
    from (
        Select
        md5(card_links) as link_product_map_uuid,
        split_part(split_part(card_links, '/', -1), '-', 1) as pid, --the last element of the card_links is the pid
        split_part(card_links, '/', -2) as color, --the penultimate element of the card_links is the color
        case when split_part(split_part(page_links, '/', -1), '?', 2) = '' then 1
            else cast(
                    split_part(
                        split_part(split_part(page_links, '/', -1), '?', 2),
                        '=',
                        2
                    ) as int) end as page_rank,    --the second element of the query string is the page rank
        request_timestamp::timestamptz as request_timestamp_utc, --assuming timestamp is in utc at the source
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        card_links, 
        page_links,
        from rugs_usa_links) links
)

Select *
from base
where row_num = 1
  );
[0m23:52:03.405591 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:52:03.408729 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product" rename to "parent_product__dbt_backup"
[0m23:52:03.408282 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 22:         from rugs_usa_links) links
                 ^

[0m23:52:03.409589 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: ROLLBACK
[0m23:52:03.410041 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:52:03.411085 [debug] [Thread-1 (]: finished collecting timing info
[0m23:52:03.422661 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: Close
[0m23:52:03.421949 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:52:03.424712 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product__dbt_tmp" rename to "parent_product"
[0m23:52:03.423986 [debug] [Thread-1 (]: Database Error in model link_product_map (models/staging/link_product_map.sql)
  syntax error at or near "from"
  LINE 22:         from rugs_usa_links) links
                   ^
  compiled SQL at target/run/jaffle_shop/models/staging/link_product_map.sql
[0m23:52:03.426084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '374c936f-4cf8-49e0-964e-0aef00e59009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10e4430>]}
[0m23:52:03.426540 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:52:03.427844 [error] [Thread-1 (]: 1 of 3 ERROR creating view model public_staging.link_product_map ............... [[31mERROR[0m in 0.53s]
[0m23:52:03.456005 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.link_product_map
[0m23:52:03.472215 [debug] [Thread-1 (]: Began running node model.jaffle_shop.parent_variant_map
[0m23:52:03.488342 [info ] [Thread-1 (]: 3 of 3 START view model public_staging.parent_variant_map ...................... [RUN]
[0m23:52:03.502249 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:52:03.523997 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.parent_variant_map
[0m23:52:03.537020 [debug] [Thread-1 (]: Compiling model.jaffle_shop.parent_variant_map
[0m23:52:03.556063 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.parent_variant_map"
[0m23:52:03.561731 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m23:52:03.563358 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:52:03.564094 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m23:52:03.564676 [debug] [Thread-1 (]: finished collecting timing info
[0m23:52:03.565525 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.parent_variant_map
[0m23:52:03.566160 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:52:03.583719 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.parent_variant_map"
[0m23:52:03.608194 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:52:03.609272 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
drop view if exists "postgres"."public_staging"."parent_product__dbt_backup" cascade
[0m23:52:03.610437 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:52:03.611153 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: BEGIN
[0m23:52:03.612199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:52:03.611671 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:52:03.623020 [debug] [Thread-2 (]: finished collecting timing info
[0m23:52:03.623875 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: Close
[0m23:52:03.625462 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '374c936f-4cf8-49e0-964e-0aef00e59009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd206d0>]}
[0m23:52:03.626766 [info ] [Thread-2 (]: 2 of 3 OK created view model public_staging.parent_product ..................... [[32mCREATE VIEW[0m in 0.73s]
[0m23:52:03.628196 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.parent_product
[0m23:52:03.653973 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m23:52:03.654899 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:52:03.655444 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */

  create view "postgres"."public_staging"."parent_variant_map__dbt_tmp" as (
    with base as (
    Select
        md5(pid || variant) as parent_variant_map_uuid,
        pid as product_product_id,
        variant as variant_id,
        actual_size,
        weave_feature,
        weave_cat,
        size_grp,
        shipping_size,
        shape,
        cast(weight as float) as weight,
        cast(price as decimal(10,2)) as price,
        cast(msrp as decimal(10,2)) as msrp,    
        least(stock_level, 0) as stock_level,  --assuming stock level can't be negative
        least(depletion_level, 0) as depletion_level,
        low_stock as low_stock_flag,
        cast(estimated_delivery_date as date) as estimated_delivery_date,
        case when new_arrival = 'Y' then true else false end as new_arrival_flag,   
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, variant order by dw_insert_timestamp desc) as row_num
    from rugs_usa_variant
)


Select *
from base 
where row_num = 1
  );
[0m23:52:03.659236 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:52:03.671413 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:52:03.672193 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map" rename to "parent_variant_map__dbt_backup"
[0m23:52:03.673369 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:52:03.684411 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:52:03.685209 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map__dbt_tmp" rename to "parent_variant_map"
[0m23:52:03.686298 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:52:03.693465 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m23:52:03.694060 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:52:03.694651 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m23:52:03.695797 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:52:03.703743 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:52:03.704335 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
drop view if exists "postgres"."public_staging"."parent_variant_map__dbt_backup" cascade
[0m23:52:03.706408 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:52:03.710937 [debug] [Thread-1 (]: finished collecting timing info
[0m23:52:03.711569 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: Close
[0m23:52:03.713105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '374c936f-4cf8-49e0-964e-0aef00e59009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1082110>]}
[0m23:52:03.714351 [info ] [Thread-1 (]: 3 of 3 OK created view model public_staging.parent_variant_map ................. [[32mCREATE VIEW[0m in 0.21s]
[0m23:52:03.715709 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.parent_variant_map
[0m23:52:03.720735 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m23:52:03.721556 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:03.722070 [debug] [MainThread]: On master: BEGIN
[0m23:52:03.722558 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:52:03.759639 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m23:52:03.760686 [debug] [MainThread]: On master: COMMIT
[0m23:52:03.761551 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:03.762390 [debug] [MainThread]: On master: COMMIT
[0m23:52:03.763208 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:52:03.763799 [debug] [MainThread]: On master: Close
[0m23:52:03.765624 [info ] [MainThread]: 
[0m23:52:03.766568 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m23:52:03.767534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:52:03.768111 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_product' was properly closed.
[0m23:52:03.768601 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_variant_map' was properly closed.
[0m23:52:03.805503 [info ] [MainThread]: 
[0m23:52:03.806752 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:52:03.808285 [info ] [MainThread]: 
[0m23:52:03.809255 [error] [MainThread]: [33mDatabase Error in model link_product_map (models/staging/link_product_map.sql)[0m
[0m23:52:03.810330 [error] [MainThread]:   syntax error at or near "from"
[0m23:52:03.812031 [error] [MainThread]:   LINE 22:         from rugs_usa_links) links
[0m23:52:03.813623 [error] [MainThread]:                    ^
[0m23:52:03.814872 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/staging/link_product_map.sql
[0m23:52:03.816219 [info ] [MainThread]: 
[0m23:52:03.817354 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:52:03.819323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd20340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf2348af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf23487c0>]}


============================== 2024-07-21 23:52:51.685895 | 717f21ba-334f-4e46-8096-beabc09ce446 ==============================
[0m23:52:51.687129 [info ] [MainThread]: Running with dbt=1.2.0
[0m23:52:51.692259 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:52:51.693198 [debug] [MainThread]: Tracking: tracking
[0m23:52:51.739274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f26cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f25930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f27520>]}
[0m23:52:51.946615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:52:51.948984 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/link_product_map.sql
[0m23:52:52.037154 [debug] [MainThread]: 1699: static parser successfully parsed staging/link_product_map.sql
[0m23:52:52.249592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '717f21ba-334f-4e46-8096-beabc09ce446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10bf130>]}
[0m23:52:52.293254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '717f21ba-334f-4e46-8096-beabc09ce446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1081fc0>]}
[0m23:52:52.294536 [info ] [MainThread]: Found 4 models, 5 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:52:52.295547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '717f21ba-334f-4e46-8096-beabc09ce446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1083fa0>]}
[0m23:52:52.304088 [info ] [MainThread]: 
[0m23:52:52.307124 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m23:52:52.312831 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m23:52:52.373522 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:52:52.374825 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:52:52.375356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:52.447292 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.07 seconds
[0m23:52:52.454253 [debug] [ThreadPool]: On list_postgres: Close
[0m23:52:52.462655 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m23:52:52.464122 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m23:52:52.501298 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m23:52:52.517038 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m23:52:52.516592 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:52:52.517618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:52:52.518216 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m23:52:52.520904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:52.557755 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m23:52:52.558961 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m23:52:52.559457 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m23:52:52.560072 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:52:52.560677 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m23:52:52.561292 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:52:52.564894 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:52:52.565384 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m23:52:52.572385 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m23:52:52.577991 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m23:52:52.578960 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m23:52:52.579528 [debug] [ThreadPool]: On list_postgres_public: Close
[0m23:52:52.604285 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:52.605185 [debug] [MainThread]: On master: BEGIN
[0m23:52:52.605686 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:52:52.642207 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m23:52:52.643099 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:52.643630 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:52:52.647777 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:52:52.653232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '717f21ba-334f-4e46-8096-beabc09ce446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f2b910>]}
[0m23:52:52.654446 [debug] [MainThread]: On master: ROLLBACK
[0m23:52:52.655157 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:52.655702 [debug] [MainThread]: On master: BEGIN
[0m23:52:52.656557 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:52:52.657154 [debug] [MainThread]: On master: COMMIT
[0m23:52:52.657641 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:52.658097 [debug] [MainThread]: On master: COMMIT
[0m23:52:52.658705 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:52:52.659230 [debug] [MainThread]: On master: Close
[0m23:52:52.660515 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m23:52:52.661467 [info ] [MainThread]: 
[0m23:52:52.674883 [debug] [Thread-1 (]: Began running node model.jaffle_shop.link_product_map
[0m23:52:52.675625 [debug] [Thread-2 (]: Began running node model.jaffle_shop.parent_product
[0m23:52:52.676726 [info ] [Thread-1 (]: 1 of 3 START view model public_staging.link_product_map ........................ [RUN]
[0m23:52:52.677815 [info ] [Thread-2 (]: 2 of 3 START view model public_staging.parent_product .......................... [RUN]
[0m23:52:52.679531 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.link_product_map"
[0m23:52:52.681147 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.parent_product"
[0m23:52:52.681901 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.link_product_map
[0m23:52:52.682519 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.parent_product
[0m23:52:52.683178 [debug] [Thread-1 (]: Compiling model.jaffle_shop.link_product_map
[0m23:52:52.683807 [debug] [Thread-2 (]: Compiling model.jaffle_shop.parent_product
[0m23:52:52.692427 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.link_product_map"
[0m23:52:52.700132 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.parent_product"
[0m23:52:52.703017 [debug] [Thread-2 (]: finished collecting timing info
[0m23:52:52.703613 [debug] [Thread-1 (]: finished collecting timing info
[0m23:52:52.704672 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.link_product_map
[0m23:52:52.704064 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.parent_product
[0m23:52:53.094149 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.parent_product"
[0m23:52:53.095214 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.link_product_map"
[0m23:52:53.098481 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:52:53.098958 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m23:52:53.099969 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: BEGIN
[0m23:52:53.100490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:52:53.099427 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: BEGIN
[0m23:52:53.102204 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:52:53.140141 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m23:52:53.141095 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m23:52:53.141674 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */

  create view "postgres"."public_staging"."link_product_map__dbt_tmp" as (
    with base as (
    Select *, row_number() over (partition by card_links order by page_rank) as row_num
    from (
        Select
        md5(card_links) as link_product_map_uuid,
        split_part(split_part(card_links, '/', -1), '-', 1) as pid, --the last element of the card_links is the pid
        split_part(card_links, '/', -2) as color, --the penultimate element of the card_links is the color
        case when split_part(split_part(page_links, '/', -1), '?', 2) = '' then 1
            else cast(
                    split_part(
                        split_part(split_part(page_links, '/', -1), '?', 2),
                        '=',
                        2
                    ) as int) end as page_rank,    --the second element of the query string is the page rank
        request_timestamp::timestamptz as request_timestamp_utc, --assuming timestamp is in utc at the source
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        card_links, 
        page_links
        from rugs_usa_links) links
)

Select *
from base
where row_num = 1
  );
[0m23:52:53.142622 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m23:52:53.143391 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:52:53.143990 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */

  create view "postgres"."public_staging"."parent_product__dbt_tmp" as (
    with base as (
    Select
        md5(pid || split_part(url, '/', 5)) as parent_product_uuid,
        pid as parent_product_id,
        product_type_id as parent_product_type_id,
        name as parent_product_name,
        url as parent_product_url,
        split_part(url, '/', 5) as color_derived_url,
        thickness,
        material,
        weave_feature, 
        brand,
        category,
        availability,
        clearance,
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, split_part(url, '/', 5) order by dw_insert_timestamp desc) as row_num
    from rugs_usa_parent
)


Select *
from base 
where row_num = 1
  );
[0m23:52:53.145873 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "request_timestamp" does not exist
LINE 18:         request_timestamp::timestamptz as request_timestamp_...
                 ^
HINT:  Perhaps you meant to reference the column "rugs_usa_links.request_time_stamp".

[0m23:52:53.146784 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: ROLLBACK
[0m23:52:53.148175 [debug] [Thread-1 (]: finished collecting timing info
[0m23:52:53.149176 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: Close
[0m23:52:53.148612 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:52:53.150467 [debug] [Thread-1 (]: Database Error in model link_product_map (models/staging/link_product_map.sql)
  column "request_timestamp" does not exist
  LINE 18:         request_timestamp::timestamptz as request_timestamp_...
                   ^
  HINT:  Perhaps you meant to reference the column "rugs_usa_links.request_time_stamp".
  compiled SQL at target/run/jaffle_shop/models/staging/link_product_map.sql
[0m23:52:53.176173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '717f21ba-334f-4e46-8096-beabc09ce446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1082c20>]}
[0m23:52:53.184568 [error] [Thread-1 (]: 1 of 3 ERROR creating view model public_staging.link_product_map ............... [[31mERROR[0m in 0.50s]
[0m23:52:53.183132 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:52:53.187191 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product" rename to "parent_product__dbt_backup"
[0m23:52:53.186523 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.link_product_map
[0m23:52:53.188340 [debug] [Thread-1 (]: Began running node model.jaffle_shop.parent_variant_map
[0m23:52:53.190483 [info ] [Thread-1 (]: 3 of 3 START view model public_staging.parent_variant_map ...................... [RUN]
[0m23:52:53.189248 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:52:53.192406 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:52:53.203824 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.parent_variant_map
[0m23:52:53.204358 [debug] [Thread-1 (]: Compiling model.jaffle_shop.parent_variant_map
[0m23:52:53.203169 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:52:53.213089 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product__dbt_tmp" rename to "parent_product"
[0m23:52:53.212260 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.parent_variant_map"
[0m23:52:53.214194 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:52:53.247625 [debug] [Thread-1 (]: finished collecting timing info
[0m23:52:53.263844 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.parent_variant_map
[0m23:52:53.317126 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.parent_variant_map"
[0m23:52:53.360720 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m23:52:53.361405 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:52:53.362624 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: BEGIN
[0m23:52:53.363084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:52:53.362095 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:52:53.364924 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m23:52:53.367267 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:52:53.395416 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m23:52:53.399726 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
drop view if exists "postgres"."public_staging"."parent_product__dbt_backup" cascade
[0m23:52:53.402842 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:52:53.403970 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m23:52:53.408636 [debug] [Thread-2 (]: finished collecting timing info
[0m23:52:53.409914 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: Close
[0m23:52:53.409317 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:52:53.412101 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */

  create view "postgres"."public_staging"."parent_variant_map__dbt_tmp" as (
    with base as (
    Select
        md5(pid || variant) as parent_variant_map_uuid,
        pid as product_product_id,
        variant as variant_id,
        actual_size,
        weave_feature,
        weave_cat,
        size_grp,
        shipping_size,
        shape,
        cast(weight as float) as weight,
        cast(price as decimal(10,2)) as price,
        cast(msrp as decimal(10,2)) as msrp,    
        least(stock_level, 0) as stock_level,  --assuming stock level can't be negative
        least(depletion_level, 0) as depletion_level,
        low_stock as low_stock_flag,
        cast(estimated_delivery_date as date) as estimated_delivery_date,
        case when new_arrival = 'Y' then true else false end as new_arrival_flag,   
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, variant order by dw_insert_timestamp desc) as row_num
    from rugs_usa_variant
)


Select *
from base 
where row_num = 1
  );
[0m23:52:53.411492 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '717f21ba-334f-4e46-8096-beabc09ce446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10a6bc0>]}
[0m23:52:53.413763 [info ] [Thread-2 (]: 2 of 3 OK created view model public_staging.parent_product ..................... [[32mCREATE VIEW[0m in 0.73s]
[0m23:52:53.415533 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.parent_product
[0m23:52:53.416816 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:52:53.432884 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:52:53.433706 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map" rename to "parent_variant_map__dbt_backup"
[0m23:52:53.434958 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:52:53.445932 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:52:53.446739 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map__dbt_tmp" rename to "parent_variant_map"
[0m23:52:53.447843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:52:53.454816 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m23:52:53.455440 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:52:53.456194 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m23:52:53.457983 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:52:53.465995 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m23:52:53.466615 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
drop view if exists "postgres"."public_staging"."parent_variant_map__dbt_backup" cascade
[0m23:52:53.468434 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:52:53.472865 [debug] [Thread-1 (]: finished collecting timing info
[0m23:52:53.473481 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: Close
[0m23:52:53.474996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '717f21ba-334f-4e46-8096-beabc09ce446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1097940>]}
[0m23:52:53.476234 [info ] [Thread-1 (]: 3 of 3 OK created view model public_staging.parent_variant_map ................. [[32mCREATE VIEW[0m in 0.28s]
[0m23:52:53.477584 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.parent_variant_map
[0m23:52:53.483403 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m23:52:53.484407 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:53.484952 [debug] [MainThread]: On master: BEGIN
[0m23:52:53.485446 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:52:53.522177 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m23:52:53.523648 [debug] [MainThread]: On master: COMMIT
[0m23:52:53.524265 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:53.524801 [debug] [MainThread]: On master: COMMIT
[0m23:52:53.525588 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:52:53.526155 [debug] [MainThread]: On master: Close
[0m23:52:53.527967 [info ] [MainThread]: 
[0m23:52:53.528867 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m23:52:53.529845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:52:53.530462 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_product' was properly closed.
[0m23:52:53.530986 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_variant_map' was properly closed.
[0m23:52:53.566909 [info ] [MainThread]: 
[0m23:52:53.567921 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:52:53.568912 [info ] [MainThread]: 
[0m23:52:53.569865 [error] [MainThread]: [33mDatabase Error in model link_product_map (models/staging/link_product_map.sql)[0m
[0m23:52:53.570794 [error] [MainThread]:   column "request_timestamp" does not exist
[0m23:52:53.571628 [error] [MainThread]:   LINE 18:         request_timestamp::timestamptz as request_timestamp_...
[0m23:52:53.572502 [error] [MainThread]:                    ^
[0m23:52:53.573757 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "rugs_usa_links.request_time_stamp".
[0m23:52:53.575066 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/staging/link_product_map.sql
[0m23:52:53.576227 [info ] [MainThread]: 
[0m23:52:53.577151 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:52:53.578475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1096c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10979a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10bfb50>]}


============================== 2024-07-22 00:00:43.959052 | f9eec23b-357e-4c1c-903d-5fef2daeff44 ==============================
[0m00:00:43.959782 [info ] [MainThread]: Running with dbt=1.2.0
[0m00:00:43.965978 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:00:43.967674 [debug] [MainThread]: Tracking: tracking
[0m00:00:44.019888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f20bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f20370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f21840>]}
[0m00:00:44.228602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:00:44.230839 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/link_product_map.sql
[0m00:00:44.318892 [debug] [MainThread]: 1699: static parser successfully parsed staging/link_product_map.sql
[0m00:00:44.536642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9eec23b-357e-4c1c-903d-5fef2daeff44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10cf160>]}
[0m00:00:44.586934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9eec23b-357e-4c1c-903d-5fef2daeff44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1081f30>]}
[0m00:00:44.588309 [info ] [MainThread]: Found 4 models, 5 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:00:44.589681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9eec23b-357e-4c1c-903d-5fef2daeff44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1083f70>]}
[0m00:00:44.597500 [info ] [MainThread]: 
[0m00:00:44.599622 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:00:44.604803 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:00:44.666185 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:00:44.667170 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:00:44.667758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:44.739438 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.07 seconds
[0m00:00:44.746235 [debug] [ThreadPool]: On list_postgres: Close
[0m00:00:44.754111 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m00:00:44.756088 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:00:44.796405 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:00:44.811434 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m00:00:44.811004 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:00:44.812003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:44.812626 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:00:44.814590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:44.853113 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m00:00:44.853770 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m00:00:44.854487 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:00:44.855090 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:00:44.855688 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:00:44.856372 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m00:00:44.868383 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m00:00:44.869175 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:00:44.875386 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m00:00:44.881206 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:00:44.882249 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m00:00:44.882866 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:00:44.909163 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:44.910098 [debug] [MainThread]: On master: BEGIN
[0m00:00:44.910606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:00:44.947762 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m00:00:44.948621 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:44.949137 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:00:44.953818 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:00:44.959459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9eec23b-357e-4c1c-903d-5fef2daeff44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f28220>]}
[0m00:00:44.960524 [debug] [MainThread]: On master: ROLLBACK
[0m00:00:44.961224 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:44.961755 [debug] [MainThread]: On master: BEGIN
[0m00:00:44.962557 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:00:44.963178 [debug] [MainThread]: On master: COMMIT
[0m00:00:44.963653 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:44.964137 [debug] [MainThread]: On master: COMMIT
[0m00:00:44.964807 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:00:44.965339 [debug] [MainThread]: On master: Close
[0m00:00:44.966606 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m00:00:44.967571 [info ] [MainThread]: 
[0m00:00:44.987765 [debug] [Thread-1 (]: Began running node model.jaffle_shop.link_product_map
[0m00:00:44.988602 [debug] [Thread-2 (]: Began running node model.jaffle_shop.parent_product
[0m00:00:44.989892 [info ] [Thread-1 (]: 1 of 3 START view model public_staging.link_product_map ........................ [RUN]
[0m00:00:44.991159 [info ] [Thread-2 (]: 2 of 3 START view model public_staging.parent_product .......................... [RUN]
[0m00:00:44.993121 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.link_product_map"
[0m00:00:44.995069 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.parent_product"
[0m00:00:44.995792 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.link_product_map
[0m00:00:44.996413 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.parent_product
[0m00:00:44.997039 [debug] [Thread-1 (]: Compiling model.jaffle_shop.link_product_map
[0m00:00:44.997622 [debug] [Thread-2 (]: Compiling model.jaffle_shop.parent_product
[0m00:00:45.007446 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.link_product_map"
[0m00:00:45.017099 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.parent_product"
[0m00:00:45.021191 [debug] [Thread-1 (]: finished collecting timing info
[0m00:00:45.022080 [debug] [Thread-2 (]: finished collecting timing info
[0m00:00:45.023325 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.parent_product
[0m00:00:45.022621 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.link_product_map
[0m00:00:45.427428 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.parent_product"
[0m00:00:45.433776 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.link_product_map"
[0m00:00:45.436519 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m00:00:45.437535 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: BEGIN
[0m00:00:45.438014 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:00:45.437042 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m00:00:45.440794 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: BEGIN
[0m00:00:45.441421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:45.480038 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m00:00:45.481324 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m00:00:45.481892 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */

  create view "postgres"."public_staging"."parent_product__dbt_tmp" as (
    with base as (
    Select
        md5(pid || split_part(url, '/', 5)) as parent_product_uuid,
        pid as parent_product_id,
        product_type_id as parent_product_type_id,
        name as parent_product_name,
        url as parent_product_url,
        split_part(url, '/', 5) as color_derived_url,
        thickness,
        material,
        weave_feature, 
        brand,
        category,
        availability,
        clearance,
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, split_part(url, '/', 5) order by dw_insert_timestamp desc) as row_num
    from rugs_usa_parent
)


Select *
from base 
where row_num = 1
  );
[0m00:00:45.483318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m00:00:45.484088 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m00:00:45.484724 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */

  create view "postgres"."public_staging"."link_product_map__dbt_tmp" as (
    with base as (
    Select *, row_number() over (partition by card_links order by page_rank) as row_num
    from (
        Select
        md5(card_links) as link_product_map_uuid,
        split_part(split_part(card_links, '/', -1), '-', 1) as pid, --the last element of the card_links is the pid
        split_part(card_links, '/', -2) as color, --the penultimate element of the card_links is the color
        case when split_part(split_part(page_links, '/', -1), '?', 2) = '' then 1
            else cast(
                    split_part(
                        split_part(split_part(page_links, '/', -1), '?', 2),
                        '=',
                        2
                    ) as int) end as page_rank,    --the second element of the query string is the page rank
        request_time_stamp::timestamptz as request_timestamp_utc, --assuming timestamp is in utc at the source
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        card_links, 
        page_links
        from rugs_usa_links) links
)

Select *
from base
where row_num = 1
  );
[0m00:00:45.488177 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m00:00:45.498215 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m00:00:45.529771 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m00:00:45.541907 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product" rename to "parent_product__dbt_backup"
[0m00:00:45.541508 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m00:00:45.542873 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
alter table "postgres"."public_staging"."link_product_map__dbt_tmp" rename to "link_product_map"
[0m00:00:45.543339 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:00:45.552382 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m00:00:45.554633 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m00:00:45.583845 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product__dbt_tmp" rename to "parent_product"
[0m00:00:45.605862 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m00:00:45.692297 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: COMMIT
[0m00:00:45.702316 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m00:00:45.704252 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m00:00:45.704774 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m00:00:45.703661 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m00:00:45.723046 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: COMMIT
[0m00:00:45.723537 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:00:45.742165 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:00:45.785787 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m00:00:45.793615 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
drop view if exists "postgres"."public_staging"."parent_product__dbt_backup" cascade
[0m00:00:45.792923 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m00:00:45.794533 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
drop view if exists "postgres"."public_staging"."link_product_map__dbt_backup" cascade
[0m00:00:45.795550 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:00:45.800408 [debug] [Thread-1 (]: finished collecting timing info
[0m00:00:45.801469 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: Close
[0m00:00:45.800855 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.01 seconds
[0m00:00:45.803083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9eec23b-357e-4c1c-903d-5fef2daeff44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd37ee0>]}
[0m00:00:45.808924 [info ] [Thread-1 (]: 1 of 3 OK created view model public_staging.link_product_map ................... [[32mCREATE VIEW[0m in 0.81s]
[0m00:00:45.807448 [debug] [Thread-2 (]: finished collecting timing info
[0m00:00:45.811488 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: Close
[0m00:00:45.810695 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.link_product_map
[0m00:00:45.813934 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9eec23b-357e-4c1c-903d-5fef2daeff44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf239b100>]}
[0m00:00:45.817238 [info ] [Thread-2 (]: 2 of 3 OK created view model public_staging.parent_product ..................... [[32mCREATE VIEW[0m in 0.82s]
[0m00:00:45.815014 [debug] [Thread-1 (]: Began running node model.jaffle_shop.parent_variant_map
[0m00:00:45.818793 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.parent_product
[0m00:00:45.819749 [info ] [Thread-1 (]: 3 of 3 START view model public_staging.parent_variant_map ...................... [RUN]
[0m00:00:45.821966 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:00:45.822588 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.parent_variant_map
[0m00:00:45.823139 [debug] [Thread-1 (]: Compiling model.jaffle_shop.parent_variant_map
[0m00:00:45.830826 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.parent_variant_map"
[0m00:00:45.832408 [debug] [Thread-1 (]: finished collecting timing info
[0m00:00:45.833577 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.parent_variant_map
[0m00:00:45.851576 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.parent_variant_map"
[0m00:00:45.853387 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:00:45.853942 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: BEGIN
[0m00:00:45.854446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:45.893707 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m00:00:45.894846 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:00:45.895408 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */

  create view "postgres"."public_staging"."parent_variant_map__dbt_tmp" as (
    with base as (
    Select
        md5(pid || variant) as parent_variant_map_uuid,
        pid as product_product_id,
        variant as variant_id,
        actual_size,
        weave_feature,
        weave_cat,
        size_grp,
        shipping_size,
        shape,
        cast(weight as float) as weight,
        cast(price as decimal(10,2)) as price,
        cast(msrp as decimal(10,2)) as msrp,    
        least(stock_level, 0) as stock_level,  --assuming stock level can't be negative
        least(depletion_level, 0) as depletion_level,
        low_stock as low_stock_flag,
        cast(estimated_delivery_date as date) as estimated_delivery_date,
        case when new_arrival = 'Y' then true else false end as new_arrival_flag,   
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, variant order by dw_insert_timestamp desc) as row_num
    from rugs_usa_variant
)


Select *
from base 
where row_num = 1
  );
[0m00:00:45.898986 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:00:45.912823 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:00:45.913830 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map" rename to "parent_variant_map__dbt_backup"
[0m00:00:45.915338 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:00:45.927340 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:00:45.928257 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map__dbt_tmp" rename to "parent_variant_map"
[0m00:00:45.929456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:00:45.937136 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m00:00:45.937798 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:00:45.938296 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m00:00:45.939799 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:00:45.947947 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:00:45.948517 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
drop view if exists "postgres"."public_staging"."parent_variant_map__dbt_backup" cascade
[0m00:00:45.950687 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:00:45.955156 [debug] [Thread-1 (]: finished collecting timing info
[0m00:00:45.955770 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: Close
[0m00:00:45.957361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9eec23b-357e-4c1c-903d-5fef2daeff44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf2388ca0>]}
[0m00:00:45.958603 [info ] [Thread-1 (]: 3 of 3 OK created view model public_staging.parent_variant_map ................. [[32mCREATE VIEW[0m in 0.14s]
[0m00:00:45.960050 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.parent_variant_map
[0m00:00:45.965698 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:00:45.967146 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:45.967758 [debug] [MainThread]: On master: BEGIN
[0m00:00:45.968409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:00:46.005903 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m00:00:46.006863 [debug] [MainThread]: On master: COMMIT
[0m00:00:46.007442 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:46.007968 [debug] [MainThread]: On master: COMMIT
[0m00:00:46.008665 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:00:46.009273 [debug] [MainThread]: On master: Close
[0m00:00:46.011067 [info ] [MainThread]: 
[0m00:00:46.012060 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m00:00:46.013158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:46.013790 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_product' was properly closed.
[0m00:00:46.014417 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_variant_map' was properly closed.
[0m00:00:46.052997 [info ] [MainThread]: 
[0m00:00:46.053991 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:00:46.055190 [info ] [MainThread]: 
[0m00:00:46.056055 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:00:46.057439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd41390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1083a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf234d630>]}


============================== 2024-07-22 00:01:13.666777 | 69ec14a2-7feb-43ca-95ef-5ff62cf1b9f2 ==============================
[0m00:01:13.667571 [info ] [MainThread]: Running with dbt=1.2.0
[0m00:01:13.671758 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m00:01:13.672874 [debug] [MainThread]: Tracking: tracking
[0m00:01:13.706986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1e800>]}
[0m00:01:13.913710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:01:13.914731 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:01:13.953233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69ec14a2-7feb-43ca-95ef-5ff62cf1b9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10bd030>]}
[0m00:01:13.997936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69ec14a2-7feb-43ca-95ef-5ff62cf1b9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1003670>]}
[0m00:01:13.999297 [info ] [MainThread]: Found 4 models, 5 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:01:14.000319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69ec14a2-7feb-43ca-95ef-5ff62cf1b9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1003490>]}
[0m00:01:14.008569 [info ] [MainThread]: 
[0m00:01:14.010690 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:01:14.024535 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:01:14.027130 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m00:01:14.120143 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:01:14.132717 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:01:14.133205 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:01:14.133926 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m00:01:14.134473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:14.135105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:14.217305 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
[0m00:01:14.218051 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
[0m00:01:14.219132 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:01:14.219738 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:01:14.220365 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m00:01:14.220918 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:01:14.236107 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
[0m00:01:14.236915 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m00:01:14.244503 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m00:01:14.250037 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:01:14.251076 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m00:01:14.251698 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:01:14.278318 [debug] [MainThread]: Using postgres connection "master"
[0m00:01:14.279173 [debug] [MainThread]: On master: BEGIN
[0m00:01:14.279703 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:01:14.317544 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m00:01:14.318444 [debug] [MainThread]: Using postgres connection "master"
[0m00:01:14.318986 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:01:14.323660 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m00:01:14.329474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69ec14a2-7feb-43ca-95ef-5ff62cf1b9f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab12e5d20>]}
[0m00:01:14.330624 [debug] [MainThread]: On master: ROLLBACK
[0m00:01:14.331345 [debug] [MainThread]: Using postgres connection "master"
[0m00:01:14.331876 [debug] [MainThread]: On master: BEGIN
[0m00:01:14.332758 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:01:14.333375 [debug] [MainThread]: On master: COMMIT
[0m00:01:14.333902 [debug] [MainThread]: Using postgres connection "master"
[0m00:01:14.334391 [debug] [MainThread]: On master: COMMIT
[0m00:01:14.335042 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:01:14.335600 [debug] [MainThread]: On master: Close
[0m00:01:14.336937 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m00:01:14.337918 [info ] [MainThread]: 
[0m00:01:14.352063 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168
[0m00:01:14.352744 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6
[0m00:01:14.353678 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_rugs_usa_variant_new_arrival__Y__N ........... [RUN]
[0m00:01:14.354857 [info ] [Thread-2 (]: 2 of 5 START test not_null_rugs_usa_variant_new_arrival ........................ [RUN]
[0m00:01:14.357370 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168"
[0m00:01:14.359261 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6"
[0m00:01:14.360112 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168
[0m00:01:14.360805 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6
[0m00:01:14.361442 [debug] [Thread-1 (]: Compiling test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168
[0m00:01:14.362107 [debug] [Thread-2 (]: Compiling test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6
[0m00:01:14.485500 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168"
[0m00:01:14.497768 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6"
[0m00:01:14.503007 [debug] [Thread-1 (]: finished collecting timing info
[0m00:01:14.503627 [debug] [Thread-2 (]: finished collecting timing info
[0m00:01:14.504073 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168
[0m00:01:14.504695 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6
[0m00:01:14.650527 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168"
[0m00:01:14.662241 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6"
[0m00:01:14.664623 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168"
[0m00:01:14.665102 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6"
[0m00:01:14.666163 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6: BEGIN
[0m00:01:14.666633 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:01:14.665642 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168: BEGIN
[0m00:01:14.668727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:14.707135 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m00:01:14.708453 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6"
[0m00:01:14.709019 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_arrival
from "postgres"."public"."rugs_usa_variant"
where new_arrival is null



      
    ) dbt_internal_test
[0m00:01:14.707817 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m00:01:14.709926 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168"
[0m00:01:14.710489 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        new_arrival as value_field,
        count(*) as n_records

    from "postgres"."public"."rugs_usa_variant"
    group by new_arrival

)

select *
from all_values
where value_field not in (
    'Y','N'
)



      
    ) dbt_internal_test
[0m00:01:14.778814 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.07 seconds
[0m00:01:14.779455 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.07 seconds
[0m00:01:14.789816 [debug] [Thread-2 (]: finished collecting timing info
[0m00:01:14.795963 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6: ROLLBACK
[0m00:01:14.795297 [debug] [Thread-1 (]: finished collecting timing info
[0m00:01:14.797135 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168: ROLLBACK
[0m00:01:14.796739 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6: Close
[0m00:01:14.797804 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168: Close
[0m00:01:14.799241 [info ] [Thread-2 (]: 2 of 5 PASS not_null_rugs_usa_variant_new_arrival .............................. [[32mPASS[0m in 0.44s]
[0m00:01:14.801670 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_rugs_usa_variant_new_arrival__Y__N ................. [[32mPASS[0m in 0.45s]
[0m00:01:14.803197 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_rugs_usa_variant_new_arrival.07028914d6
[0m00:01:14.805341 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_rugs_usa_variant_new_arrival__Y__N.9c2b464168
[0m00:01:14.806606 [debug] [Thread-2 (]: Began running node test.jaffle_shop.unique_link_product_map_link_product_map_uuid.a9037cd499
[0m00:01:14.808342 [info ] [Thread-2 (]: 3 of 5 START test unique_link_product_map_link_product_map_uuid ................ [RUN]
[0m00:01:14.807598 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138
[0m00:01:14.810781 [info ] [Thread-1 (]: 4 of 5 START test unique_parent_product_parent_product_uuid .................... [RUN]
[0m00:01:14.810063 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.unique_link_product_map_link_product_map_uuid.a9037cd499"
[0m00:01:14.813016 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.unique_link_product_map_link_product_map_uuid.a9037cd499
[0m00:01:14.812354 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138"
[0m00:01:14.814166 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138
[0m00:01:14.814684 [debug] [Thread-1 (]: Compiling test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138
[0m00:01:14.813615 [debug] [Thread-2 (]: Compiling test.jaffle_shop.unique_link_product_map_link_product_map_uuid.a9037cd499
[0m00:01:14.861029 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138"
[0m00:01:14.867341 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.unique_link_product_map_link_product_map_uuid.a9037cd499"
[0m00:01:14.872020 [debug] [Thread-2 (]: finished collecting timing info
[0m00:01:14.873329 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.unique_link_product_map_link_product_map_uuid.a9037cd499
[0m00:01:14.872892 [debug] [Thread-1 (]: finished collecting timing info
[0m00:01:14.883053 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.unique_link_product_map_link_product_map_uuid.a9037cd499"
[0m00:01:14.883832 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138
[0m00:01:14.894338 [debug] [Thread-1 (]: Writing runtime SQL for node "test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138"
[0m00:01:14.895800 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.unique_link_product_map_link_product_map_uuid.a9037cd499"
[0m00:01:14.896460 [debug] [Thread-2 (]: On test.jaffle_shop.unique_link_product_map_link_product_map_uuid.a9037cd499: BEGIN
[0m00:01:14.897485 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:01:14.897165 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138"
[0m00:01:14.899585 [debug] [Thread-1 (]: On test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138: BEGIN
[0m00:01:14.900330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:14.936920 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m00:01:14.940661 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.unique_link_product_map_link_product_map_uuid.a9037cd499"
[0m00:01:14.941270 [debug] [Thread-2 (]: On test.jaffle_shop.unique_link_product_map_link_product_map_uuid.a9037cd499: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_link_product_map_link_product_map_uuid.a9037cd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    link_product_map_uuid as unique_field,
    count(*) as n_records

from "postgres"."public_staging"."link_product_map"
where link_product_map_uuid is not null
group by link_product_map_uuid
having count(*) > 1



      
    ) dbt_internal_test
[0m00:01:14.942129 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m00:01:14.942935 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138"
[0m00:01:14.943538 [debug] [Thread-1 (]: On test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    parent_product_uuid as unique_field,
    count(*) as n_records

from "postgres"."public_staging"."parent_product"
where parent_product_uuid is not null
group by parent_product_uuid
having count(*) > 1



      
    ) dbt_internal_test
[0m00:01:14.986480 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.04 seconds
[0m00:01:14.993559 [debug] [Thread-2 (]: finished collecting timing info
[0m00:01:14.994337 [debug] [Thread-2 (]: On test.jaffle_shop.unique_link_product_map_link_product_map_uuid.a9037cd499: ROLLBACK
[0m00:01:14.995029 [debug] [Thread-2 (]: On test.jaffle_shop.unique_link_product_map_link_product_map_uuid.a9037cd499: Close
[0m00:01:14.996350 [info ] [Thread-2 (]: 3 of 5 PASS unique_link_product_map_link_product_map_uuid ...................... [[32mPASS[0m in 0.19s]
[0m00:01:14.997803 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.unique_link_product_map_link_product_map_uuid.a9037cd499
[0m00:01:14.998712 [debug] [Thread-2 (]: Began running node test.jaffle_shop.unique_parent_variant_map_parent_variant_map_uuid.1df98188e7
[0m00:01:14.999533 [info ] [Thread-2 (]: 5 of 5 START test unique_parent_variant_map_parent_variant_map_uuid ............ [RUN]
[0m00:01:15.001193 [debug] [Thread-2 (]: Acquiring new postgres connection "test.jaffle_shop.unique_parent_variant_map_parent_variant_map_uuid.1df98188e7"
[0m00:01:15.001885 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.unique_parent_variant_map_parent_variant_map_uuid.1df98188e7
[0m00:01:15.002500 [debug] [Thread-2 (]: Compiling test.jaffle_shop.unique_parent_variant_map_parent_variant_map_uuid.1df98188e7
[0m00:01:15.003166 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.06 seconds
[0m00:01:15.022392 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.unique_parent_variant_map_parent_variant_map_uuid.1df98188e7"
[0m00:01:15.028193 [debug] [Thread-1 (]: finished collecting timing info
[0m00:01:15.029412 [debug] [Thread-1 (]: On test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138: ROLLBACK
[0m00:01:15.030347 [debug] [Thread-2 (]: finished collecting timing info
[0m00:01:15.030706 [debug] [Thread-1 (]: On test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138: Close
[0m00:01:15.031248 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.unique_parent_variant_map_parent_variant_map_uuid.1df98188e7
[0m00:01:15.032588 [info ] [Thread-1 (]: 4 of 5 PASS unique_parent_product_parent_product_uuid .......................... [[32mPASS[0m in 0.22s]
[0m00:01:15.043086 [debug] [Thread-2 (]: Writing runtime SQL for node "test.jaffle_shop.unique_parent_variant_map_parent_variant_map_uuid.1df98188e7"
[0m00:01:15.044877 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138
[0m00:01:15.046900 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.unique_parent_variant_map_parent_variant_map_uuid.1df98188e7"
[0m00:01:15.047493 [debug] [Thread-2 (]: On test.jaffle_shop.unique_parent_variant_map_parent_variant_map_uuid.1df98188e7: BEGIN
[0m00:01:15.047986 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:01:15.086112 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m00:01:15.087654 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.unique_parent_variant_map_parent_variant_map_uuid.1df98188e7"
[0m00:01:15.088330 [debug] [Thread-2 (]: On test.jaffle_shop.unique_parent_variant_map_parent_variant_map_uuid.1df98188e7: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_parent_variant_map_parent_variant_map_uuid.1df98188e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    parent_variant_map_uuid as unique_field,
    count(*) as n_records

from "postgres"."public_staging"."parent_variant_map"
where parent_variant_map_uuid is not null
group by parent_variant_map_uuid
having count(*) > 1



      
    ) dbt_internal_test
[0m00:01:15.279179 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.19 seconds
[0m00:01:15.285584 [debug] [Thread-2 (]: finished collecting timing info
[0m00:01:15.286244 [debug] [Thread-2 (]: On test.jaffle_shop.unique_parent_variant_map_parent_variant_map_uuid.1df98188e7: ROLLBACK
[0m00:01:15.286878 [debug] [Thread-2 (]: On test.jaffle_shop.unique_parent_variant_map_parent_variant_map_uuid.1df98188e7: Close
[0m00:01:15.288125 [info ] [Thread-2 (]: 5 of 5 PASS unique_parent_variant_map_parent_variant_map_uuid .................. [[32mPASS[0m in 0.29s]
[0m00:01:15.289642 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.unique_parent_variant_map_parent_variant_map_uuid.1df98188e7
[0m00:01:15.295254 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:01:15.296222 [debug] [MainThread]: Using postgres connection "master"
[0m00:01:15.296816 [debug] [MainThread]: On master: BEGIN
[0m00:01:15.297317 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:01:15.334585 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m00:01:15.335600 [debug] [MainThread]: On master: COMMIT
[0m00:01:15.336139 [debug] [MainThread]: Using postgres connection "master"
[0m00:01:15.336687 [debug] [MainThread]: On master: COMMIT
[0m00:01:15.337959 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:01:15.338787 [debug] [MainThread]: On master: Close
[0m00:01:15.340587 [info ] [MainThread]: 
[0m00:01:15.341636 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m00:01:15.342672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:15.343309 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_parent_product_parent_product_uuid.ac8af97138' was properly closed.
[0m00:01:15.343864 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_parent_variant_map_parent_variant_map_uuid.1df98188e7' was properly closed.
[0m00:01:15.384694 [info ] [MainThread]: 
[0m00:01:15.385768 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:01:15.387454 [info ] [MainThread]: 
[0m00:01:15.388810 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m00:01:15.390216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1399420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1399d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab139a590>]}


============================== 2024-07-22 00:23:22.274014 | bb847f26-0445-43ab-8acb-9450dd69dcb6 ==============================
[0m00:23:22.275192 [info ] [MainThread]: Running with dbt=1.2.0
[0m00:23:22.292687 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:23:22.310520 [debug] [MainThread]: Tracking: tracking
[0m00:23:22.346672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1b4c0>]}
[0m00:23:22.560319 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 1 files changed.
[0m00:23:22.562334 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/analysis/oval_vs_rectangle.sql
[0m00:23:22.563427 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/analysis/pagerank_and_sales.sql
[0m00:23:22.564072 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/staging/pad_product_map.sql
[0m00:23:22.565414 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/parent_variant_map.sql
[0m00:23:22.645873 [debug] [MainThread]: 1699: static parser successfully parsed analysis/oval_vs_rectangle.sql
[0m00:23:22.715297 [debug] [MainThread]: 1699: static parser successfully parsed analysis/pagerank_and_sales.sql
[0m00:23:22.727311 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_variant_map.sql
[0m00:23:22.897862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb847f26-0445-43ab-8acb-9450dd69dcb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10d4e80>]}
[0m00:23:22.943380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb847f26-0445-43ab-8acb-9450dd69dcb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0efd720>]}
[0m00:23:22.944684 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:23:22.945662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb847f26-0445-43ab-8acb-9450dd69dcb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1069240>]}
[0m00:23:22.958565 [info ] [MainThread]: 
[0m00:23:22.961151 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:23:22.967477 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:23:23.027355 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:23:23.028248 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:23:23.028785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:23.114789 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.09 seconds
[0m00:23:23.121781 [debug] [ThreadPool]: On list_postgres: Close
[0m00:23:23.129799 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m00:23:23.131747 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:23:23.176979 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:23:23.188449 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:23:23.189278 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m00:23:23.189973 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:23:23.191012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:23.191600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:23.232579 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m00:23:23.233244 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m00:23:23.234447 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:23:23.235094 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:23:23.235745 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m00:23:23.236486 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:23:23.244451 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
[0m00:23:23.245070 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:23:23.250866 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m00:23:23.256552 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:23:23.257598 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m00:23:23.258221 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:23:23.282498 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:23.283351 [debug] [MainThread]: On master: BEGIN
[0m00:23:23.283867 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:23:23.325429 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m00:23:23.326385 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:23.326898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:23:23.332569 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m00:23:23.338767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb847f26-0445-43ab-8acb-9450dd69dcb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f37130>]}
[0m00:23:23.339946 [debug] [MainThread]: On master: ROLLBACK
[0m00:23:23.340657 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:23.341145 [debug] [MainThread]: On master: BEGIN
[0m00:23:23.342035 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:23:23.342674 [debug] [MainThread]: On master: COMMIT
[0m00:23:23.343182 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:23.343692 [debug] [MainThread]: On master: COMMIT
[0m00:23:23.344404 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:23:23.344956 [debug] [MainThread]: On master: Close
[0m00:23:23.346234 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m00:23:23.347224 [info ] [MainThread]: 
[0m00:23:23.359113 [debug] [Thread-1 (]: Began running node model.jaffle_shop.link_product_map
[0m00:23:23.359736 [debug] [Thread-2 (]: Began running node model.jaffle_shop.parent_product
[0m00:23:23.373952 [info ] [Thread-1 (]: 1 of 3 START view model public_staging.link_product_map ........................ [RUN]
[0m00:23:23.375341 [info ] [Thread-2 (]: 2 of 3 START view model public_staging.parent_product .......................... [RUN]
[0m00:23:23.377144 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.link_product_map"
[0m00:23:23.378884 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.parent_product"
[0m00:23:23.379592 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.link_product_map
[0m00:23:23.380301 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.parent_product
[0m00:23:23.380961 [debug] [Thread-1 (]: Compiling model.jaffle_shop.link_product_map
[0m00:23:23.381629 [debug] [Thread-2 (]: Compiling model.jaffle_shop.parent_product
[0m00:23:23.390713 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.link_product_map"
[0m00:23:23.402316 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.parent_product"
[0m00:23:23.405390 [debug] [Thread-1 (]: finished collecting timing info
[0m00:23:23.406493 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.link_product_map
[0m00:23:23.406066 [debug] [Thread-2 (]: finished collecting timing info
[0m00:23:23.433628 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.parent_product
[0m00:23:23.786953 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.parent_product"
[0m00:23:23.788080 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.link_product_map"
[0m00:23:23.791454 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m00:23:23.791938 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m00:23:23.792951 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: BEGIN
[0m00:23:23.793431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:23.792442 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: BEGIN
[0m00:23:23.796223 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:23:23.833883 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m00:23:23.835250 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m00:23:23.835928 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */

  create view "postgres"."public_staging"."link_product_map__dbt_tmp" as (
    with base as (
    Select *, row_number() over (partition by card_links order by page_rank) as row_num
    from (
        Select
        md5(card_links) as link_product_map_uuid,
        split_part(split_part(card_links, '/', -1), '-', 1) as pid, --the last element of the card_links is the pid
        split_part(card_links, '/', -2) as color, --the penultimate element of the card_links is the color
        case when split_part(split_part(page_links, '/', -1), '?', 2) = '' then 1
            else cast(
                    split_part(
                        split_part(split_part(page_links, '/', -1), '?', 2),
                        '=',
                        2
                    ) as int) end as page_rank,    --the second element of the query string is the page rank
        request_time_stamp::timestamptz as request_timestamp_utc, --assuming timestamp is in utc at the source
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        card_links, 
        page_links
        from rugs_usa_links) links
)

Select *
from base
where row_num = 1
  );
[0m00:23:23.837516 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m00:23:23.838725 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m00:23:23.839395 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */

  create view "postgres"."public_staging"."parent_product__dbt_tmp" as (
    with base as (
    Select
        md5(pid || split_part(url, '/', 5)) as parent_product_uuid,
        pid as parent_product_id,
        product_type_id as parent_product_type_id,
        name as parent_product_name,
        url as parent_product_url,
        split_part(url, '/', 5) as color_derived_url,
        thickness,
        material,
        weave_feature, 
        brand,
        category,
        availability,
        clearance,
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, split_part(url, '/', 5) order by dw_insert_timestamp desc) as row_num
    from rugs_usa_parent
)


Select *
from base 
where row_num = 1
  );
[0m00:23:23.843120 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m00:23:23.844001 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:23:23.875488 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m00:23:23.888043 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
alter table "postgres"."public_staging"."link_product_map" rename to "link_product_map__dbt_backup"
[0m00:23:23.887184 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m00:23:23.889026 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product" rename to "parent_product__dbt_backup"
[0m00:23:23.889745 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:23:23.900961 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m00:23:23.902217 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
alter table "postgres"."public_staging"."link_product_map__dbt_tmp" rename to "link_product_map"
[0m00:23:23.901556 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m00:23:23.913121 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m00:23:23.913730 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m00:23:23.942750 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product__dbt_tmp" rename to "parent_product"
[0m00:23:23.965026 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m00:23:24.099369 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: COMMIT
[0m00:23:24.101759 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m00:23:24.102356 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: COMMIT
[0m00:23:24.100946 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m00:23:24.103252 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m00:23:24.103755 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m00:23:24.104797 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:23:24.105216 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:23:24.144621 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m00:23:24.150291 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
drop view if exists "postgres"."public_staging"."link_product_map__dbt_backup" cascade
[0m00:23:24.149588 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m00:23:24.151227 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
drop view if exists "postgres"."public_staging"."parent_product__dbt_backup" cascade
[0m00:23:24.153625 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:23:24.154050 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:23:24.159209 [debug] [Thread-1 (]: finished collecting timing info
[0m00:23:24.164028 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: Close
[0m00:23:24.163395 [debug] [Thread-2 (]: finished collecting timing info
[0m00:23:24.165807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb847f26-0445-43ab-8acb-9450dd69dcb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd1cac0>]}
[0m00:23:24.166475 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: Close
[0m00:23:24.167911 [info ] [Thread-1 (]: 1 of 3 OK created view model public_staging.link_product_map ................... [[32mCREATE VIEW[0m in 0.79s]
[0m00:23:24.169988 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb847f26-0445-43ab-8acb-9450dd69dcb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf2348310>]}
[0m00:23:24.171746 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.link_product_map
[0m00:23:24.173899 [debug] [Thread-1 (]: Began running node model.jaffle_shop.parent_variant_map
[0m00:23:24.174960 [info ] [Thread-1 (]: 3 of 3 START view model public_staging.parent_variant_map ...................... [RUN]
[0m00:23:24.173096 [info ] [Thread-2 (]: 2 of 3 OK created view model public_staging.parent_product ..................... [[32mCREATE VIEW[0m in 0.79s]
[0m00:23:24.176534 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:23:24.178026 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.parent_product
[0m00:23:24.178668 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.parent_variant_map
[0m00:23:24.179684 [debug] [Thread-1 (]: Compiling model.jaffle_shop.parent_variant_map
[0m00:23:24.188091 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.parent_variant_map"
[0m00:23:24.190937 [debug] [Thread-1 (]: finished collecting timing info
[0m00:23:24.191902 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.parent_variant_map
[0m00:23:24.215573 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.parent_variant_map"
[0m00:23:24.218814 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:23:24.219789 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: BEGIN
[0m00:23:24.220446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:24.261078 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m00:23:24.262074 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:23:24.262625 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */

  create view "postgres"."public_staging"."parent_variant_map__dbt_tmp" as (
    with base as (
    Select
        md5(pid || variant) as parent_variant_map_uuid,
        pid as product_product_id,
        variant as variant_id,
        actual_size,
        weave_feature,
        weave_cat,
        size_grp,
        shipping_size,
        shape,
        cast(weight as float) as weight,
        cast(price as decimal(10,2)) as price,
        cast(msrp as decimal(10,2)) as msrp,    
        case when status = 'In_stock' and not low_stock then False else True end as popular_variant_flag,
        low_stock as low_stock_flag,
        cast(estimated_delivery_date as date) as estimated_delivery_date,
        case when new_arrival = 'Y' then true else false end as new_arrival_flag,   
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, variant order by dw_insert_timestamp desc) as row_num
    from rugs_usa_variant
)


Select *
from base 
where row_num = 1
  );
[0m00:23:24.268501 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m00:23:24.281198 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:23:24.282121 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map" rename to "parent_variant_map__dbt_backup"
[0m00:23:24.283359 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:23:24.295210 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:23:24.296039 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map__dbt_tmp" rename to "parent_variant_map"
[0m00:23:24.297171 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:23:24.304927 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m00:23:24.305811 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:23:24.306387 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m00:23:24.308302 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:23:24.316984 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:23:24.317728 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
drop view if exists "postgres"."public_staging"."parent_variant_map__dbt_backup" cascade
[0m00:23:24.320798 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:23:24.325278 [debug] [Thread-1 (]: finished collecting timing info
[0m00:23:24.325922 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: Close
[0m00:23:24.327508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb847f26-0445-43ab-8acb-9450dd69dcb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf23494b0>]}
[0m00:23:24.328898 [info ] [Thread-1 (]: 3 of 3 OK created view model public_staging.parent_variant_map ................. [[32mCREATE VIEW[0m in 0.15s]
[0m00:23:24.330439 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.parent_variant_map
[0m00:23:24.337226 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:23:24.338213 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:24.338735 [debug] [MainThread]: On master: BEGIN
[0m00:23:24.339187 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:23:24.376521 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m00:23:24.377507 [debug] [MainThread]: On master: COMMIT
[0m00:23:24.378039 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:24.378516 [debug] [MainThread]: On master: COMMIT
[0m00:23:24.379233 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:23:24.379879 [debug] [MainThread]: On master: Close
[0m00:23:24.381810 [info ] [MainThread]: 
[0m00:23:24.382972 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m00:23:24.384249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:23:24.385536 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_product' was properly closed.
[0m00:23:24.386282 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_variant_map' was properly closed.
[0m00:23:24.424031 [info ] [MainThread]: 
[0m00:23:24.425008 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:23:24.426131 [info ] [MainThread]: 
[0m00:23:24.426987 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:23:24.428311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf23ae440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf23af5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd54130>]}


============================== 2024-07-22 00:25:14.833533 | cbd21b97-5762-43fb-a598-109090997b29 ==============================
[0m00:25:14.834168 [info ] [MainThread]: Running with dbt=1.2.0
[0m00:25:14.838119 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:25:14.839090 [debug] [MainThread]: Tracking: tracking
[0m00:25:14.877411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1b4c0>]}
[0m00:25:15.104720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:25:15.106952 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/parent_variant_map.sql
[0m00:25:15.190764 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_variant_map.sql
[0m00:25:15.413260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbd21b97-5762-43fb-a598-109090997b29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10a7160>]}
[0m00:25:15.457921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbd21b97-5762-43fb-a598-109090997b29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1083eb0>]}
[0m00:25:15.459204 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:25:15.460561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbd21b97-5762-43fb-a598-109090997b29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0efd720>]}
[0m00:25:15.469320 [info ] [MainThread]: 
[0m00:25:15.471356 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:25:15.476702 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m00:25:15.536624 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:25:15.537573 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:25:15.538153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:25:15.611709 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.07 seconds
[0m00:25:15.618316 [debug] [ThreadPool]: On list_postgres: Close
[0m00:25:15.626572 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m00:25:15.628183 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m00:25:15.671064 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:25:15.684302 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:25:15.684818 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:25:15.685446 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m00:25:15.686008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:25:15.686579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:25:15.726743 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m00:25:15.728173 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:25:15.728778 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m00:25:15.729436 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:25:15.730033 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:25:15.731448 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m00:25:15.736960 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m00:25:15.737505 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
[0m00:25:15.743686 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:25:15.749334 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m00:25:15.750496 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:25:15.751115 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m00:25:15.775915 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:15.776807 [debug] [MainThread]: On master: BEGIN
[0m00:25:15.777329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:25:15.813998 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m00:25:15.814962 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:15.815515 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:25:15.821129 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m00:25:15.827011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbd21b97-5762-43fb-a598-109090997b29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f1b4c0>]}
[0m00:25:15.828051 [debug] [MainThread]: On master: ROLLBACK
[0m00:25:15.828732 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:15.829244 [debug] [MainThread]: On master: BEGIN
[0m00:25:15.830092 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:25:15.830684 [debug] [MainThread]: On master: COMMIT
[0m00:25:15.831201 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:15.831749 [debug] [MainThread]: On master: COMMIT
[0m00:25:15.832410 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:25:15.832948 [debug] [MainThread]: On master: Close
[0m00:25:15.834158 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m00:25:15.835066 [info ] [MainThread]: 
[0m00:25:15.849550 [debug] [Thread-1 (]: Began running node model.jaffle_shop.link_product_map
[0m00:25:15.850509 [debug] [Thread-2 (]: Began running node model.jaffle_shop.parent_product
[0m00:25:15.851933 [info ] [Thread-1 (]: 1 of 3 START view model public_staging.link_product_map ........................ [RUN]
[0m00:25:15.853084 [info ] [Thread-2 (]: 2 of 3 START view model public_staging.parent_product .......................... [RUN]
[0m00:25:15.855023 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.link_product_map"
[0m00:25:15.856881 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.parent_product"
[0m00:25:15.857846 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.link_product_map
[0m00:25:15.858569 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.parent_product
[0m00:25:15.859247 [debug] [Thread-1 (]: Compiling model.jaffle_shop.link_product_map
[0m00:25:15.859888 [debug] [Thread-2 (]: Compiling model.jaffle_shop.parent_product
[0m00:25:15.868493 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.link_product_map"
[0m00:25:15.879186 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.parent_product"
[0m00:25:15.882191 [debug] [Thread-1 (]: finished collecting timing info
[0m00:25:15.883564 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.link_product_map
[0m00:25:15.884205 [debug] [Thread-2 (]: finished collecting timing info
[0m00:25:15.909057 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.parent_product
[0m00:25:16.288229 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.parent_product"
[0m00:25:16.289344 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.link_product_map"
[0m00:25:16.291776 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m00:25:16.292282 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m00:25:16.293286 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: BEGIN
[0m00:25:16.293727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:25:16.292808 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: BEGIN
[0m00:25:16.296396 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:25:16.336845 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m00:25:16.337834 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m00:25:16.338396 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */

  create view "postgres"."public_staging"."link_product_map__dbt_tmp" as (
    with base as (
    Select *, row_number() over (partition by card_links order by page_rank) as row_num
    from (
        Select
        md5(card_links) as link_product_map_uuid,
        split_part(split_part(card_links, '/', -1), '-', 1) as pid, --the last element of the card_links is the pid
        split_part(card_links, '/', -2) as color, --the penultimate element of the card_links is the color
        case when split_part(split_part(page_links, '/', -1), '?', 2) = '' then 1
            else cast(
                    split_part(
                        split_part(split_part(page_links, '/', -1), '?', 2),
                        '=',
                        2
                    ) as int) end as page_rank,    --the second element of the query string is the page rank
        request_time_stamp::timestamptz as request_timestamp_utc, --assuming timestamp is in utc at the source
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        card_links, 
        page_links
        from rugs_usa_links) links
)

Select *
from base
where row_num = 1
  );
[0m00:25:16.342255 [debug] [Thread-2 (]: SQL status: BEGIN in 0.05 seconds
[0m00:25:16.343198 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m00:25:16.343841 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */

  create view "postgres"."public_staging"."parent_product__dbt_tmp" as (
    with base as (
    Select
        md5(pid || split_part(url, '/', 5)) as parent_product_uuid,
        pid as parent_product_id,
        product_type_id as parent_product_type_id,
        name as parent_product_name,
        url as parent_product_url,
        split_part(url, '/', 5) as color_derived_url,
        thickness,
        material,
        weave_feature, 
        brand,
        category,
        availability,
        clearance,
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, split_part(url, '/', 5) order by dw_insert_timestamp desc) as row_num
    from rugs_usa_parent
)


Select *
from base 
where row_num = 1
  );
[0m00:25:16.349714 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m00:25:16.363786 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m00:25:16.393711 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m00:25:16.404964 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
alter table "postgres"."public_staging"."link_product_map" rename to "link_product_map__dbt_backup"
[0m00:25:16.404577 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m00:25:16.405889 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product" rename to "parent_product__dbt_backup"
[0m00:25:16.406354 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:25:16.417614 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m00:25:16.417388 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m00:25:16.429264 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
alter table "postgres"."public_staging"."link_product_map__dbt_tmp" rename to "link_product_map"
[0m00:25:16.428603 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m00:25:16.430441 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product__dbt_tmp" rename to "parent_product"
[0m00:25:16.430863 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:25:16.439099 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m00:25:16.646633 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m00:25:16.647876 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: COMMIT
[0m00:25:16.649187 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m00:25:16.649712 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: COMMIT
[0m00:25:16.648568 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m00:25:16.650643 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m00:25:16.651146 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:25:16.659960 [debug] [Thread-2 (]: SQL status: COMMIT in 0.01 seconds
[0m00:25:16.687646 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m00:25:16.693430 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m00:25:16.694700 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
drop view if exists "postgres"."public_staging"."parent_product__dbt_backup" cascade
[0m00:25:16.694125 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
drop view if exists "postgres"."public_staging"."link_product_map__dbt_backup" cascade
[0m00:25:16.697456 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:25:16.697918 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:25:16.702808 [debug] [Thread-2 (]: finished collecting timing info
[0m00:25:16.707691 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: Close
[0m00:25:16.707039 [debug] [Thread-1 (]: finished collecting timing info
[0m00:25:16.709920 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: Close
[0m00:25:16.709244 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbd21b97-5762-43fb-a598-109090997b29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10962f0>]}
[0m00:25:16.711311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbd21b97-5762-43fb-a598-109090997b29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf23dc5e0>]}
[0m00:25:16.714505 [info ] [Thread-1 (]: 1 of 3 OK created view model public_staging.link_product_map ................... [[32mCREATE VIEW[0m in 0.86s]
[0m00:25:16.712697 [info ] [Thread-2 (]: 2 of 3 OK created view model public_staging.parent_product ..................... [[32mCREATE VIEW[0m in 0.85s]
[0m00:25:16.716101 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.link_product_map
[0m00:25:16.718200 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.parent_product
[0m00:25:16.719352 [debug] [Thread-1 (]: Began running node model.jaffle_shop.parent_variant_map
[0m00:25:16.720952 [info ] [Thread-1 (]: 3 of 3 START view model public_staging.parent_variant_map ...................... [RUN]
[0m00:25:16.722623 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:25:16.723276 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.parent_variant_map
[0m00:25:16.723857 [debug] [Thread-1 (]: Compiling model.jaffle_shop.parent_variant_map
[0m00:25:16.731602 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.parent_variant_map"
[0m00:25:16.733281 [debug] [Thread-1 (]: finished collecting timing info
[0m00:25:16.734572 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.parent_variant_map
[0m00:25:16.753535 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.parent_variant_map"
[0m00:25:16.767715 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:25:16.768591 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: BEGIN
[0m00:25:16.769135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:25:16.808388 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m00:25:16.809431 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:25:16.809965 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */

  create view "postgres"."public_staging"."parent_variant_map__dbt_tmp" as (
    with base as (
    Select
        md5(pid || variant) as parent_variant_map_uuid,
        pid as parent_product_id,
        variant as variant_id,
        actual_size,
        weave_feature,
        weave_cat,
        size_grp,
        shipping_size,
        shape,
        cast(weight as float) as weight,
        cast(price as decimal(10,2)) as price,
        cast(msrp as decimal(10,2)) as msrp,    
        case when status = 'In_stock' and not low_stock then False else True end as popular_variant_flag,
        low_stock as low_stock_flag,
        cast(estimated_delivery_date as date) as estimated_delivery_date,
        case when new_arrival = 'Y' then true else false end as new_arrival_flag,   
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, variant order by dw_insert_timestamp desc) as row_num
    from rugs_usa_variant
)


Select *
from base 
where row_num = 1
  );
[0m00:25:16.812615 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:25:16.824279 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:25:16.825106 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map" rename to "parent_variant_map__dbt_backup"
[0m00:25:16.826588 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:25:16.837732 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:25:16.838436 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map__dbt_tmp" rename to "parent_variant_map"
[0m00:25:16.839474 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:25:16.846505 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m00:25:16.847163 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:25:16.847703 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m00:25:16.848978 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:25:16.857079 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m00:25:16.857640 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
drop view if exists "postgres"."public_staging"."parent_variant_map__dbt_backup" cascade
[0m00:25:16.859678 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:25:16.864132 [debug] [Thread-1 (]: finished collecting timing info
[0m00:25:16.864752 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: Close
[0m00:25:16.866205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbd21b97-5762-43fb-a598-109090997b29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10f4760>]}
[0m00:25:16.867453 [info ] [Thread-1 (]: 3 of 3 OK created view model public_staging.parent_variant_map ................. [[32mCREATE VIEW[0m in 0.14s]
[0m00:25:16.868849 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.parent_variant_map
[0m00:25:16.874442 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m00:25:16.875409 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:16.875997 [debug] [MainThread]: On master: BEGIN
[0m00:25:16.876533 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:25:16.913660 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m00:25:16.914607 [debug] [MainThread]: On master: COMMIT
[0m00:25:16.915124 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:16.915737 [debug] [MainThread]: On master: COMMIT
[0m00:25:16.916979 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:25:16.917714 [debug] [MainThread]: On master: Close
[0m00:25:16.919536 [info ] [MainThread]: 
[0m00:25:16.920485 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m00:25:16.921540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:25:16.922194 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_product' was properly closed.
[0m00:25:16.922699 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_variant_map' was properly closed.
[0m00:25:16.959705 [info ] [MainThread]: 
[0m00:25:16.960746 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:25:16.961938 [info ] [MainThread]: 
[0m00:25:16.962935 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:25:16.964257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1083a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10f4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd41630>]}


============================== 2024-07-22 01:00:09.189430 | 04a7fb42-ff1e-4664-b66e-3154900a29f0 ==============================
[0m01:00:09.190113 [info ] [MainThread]: Running with dbt=1.2.0
[0m01:00:09.194651 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:00:09.195313 [debug] [MainThread]: Tracking: tracking
[0m01:00:09.232695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f20bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f20370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f20d90>]}
[0m01:00:09.447978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:00:09.450304 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/parent_product.sql
[0m01:00:09.543851 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_product.sql
[0m01:00:09.764882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04a7fb42-ff1e-4664-b66e-3154900a29f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10aa080>]}
[0m01:00:09.813673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04a7fb42-ff1e-4664-b66e-3154900a29f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1087fd0>]}
[0m01:00:09.814971 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:00:09.816060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04a7fb42-ff1e-4664-b66e-3154900a29f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f01ae0>]}
[0m01:00:09.823704 [info ] [MainThread]: 
[0m01:00:09.825679 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m01:00:09.831039 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m01:00:09.889591 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:00:09.890459 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:00:09.890993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:09.970560 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.08 seconds
[0m01:00:09.977370 [debug] [ThreadPool]: On list_postgres: Close
[0m01:00:09.984944 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m01:00:09.986864 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m01:00:10.023553 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:00:10.039253 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m01:00:10.039682 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m01:00:10.040264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:10.040935 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m01:00:10.042836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:10.084013 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m01:00:10.084992 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:00:10.085569 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m01:00:10.086222 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:00:10.086827 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m01:00:10.087872 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m01:00:10.095135 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
[0m01:00:10.095700 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m01:00:10.101556 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m01:00:10.107019 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m01:00:10.108025 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m01:00:10.108611 [debug] [ThreadPool]: On list_postgres_public: Close
[0m01:00:10.134301 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:10.135218 [debug] [MainThread]: On master: BEGIN
[0m01:00:10.135738 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:10.172370 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m01:00:10.173198 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:10.173717 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:00:10.179280 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m01:00:10.185043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04a7fb42-ff1e-4664-b66e-3154900a29f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f23f10>]}
[0m01:00:10.186049 [debug] [MainThread]: On master: ROLLBACK
[0m01:00:10.186700 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:10.187225 [debug] [MainThread]: On master: BEGIN
[0m01:00:10.188077 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:00:10.188715 [debug] [MainThread]: On master: COMMIT
[0m01:00:10.189239 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:10.189709 [debug] [MainThread]: On master: COMMIT
[0m01:00:10.190350 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:00:10.190933 [debug] [MainThread]: On master: Close
[0m01:00:10.192164 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:00:10.193063 [info ] [MainThread]: 
[0m01:00:10.204417 [debug] [Thread-1 (]: Began running node model.jaffle_shop.link_product_map
[0m01:00:10.205048 [debug] [Thread-2 (]: Began running node model.jaffle_shop.parent_product
[0m01:00:10.206129 [info ] [Thread-1 (]: 1 of 3 START view model public_staging.link_product_map ........................ [RUN]
[0m01:00:10.207166 [info ] [Thread-2 (]: 2 of 3 START view model public_staging.parent_product .......................... [RUN]
[0m01:00:10.208927 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.link_product_map"
[0m01:00:10.210514 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.parent_product"
[0m01:00:10.211262 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.link_product_map
[0m01:00:10.211903 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.parent_product
[0m01:00:10.212522 [debug] [Thread-1 (]: Compiling model.jaffle_shop.link_product_map
[0m01:00:10.213141 [debug] [Thread-2 (]: Compiling model.jaffle_shop.parent_product
[0m01:00:10.220962 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.link_product_map"
[0m01:00:10.230610 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.parent_product"
[0m01:00:10.233872 [debug] [Thread-1 (]: finished collecting timing info
[0m01:00:10.234506 [debug] [Thread-2 (]: finished collecting timing info
[0m01:00:10.235543 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.parent_product
[0m01:00:10.234934 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.link_product_map
[0m01:00:10.621572 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.link_product_map"
[0m01:00:10.626228 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.parent_product"
[0m01:00:10.629900 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:00:10.630389 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:00:10.631399 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: BEGIN
[0m01:00:10.631937 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:10.630895 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: BEGIN
[0m01:00:10.634844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:10.671372 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m01:00:10.672272 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:00:10.672787 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */

  create view "postgres"."public_staging"."parent_product__dbt_tmp" as (
    --making a simple dimension table for parent product


Select distinct
pid as parent_product_id,
thickness,
material,
weave_feature,
brand
category
from rugs_usa_parent
  );
[0m01:00:10.675272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m01:00:10.676003 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:00:10.676546 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */

  create view "postgres"."public_staging"."link_product_map__dbt_tmp" as (
    with base as (
    Select *, row_number() over (partition by card_links order by page_rank) as row_num
    from (
        Select
        md5(card_links) as link_product_map_uuid,
        split_part(split_part(card_links, '/', -1), '-', 1) as pid, --the last element of the card_links is the pid
        split_part(card_links, '/', -2) as color, --the penultimate element of the card_links is the color
        case when split_part(split_part(page_links, '/', -1), '?', 2) = '' then 1
            else cast(
                    split_part(
                        split_part(split_part(page_links, '/', -1), '?', 2),
                        '=',
                        2
                    ) as int) end as page_rank,    --the second element of the query string is the page rank
        request_time_stamp::timestamptz as request_timestamp_utc, --assuming timestamp is in utc at the source
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        card_links, 
        page_links
        from rugs_usa_links) links
)

Select *
from base
where row_num = 1
  );
[0m01:00:10.678056 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:10.686715 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m01:00:10.720121 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:00:10.731670 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product" rename to "parent_product__dbt_backup"
[0m01:00:10.731215 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:00:10.732519 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
alter table "postgres"."public_staging"."link_product_map" rename to "link_product_map__dbt_backup"
[0m01:00:10.734337 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:10.734713 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:10.745200 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:00:10.755921 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product__dbt_tmp" rename to "parent_product"
[0m01:00:10.755345 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:00:10.756797 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
alter table "postgres"."public_staging"."link_product_map__dbt_tmp" rename to "link_product_map"
[0m01:00:10.757185 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:10.766535 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m01:00:10.942353 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: COMMIT
[0m01:00:10.947512 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:00:10.948091 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: COMMIT
[0m01:00:10.946672 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m01:00:10.949129 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:00:10.950269 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m01:00:10.949692 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:00:10.959859 [debug] [Thread-2 (]: SQL status: COMMIT in 0.01 seconds
[0m01:00:10.982811 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:00:10.983324 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:00:10.984464 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
drop view if exists "postgres"."public_staging"."link_product_map__dbt_backup" cascade
[0m01:00:10.983938 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
drop view if exists "postgres"."public_staging"."parent_product__dbt_backup" cascade
[0m01:00:10.987888 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:10.988328 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:10.993060 [debug] [Thread-1 (]: finished collecting timing info
[0m01:00:10.998222 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: Close
[0m01:00:10.997522 [debug] [Thread-2 (]: finished collecting timing info
[0m01:00:11.000779 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: Close
[0m01:00:11.000022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04a7fb42-ff1e-4664-b66e-3154900a29f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd148b0>]}
[0m01:00:11.002208 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04a7fb42-ff1e-4664-b66e-3154900a29f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f22530>]}
[0m01:00:11.005081 [info ] [Thread-2 (]: 2 of 3 OK created view model public_staging.parent_product ..................... [[32mCREATE VIEW[0m in 0.79s]
[0m01:00:11.003591 [info ] [Thread-1 (]: 1 of 3 OK created view model public_staging.link_product_map ................... [[32mCREATE VIEW[0m in 0.79s]
[0m01:00:11.006573 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.parent_product
[0m01:00:11.007933 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.link_product_map
[0m01:00:11.008752 [debug] [Thread-2 (]: Began running node model.jaffle_shop.parent_variant_map
[0m01:00:11.010105 [info ] [Thread-2 (]: 3 of 3 START view model public_staging.parent_variant_map ...................... [RUN]
[0m01:00:11.011726 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:00:11.012362 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.parent_variant_map
[0m01:00:11.012964 [debug] [Thread-2 (]: Compiling model.jaffle_shop.parent_variant_map
[0m01:00:11.020583 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.parent_variant_map"
[0m01:00:11.022022 [debug] [Thread-2 (]: finished collecting timing info
[0m01:00:11.022576 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.parent_variant_map
[0m01:00:11.039562 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.parent_variant_map"
[0m01:00:11.041083 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:00:11.041640 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: BEGIN
[0m01:00:11.042147 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:00:11.079336 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m01:00:11.080237 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:00:11.080760 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */

  create view "postgres"."public_staging"."parent_variant_map__dbt_tmp" as (
    with base as (
    Select
        md5(pid || variant) as parent_variant_map_uuid,
        pid as parent_product_id,
        variant as variant_id,
        actual_size,
        weave_feature,
        weave_cat,
        size_grp,
        shipping_size,
        shape,
        cast(weight as float) as weight,
        cast(price as decimal(10,2)) as price,
        cast(msrp as decimal(10,2)) as msrp,    
        case when status = 'In_stock' and not low_stock then False else True end as popular_variant_flag,
        low_stock as low_stock_flag,
        cast(estimated_delivery_date as date) as estimated_delivery_date,
        case when new_arrival = 'Y' then true else false end as new_arrival_flag,   
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, variant order by dw_insert_timestamp desc) as row_num
    from rugs_usa_variant
)


Select *
from base 
where row_num = 1
  );
[0m01:00:11.084368 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:11.095897 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:00:11.096540 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map" rename to "parent_variant_map__dbt_backup"
[0m01:00:11.097842 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:11.107960 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:00:11.108535 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map__dbt_tmp" rename to "parent_variant_map"
[0m01:00:11.109506 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:11.116485 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m01:00:11.117155 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:00:11.117751 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m01:00:11.120707 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m01:00:11.129293 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:00:11.130163 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
drop view if exists "postgres"."public_staging"."parent_variant_map__dbt_backup" cascade
[0m01:00:11.132783 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:11.138205 [debug] [Thread-2 (]: finished collecting timing info
[0m01:00:11.139147 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: Close
[0m01:00:11.141071 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04a7fb42-ff1e-4664-b66e-3154900a29f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab108c790>]}
[0m01:00:11.142681 [info ] [Thread-2 (]: 3 of 3 OK created view model public_staging.parent_variant_map ................. [[32mCREATE VIEW[0m in 0.13s]
[0m01:00:11.144693 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.parent_variant_map
[0m01:00:11.151035 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m01:00:11.152141 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:11.152728 [debug] [MainThread]: On master: BEGIN
[0m01:00:11.153279 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:00:11.191485 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m01:00:11.192495 [debug] [MainThread]: On master: COMMIT
[0m01:00:11.193040 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:11.193560 [debug] [MainThread]: On master: COMMIT
[0m01:00:11.194238 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:00:11.194853 [debug] [MainThread]: On master: Close
[0m01:00:11.196672 [info ] [MainThread]: 
[0m01:00:11.197562 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m01:00:11.198802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:11.199443 [debug] [MainThread]: Connection 'model.jaffle_shop.link_product_map' was properly closed.
[0m01:00:11.199986 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_variant_map' was properly closed.
[0m01:00:11.235913 [info ] [MainThread]: 
[0m01:00:11.236870 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:00:11.237986 [info ] [MainThread]: 
[0m01:00:11.238821 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:00:11.240030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1087be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1087bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf2341a20>]}


============================== 2024-07-22 01:18:39.131774 | 1048836e-d360-4655-a8f0-840d53f5c3ed ==============================
[0m01:18:39.132984 [info ] [MainThread]: Running with dbt=1.2.0
[0m01:18:39.137641 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:18:39.138652 [debug] [MainThread]: Tracking: tracking
[0m01:18:39.165069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f236a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f23ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f234c0>]}
[0m01:18:39.374964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:18:39.377302 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/parent_product.sql
[0m01:18:39.461608 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_product.sql
[0m01:18:39.678773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1048836e-d360-4655-a8f0-840d53f5c3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10ab100>]}
[0m01:18:39.722708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1048836e-d360-4655-a8f0-840d53f5c3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1087eb0>]}
[0m01:18:39.723928 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:18:39.724968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1048836e-d360-4655-a8f0-840d53f5c3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1075390>]}
[0m01:18:39.736429 [info ] [MainThread]: 
[0m01:18:39.738612 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m01:18:39.743692 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m01:18:39.797042 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:18:39.797907 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:18:39.798416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:39.868239 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.07 seconds
[0m01:18:39.876787 [debug] [ThreadPool]: On list_postgres: Close
[0m01:18:39.884968 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m01:18:39.886442 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m01:18:39.927435 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:18:39.941581 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m01:18:39.942203 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m01:18:39.942980 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m01:18:39.943602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:39.944261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:39.986631 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m01:18:39.987459 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m01:18:39.988321 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m01:18:39.988958 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:18:39.989530 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m01:18:39.990156 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:18:39.994049 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m01:18:39.994605 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m01:18:40.000841 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m01:18:40.007871 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m01:18:40.009351 [debug] [ThreadPool]: On list_postgres_public: Close
[0m01:18:40.010052 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m01:18:40.035373 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:40.036262 [debug] [MainThread]: On master: BEGIN
[0m01:18:40.036826 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:18:40.074201 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m01:18:40.075330 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:40.075872 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:18:40.079999 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m01:18:40.085767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1048836e-d360-4655-a8f0-840d53f5c3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f699f0>]}
[0m01:18:40.086817 [debug] [MainThread]: On master: ROLLBACK
[0m01:18:40.087520 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:40.088028 [debug] [MainThread]: On master: BEGIN
[0m01:18:40.088924 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:18:40.089870 [debug] [MainThread]: On master: COMMIT
[0m01:18:40.090970 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:40.091698 [debug] [MainThread]: On master: COMMIT
[0m01:18:40.092562 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:18:40.093183 [debug] [MainThread]: On master: Close
[0m01:18:40.094582 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:18:40.095460 [info ] [MainThread]: 
[0m01:18:40.106664 [debug] [Thread-1 (]: Began running node model.jaffle_shop.link_product_map
[0m01:18:40.107279 [debug] [Thread-2 (]: Began running node model.jaffle_shop.parent_product
[0m01:18:40.108388 [info ] [Thread-1 (]: 1 of 3 START view model public_staging.link_product_map ........................ [RUN]
[0m01:18:40.109469 [info ] [Thread-2 (]: 2 of 3 START view model public_staging.parent_product .......................... [RUN]
[0m01:18:40.111162 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.link_product_map"
[0m01:18:40.112889 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.parent_product"
[0m01:18:40.113593 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.link_product_map
[0m01:18:40.114296 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.parent_product
[0m01:18:40.114922 [debug] [Thread-1 (]: Compiling model.jaffle_shop.link_product_map
[0m01:18:40.115538 [debug] [Thread-2 (]: Compiling model.jaffle_shop.parent_product
[0m01:18:40.123453 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.link_product_map"
[0m01:18:40.133277 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.parent_product"
[0m01:18:40.135735 [debug] [Thread-1 (]: finished collecting timing info
[0m01:18:40.136317 [debug] [Thread-2 (]: finished collecting timing info
[0m01:18:40.136743 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.link_product_map
[0m01:18:40.137340 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.parent_product
[0m01:18:40.541885 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.link_product_map"
[0m01:18:40.542455 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.parent_product"
[0m01:18:40.545899 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:18:40.546394 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:18:40.547477 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: BEGIN
[0m01:18:40.547974 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:18:40.546931 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: BEGIN
[0m01:18:40.549707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:40.589101 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m01:18:40.589878 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m01:18:40.591160 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:18:40.591654 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */

  create view "postgres"."public_staging"."parent_product__dbt_tmp" as (
    --making a simple dimension table for parent product

Select distinct
pid as parent_product_id,
thickness,
material,
weave_feature,
brand
category
from rugs_usa_parent
  );
[0m01:18:40.590601 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:18:40.592427 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */

  create view "postgres"."public_staging"."link_product_map__dbt_tmp" as (
    with base as (
    Select *, row_number() over (partition by card_links order by page_rank) as row_num
    from (
        Select
        md5(card_links) as link_product_map_uuid,
        split_part(split_part(card_links, '/', -1), '-', 1) as pid, --the last element of the card_links is the pid
        split_part(card_links, '/', -2) as color, --the penultimate element of the card_links is the color
        case when split_part(split_part(page_links, '/', -1), '?', 2) = '' then 1
            else cast(
                    split_part(
                        split_part(split_part(page_links, '/', -1), '?', 2),
                        '=',
                        2
                    ) as int) end as page_rank,    --the second element of the query string is the page rank
        request_time_stamp::timestamptz as request_timestamp_utc, --assuming timestamp is in utc at the source
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        card_links, 
        page_links
        from rugs_usa_links) links
)

Select *
from base
where row_num = 1
  );
[0m01:18:40.595562 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:18:40.603401 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m01:18:40.637522 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:18:40.650369 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product" rename to "parent_product__dbt_backup"
[0m01:18:40.649983 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:18:40.651338 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
alter table "postgres"."public_staging"."link_product_map" rename to "link_product_map__dbt_backup"
[0m01:18:40.651809 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:18:40.662599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m01:18:40.663360 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:18:40.674542 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product__dbt_tmp" rename to "parent_product"
[0m01:18:40.673965 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:18:40.675411 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
alter table "postgres"."public_staging"."link_product_map__dbt_tmp" rename to "link_product_map"
[0m01:18:40.675825 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:18:40.686564 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m01:18:40.872396 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: COMMIT
[0m01:18:40.867764 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m01:18:40.874024 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:18:40.874518 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m01:18:40.873416 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:18:40.875518 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: COMMIT
[0m01:18:40.879364 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m01:18:40.879861 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:18:40.919230 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:18:40.924640 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
drop view if exists "postgres"."public_staging"."parent_product__dbt_backup" cascade
[0m01:18:40.923949 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:18:40.925576 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
drop view if exists "postgres"."public_staging"."link_product_map__dbt_backup" cascade
[0m01:18:40.927887 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:18:40.928280 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:18:40.933334 [debug] [Thread-2 (]: finished collecting timing info
[0m01:18:40.938133 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: Close
[0m01:18:40.937506 [debug] [Thread-1 (]: finished collecting timing info
[0m01:18:40.940856 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: Close
[0m01:18:40.940203 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1048836e-d360-4655-a8f0-840d53f5c3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd2c160>]}
[0m01:18:40.942270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1048836e-d360-4655-a8f0-840d53f5c3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf237fb80>]}
[0m01:18:40.945211 [info ] [Thread-1 (]: 1 of 3 OK created view model public_staging.link_product_map ................... [[32mCREATE VIEW[0m in 0.83s]
[0m01:18:40.943761 [info ] [Thread-2 (]: 2 of 3 OK created view model public_staging.parent_product ..................... [[32mCREATE VIEW[0m in 0.83s]
[0m01:18:40.946699 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.link_product_map
[0m01:18:40.948957 [debug] [Thread-1 (]: Began running node model.jaffle_shop.parent_variant_map
[0m01:18:40.950069 [info ] [Thread-1 (]: 3 of 3 START view model public_staging.parent_variant_map ...................... [RUN]
[0m01:18:40.948170 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.parent_product
[0m01:18:40.951676 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:18:40.952720 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.parent_variant_map
[0m01:18:40.953282 [debug] [Thread-1 (]: Compiling model.jaffle_shop.parent_variant_map
[0m01:18:40.961022 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.parent_variant_map"
[0m01:18:40.962464 [debug] [Thread-1 (]: finished collecting timing info
[0m01:18:40.963060 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.parent_variant_map
[0m01:18:40.980431 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.parent_variant_map"
[0m01:18:40.982135 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:18:40.982707 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: BEGIN
[0m01:18:40.983207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:41.020024 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m01:18:41.020902 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:18:41.021484 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */

  create view "postgres"."public_staging"."parent_variant_map__dbt_tmp" as (
    with base as (
    Select
        md5(pid || variant) as parent_variant_map_uuid,
        pid as parent_product_id,
        variant as variant_id,
        actual_size,
        weave_feature,
        weave_cat,
        size_grp,
        shipping_size,
        shape,
        cast(weight as float) as weight,
        cast(price as decimal(10,2)) as price,
        cast(msrp as decimal(10,2)) as msrp,    
        case when status = 'In_stock' and not low_stock then False else True end as popular_variant_flag,
        low_stock as low_stock_flag,
        cast(estimated_delivery_date as date) as estimated_delivery_date,
        case when new_arrival = 'Y' then true else false end as new_arrival_flag,   
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, variant order by dw_insert_timestamp desc) as row_num
    from rugs_usa_variant
)


Select *
from base 
where row_num = 1
  );
[0m01:18:41.025161 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:18:41.036644 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:18:41.037259 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map" rename to "parent_variant_map__dbt_backup"
[0m01:18:41.038248 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:18:41.048545 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:18:41.049143 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map__dbt_tmp" rename to "parent_variant_map"
[0m01:18:41.050112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:18:41.057012 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m01:18:41.057621 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:18:41.058158 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m01:18:41.059830 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:18:41.067706 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:18:41.068264 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
drop view if exists "postgres"."public_staging"."parent_variant_map__dbt_backup" cascade
[0m01:18:41.069860 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:18:41.074115 [debug] [Thread-1 (]: finished collecting timing info
[0m01:18:41.074739 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: Close
[0m01:18:41.076162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1048836e-d360-4655-a8f0-840d53f5c3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf233c730>]}
[0m01:18:41.077379 [info ] [Thread-1 (]: 3 of 3 OK created view model public_staging.parent_variant_map ................. [[32mCREATE VIEW[0m in 0.12s]
[0m01:18:41.078846 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.parent_variant_map
[0m01:18:41.084088 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m01:18:41.084880 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:41.085390 [debug] [MainThread]: On master: BEGIN
[0m01:18:41.085884 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:18:41.122280 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m01:18:41.123137 [debug] [MainThread]: On master: COMMIT
[0m01:18:41.123677 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:41.124205 [debug] [MainThread]: On master: COMMIT
[0m01:18:41.124861 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:18:41.125438 [debug] [MainThread]: On master: Close
[0m01:18:41.127301 [info ] [MainThread]: 
[0m01:18:41.128225 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m01:18:41.129254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:41.129884 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_product' was properly closed.
[0m01:18:41.130383 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_variant_map' was properly closed.
[0m01:18:41.165640 [info ] [MainThread]: 
[0m01:18:41.166570 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:18:41.167724 [info ] [MainThread]: 
[0m01:18:41.168589 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:18:41.169882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1087a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf233d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf233dae0>]}


============================== 2024-07-22 01:20:18.483461 | c288ca1d-cb88-4ea4-bafe-d0af55370c83 ==============================
[0m01:20:18.484007 [info ] [MainThread]: Running with dbt=1.2.0
[0m01:20:18.487955 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:20:18.489084 [debug] [MainThread]: Tracking: tracking
[0m01:20:18.520983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f33460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f33ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f32800>]}
[0m01:20:18.737275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:20:18.739497 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/link_product_map.sql
[0m01:20:18.822516 [debug] [MainThread]: 1699: static parser successfully parsed staging/link_product_map.sql
[0m01:20:19.038189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c288ca1d-cb88-4ea4-bafe-d0af55370c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10ab070>]}
[0m01:20:19.083967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c288ca1d-cb88-4ea4-bafe-d0af55370c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1087fd0>]}
[0m01:20:19.085718 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:20:19.088532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c288ca1d-cb88-4ea4-bafe-d0af55370c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1087fa0>]}
[0m01:20:19.096188 [info ] [MainThread]: 
[0m01:20:19.098339 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m01:20:19.104097 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m01:20:19.167038 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:20:19.168301 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:20:19.168823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:19.238834 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.07 seconds
[0m01:20:19.245866 [debug] [ThreadPool]: On list_postgres: Close
[0m01:20:19.257642 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m01:20:19.259366 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m01:20:19.307978 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:20:19.316998 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m01:20:19.317433 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m01:20:19.318125 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m01:20:19.318732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:19.319345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:19.358974 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m01:20:19.359622 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m01:20:19.360365 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:20:19.360975 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m01:20:19.361576 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:20:19.362209 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m01:20:19.366007 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m01:20:19.366770 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m01:20:19.372894 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m01:20:19.377991 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m01:20:19.378975 [debug] [ThreadPool]: On list_postgres_public: Close
[0m01:20:19.379466 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m01:20:19.404592 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:19.405668 [debug] [MainThread]: On master: BEGIN
[0m01:20:19.406176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:20:19.444035 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m01:20:19.444984 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:19.445493 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:20:19.451118 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m01:20:19.456965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c288ca1d-cb88-4ea4-bafe-d0af55370c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f33460>]}
[0m01:20:19.458133 [debug] [MainThread]: On master: ROLLBACK
[0m01:20:19.458854 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:19.459423 [debug] [MainThread]: On master: BEGIN
[0m01:20:19.460334 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:20:19.460895 [debug] [MainThread]: On master: COMMIT
[0m01:20:19.461393 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:19.461879 [debug] [MainThread]: On master: COMMIT
[0m01:20:19.462566 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:20:19.463162 [debug] [MainThread]: On master: Close
[0m01:20:19.464469 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:20:19.465420 [info ] [MainThread]: 
[0m01:20:19.478898 [debug] [Thread-1 (]: Began running node model.jaffle_shop.link_product_map
[0m01:20:19.479545 [debug] [Thread-2 (]: Began running node model.jaffle_shop.parent_product
[0m01:20:19.480616 [info ] [Thread-1 (]: 1 of 3 START view model public_staging.link_product_map ........................ [RUN]
[0m01:20:19.481610 [info ] [Thread-2 (]: 2 of 3 START view model public_staging.parent_product .......................... [RUN]
[0m01:20:19.483314 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.link_product_map"
[0m01:20:19.486055 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.parent_product"
[0m01:20:19.487026 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.link_product_map
[0m01:20:19.487679 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.parent_product
[0m01:20:19.488351 [debug] [Thread-1 (]: Compiling model.jaffle_shop.link_product_map
[0m01:20:19.488911 [debug] [Thread-2 (]: Compiling model.jaffle_shop.parent_product
[0m01:20:19.496953 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.link_product_map"
[0m01:20:19.508229 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.parent_product"
[0m01:20:19.511762 [debug] [Thread-2 (]: finished collecting timing info
[0m01:20:19.512504 [debug] [Thread-1 (]: finished collecting timing info
[0m01:20:19.512978 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.parent_product
[0m01:20:19.513586 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.link_product_map
[0m01:20:19.914062 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.parent_product"
[0m01:20:19.914667 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.link_product_map"
[0m01:20:19.917054 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:20:19.917572 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:20:19.918566 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: BEGIN
[0m01:20:19.919104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:19.918060 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: BEGIN
[0m01:20:19.922405 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:20:19.959298 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m01:20:19.960422 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:20:19.961052 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */

  create view "postgres"."public_staging"."link_product_map__dbt_tmp" as (
    with base as (
    Select *, row_number() over (partition by card_links order by page_rank) as row_num
    from (
        Select
        md5(card_links) as link_product_map_uuid,
        split_part(split_part(card_links, '/', -1), '-', 1) as parent_product_id, --the last element of the card_links is the pid
        split_part(card_links, '/', -2) as color, --the penultimate element of the card_links is the color
        case when split_part(split_part(page_links, '/', -1), '?', 2) = '' then 1
            else cast(
                    split_part(
                        split_part(split_part(page_links, '/', -1), '?', 2),
                        '=',
                        2
                    ) as int) end as page_rank,    --the second element of the query string is the page rank
        request_time_stamp::timestamptz as request_timestamp_utc, --assuming timestamp is in utc at the source
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        card_links, 
        page_links
        from rugs_usa_links) links
)

Select *
from base
where row_num = 1
  );
[0m01:20:19.961903 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m01:20:19.962628 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:20:19.963211 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */

  create view "postgres"."public_staging"."parent_product__dbt_tmp" as (
    --making a simple dimension table for parent product

Select distinct
pid as parent_product_id,
thickness,
material,
weave_feature,
brand
category
from rugs_usa_parent
  );
[0m01:20:19.965589 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:20:19.966011 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:20:19.997383 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:20:20.008903 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product" rename to "parent_product__dbt_backup"
[0m01:20:20.008269 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:20:20.009757 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
alter table "postgres"."public_staging"."link_product_map" rename to "link_product_map__dbt_backup"
[0m01:20:20.010197 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:20:20.019685 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m01:20:20.021279 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:20:20.032144 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product__dbt_tmp" rename to "parent_product"
[0m01:20:20.031586 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:20:20.033032 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
alter table "postgres"."public_staging"."link_product_map__dbt_tmp" rename to "link_product_map"
[0m01:20:20.033415 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:20:20.044374 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m01:20:20.226891 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m01:20:20.227359 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: COMMIT
[0m01:20:20.228605 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:20:20.229115 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: COMMIT
[0m01:20:20.228022 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:20:20.230022 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m01:20:20.232233 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:20:20.232628 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m01:20:20.259697 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:20:20.268029 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
drop view if exists "postgres"."public_staging"."link_product_map__dbt_backup" cascade
[0m01:20:20.267347 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:20:20.268922 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
drop view if exists "postgres"."public_staging"."parent_product__dbt_backup" cascade
[0m01:20:20.270248 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:20:20.270693 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:20:20.275233 [debug] [Thread-1 (]: finished collecting timing info
[0m01:20:20.279454 [debug] [Thread-2 (]: finished collecting timing info
[0m01:20:20.280655 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: Close
[0m01:20:20.280075 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: Close
[0m01:20:20.282269 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c288ca1d-cb88-4ea4-bafe-d0af55370c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf23dedd0>]}
[0m01:20:20.283760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c288ca1d-cb88-4ea4-bafe-d0af55370c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf23d66e0>]}
[0m01:20:20.285128 [info ] [Thread-2 (]: 2 of 3 OK created view model public_staging.parent_product ..................... [[32mCREATE VIEW[0m in 0.80s]
[0m01:20:20.286677 [info ] [Thread-1 (]: 1 of 3 OK created view model public_staging.link_product_map ................... [[32mCREATE VIEW[0m in 0.80s]
[0m01:20:20.288166 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.parent_product
[0m01:20:20.289840 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.link_product_map
[0m01:20:20.291004 [debug] [Thread-2 (]: Began running node model.jaffle_shop.parent_variant_map
[0m01:20:20.292586 [info ] [Thread-2 (]: 3 of 3 START view model public_staging.parent_variant_map ...................... [RUN]
[0m01:20:20.294270 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:20:20.295025 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.parent_variant_map
[0m01:20:20.295676 [debug] [Thread-2 (]: Compiling model.jaffle_shop.parent_variant_map
[0m01:20:20.304223 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.parent_variant_map"
[0m01:20:20.305948 [debug] [Thread-2 (]: finished collecting timing info
[0m01:20:20.306521 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.parent_variant_map
[0m01:20:20.325174 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.parent_variant_map"
[0m01:20:20.327090 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:20:20.327657 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: BEGIN
[0m01:20:20.328144 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:20:20.366021 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m01:20:20.367032 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:20:20.367609 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */

  create view "postgres"."public_staging"."parent_variant_map__dbt_tmp" as (
    with base as (
    Select
        md5(pid || variant) as parent_variant_map_uuid,
        pid as parent_product_id,
        variant as variant_id,
        actual_size,
        weave_feature,
        weave_cat,
        size_grp,
        shipping_size,
        shape,
        cast(weight as float) as weight,
        cast(price as decimal(10,2)) as price,
        cast(msrp as decimal(10,2)) as msrp,    
        case when status = 'In_stock' and not low_stock then False else True end as popular_variant_flag,
        low_stock as low_stock_flag,
        cast(estimated_delivery_date as date) as estimated_delivery_date,
        case when new_arrival = 'Y' then true else false end as new_arrival_flag,   
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, variant order by dw_insert_timestamp desc) as row_num
    from rugs_usa_variant
)


Select *
from base 
where row_num = 1
  );
[0m01:20:20.370893 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:20:20.382470 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:20:20.383088 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map" rename to "parent_variant_map__dbt_backup"
[0m01:20:20.384143 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:20:20.394615 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:20:20.395203 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map__dbt_tmp" rename to "parent_variant_map"
[0m01:20:20.396177 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:20:20.403067 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m01:20:20.403635 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:20:20.404114 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m01:20:20.405483 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m01:20:20.413233 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:20:20.413813 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
drop view if exists "postgres"."public_staging"."parent_variant_map__dbt_backup" cascade
[0m01:20:20.415531 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:20:20.419733 [debug] [Thread-2 (]: finished collecting timing info
[0m01:20:20.420340 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: Close
[0m01:20:20.421764 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c288ca1d-cb88-4ea4-bafe-d0af55370c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10aec50>]}
[0m01:20:20.422981 [info ] [Thread-2 (]: 3 of 3 OK created view model public_staging.parent_variant_map ................. [[32mCREATE VIEW[0m in 0.13s]
[0m01:20:20.424369 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.parent_variant_map
[0m01:20:20.430159 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m01:20:20.431100 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:20.431664 [debug] [MainThread]: On master: BEGIN
[0m01:20:20.432201 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:20:20.469874 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m01:20:20.470900 [debug] [MainThread]: On master: COMMIT
[0m01:20:20.471462 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:20.471968 [debug] [MainThread]: On master: COMMIT
[0m01:20:20.472616 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:20:20.473166 [debug] [MainThread]: On master: Close
[0m01:20:20.474969 [info ] [MainThread]: 
[0m01:20:20.475842 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.38 seconds (1.38s).
[0m01:20:20.477014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:20:20.477613 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_variant_map' was properly closed.
[0m01:20:20.478085 [debug] [MainThread]: Connection 'model.jaffle_shop.link_product_map' was properly closed.
[0m01:20:20.515158 [info ] [MainThread]: 
[0m01:20:20.516188 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:20:20.517393 [info ] [MainThread]: 
[0m01:20:20.518538 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:20:20.520918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10f4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10f42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf2339c30>]}


============================== 2024-07-22 01:23:50.025082 | 3d7e9bdb-9d41-4d6e-8952-7bf8e92015a2 ==============================
[0m01:23:50.025687 [info ] [MainThread]: Running with dbt=1.2.0
[0m01:23:50.029782 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:23:50.030706 [debug] [MainThread]: Tracking: tracking
[0m01:23:50.060910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f22cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f21930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f23520>]}
[0m01:23:50.275086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:23:50.277479 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/parent_product.sql
[0m01:23:50.358877 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_product.sql
[0m01:23:50.577173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d7e9bdb-9d41-4d6e-8952-7bf8e92015a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10a9570>]}
[0m01:23:50.621293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d7e9bdb-9d41-4d6e-8952-7bf8e92015a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1083fd0>]}
[0m01:23:50.622545 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:23:50.623457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d7e9bdb-9d41-4d6e-8952-7bf8e92015a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10753c0>]}
[0m01:23:50.635684 [info ] [MainThread]: 
[0m01:23:50.638230 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m01:23:50.643864 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m01:23:50.705296 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:23:50.706406 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:23:50.706985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:50.784747 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.08 seconds
[0m01:23:50.792364 [debug] [ThreadPool]: On list_postgres: Close
[0m01:23:50.800023 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m01:23:50.801778 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m01:23:50.833220 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m01:23:50.840582 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:23:50.841337 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m01:23:50.841925 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m01:23:50.842491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:23:50.843063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:50.881985 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m01:23:50.883024 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m01:23:50.883465 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m01:23:50.884076 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:23:50.884697 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m01:23:50.885368 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:23:50.889810 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m01:23:50.890363 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m01:23:50.896901 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m01:23:50.902398 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m01:23:50.903398 [debug] [ThreadPool]: On list_postgres_public: Close
[0m01:23:50.903991 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m01:23:50.928724 [debug] [MainThread]: Using postgres connection "master"
[0m01:23:50.929608 [debug] [MainThread]: On master: BEGIN
[0m01:23:50.930121 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:23:50.966780 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m01:23:50.967636 [debug] [MainThread]: Using postgres connection "master"
[0m01:23:50.968147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:23:50.972601 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m01:23:50.978394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d7e9bdb-9d41-4d6e-8952-7bf8e92015a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f68370>]}
[0m01:23:50.979569 [debug] [MainThread]: On master: ROLLBACK
[0m01:23:50.980221 [debug] [MainThread]: Using postgres connection "master"
[0m01:23:50.980724 [debug] [MainThread]: On master: BEGIN
[0m01:23:50.981577 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:23:50.982129 [debug] [MainThread]: On master: COMMIT
[0m01:23:50.982627 [debug] [MainThread]: Using postgres connection "master"
[0m01:23:50.983089 [debug] [MainThread]: On master: COMMIT
[0m01:23:50.983716 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:23:50.984288 [debug] [MainThread]: On master: Close
[0m01:23:50.985532 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:23:50.986489 [info ] [MainThread]: 
[0m01:23:50.999656 [debug] [Thread-1 (]: Began running node model.jaffle_shop.link_product_map
[0m01:23:51.000358 [debug] [Thread-2 (]: Began running node model.jaffle_shop.parent_product
[0m01:23:51.001457 [info ] [Thread-1 (]: 1 of 3 START view model public_staging.link_product_map ........................ [RUN]
[0m01:23:51.002585 [info ] [Thread-2 (]: 2 of 3 START view model public_staging.parent_product .......................... [RUN]
[0m01:23:51.004337 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.link_product_map"
[0m01:23:51.006100 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.parent_product"
[0m01:23:51.006965 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.link_product_map
[0m01:23:51.007656 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.parent_product
[0m01:23:51.008314 [debug] [Thread-1 (]: Compiling model.jaffle_shop.link_product_map
[0m01:23:51.008920 [debug] [Thread-2 (]: Compiling model.jaffle_shop.parent_product
[0m01:23:51.018498 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.link_product_map"
[0m01:23:51.029752 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.parent_product"
[0m01:23:51.032944 [debug] [Thread-1 (]: finished collecting timing info
[0m01:23:51.033576 [debug] [Thread-2 (]: finished collecting timing info
[0m01:23:51.034664 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.parent_product
[0m01:23:51.034036 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.link_product_map
[0m01:23:51.437195 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.link_product_map"
[0m01:23:51.438276 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.parent_product"
[0m01:23:51.441671 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:23:51.442179 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:23:51.443216 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: BEGIN
[0m01:23:51.443733 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:23:51.442703 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: BEGIN
[0m01:23:51.446523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:51.483229 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m01:23:51.484179 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:23:51.484787 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */

  create view "postgres"."public_staging"."parent_product__dbt_tmp" as (
    --making a simple dimension table for parent product

Select distinct
pid as parent_product_id,
thickness,
material,
weave_feature,
brand,
category
from rugs_usa_parent
  );
[0m01:23:51.486899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m01:23:51.487426 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:23:51.488015 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:23:51.518047 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */

  create view "postgres"."public_staging"."link_product_map__dbt_tmp" as (
    with base as (
    Select *, row_number() over (partition by card_links order by page_rank) as row_num
    from (
        Select
        md5(card_links) as link_product_map_uuid,
        split_part(split_part(card_links, '/', -1), '-', 1) as parent_product_id, --the last element of the card_links is the pid
        split_part(card_links, '/', -2) as color, --the penultimate element of the card_links is the color
        case when split_part(split_part(page_links, '/', -1), '?', 2) = '' then 1
            else cast(
                    split_part(
                        split_part(split_part(page_links, '/', -1), '?', 2),
                        '=',
                        2
                    ) as int) end as page_rank,    --the second element of the query string is the page rank
        request_time_stamp::timestamptz as request_timestamp_utc, --assuming timestamp is in utc at the source
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        card_links, 
        page_links
        from rugs_usa_links) links
)

Select *
from base
where row_num = 1
  );
[0m01:23:51.519450 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:23:51.520464 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product" rename to "parent_product__dbt_backup"
[0m01:23:51.521627 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:23:51.533253 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:23:51.534337 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product__dbt_tmp" rename to "parent_product"
[0m01:23:51.533723 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m01:23:51.542296 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m01:23:51.545970 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:23:51.576356 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
alter table "postgres"."public_staging"."link_product_map" rename to "link_product_map__dbt_backup"
[0m01:23:51.597466 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m01:23:51.635575 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:23:51.647461 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
alter table "postgres"."public_staging"."link_product_map__dbt_tmp" rename to "link_product_map"
[0m01:23:51.669382 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m01:23:51.670871 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m01:23:51.678747 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:23:51.679337 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m01:23:51.678033 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: COMMIT
[0m01:23:51.680280 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:23:51.680875 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: COMMIT
[0m01:23:51.681337 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m01:23:51.682155 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:23:51.709270 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:23:51.717520 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
drop view if exists "postgres"."public_staging"."parent_product__dbt_backup" cascade
[0m01:23:51.716870 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:23:51.718335 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
drop view if exists "postgres"."public_staging"."link_product_map__dbt_backup" cascade
[0m01:23:51.719549 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:23:51.720196 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:23:51.724627 [debug] [Thread-2 (]: finished collecting timing info
[0m01:23:51.729540 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: Close
[0m01:23:51.728883 [debug] [Thread-1 (]: finished collecting timing info
[0m01:23:51.731841 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: Close
[0m01:23:51.731174 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d7e9bdb-9d41-4d6e-8952-7bf8e92015a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd3bfd0>]}
[0m01:23:51.733174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d7e9bdb-9d41-4d6e-8952-7bf8e92015a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aab1cd3b2e0>]}
[0m01:23:51.736430 [info ] [Thread-1 (]: 1 of 3 OK created view model public_staging.link_product_map ................... [[32mCREATE VIEW[0m in 0.73s]
[0m01:23:51.734545 [info ] [Thread-2 (]: 2 of 3 OK created view model public_staging.parent_product ..................... [[32mCREATE VIEW[0m in 0.73s]
[0m01:23:51.737946 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.link_product_map
[0m01:23:51.739968 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.parent_product
[0m01:23:51.741172 [debug] [Thread-1 (]: Began running node model.jaffle_shop.parent_variant_map
[0m01:23:51.742753 [info ] [Thread-1 (]: 3 of 3 START view model public_staging.parent_variant_map ...................... [RUN]
[0m01:23:51.744491 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:23:51.745276 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.parent_variant_map
[0m01:23:51.746149 [debug] [Thread-1 (]: Compiling model.jaffle_shop.parent_variant_map
[0m01:23:51.754239 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.parent_variant_map"
[0m01:23:51.755863 [debug] [Thread-1 (]: finished collecting timing info
[0m01:23:51.756474 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.parent_variant_map
[0m01:23:51.774645 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.parent_variant_map"
[0m01:23:51.776451 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:23:51.776983 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: BEGIN
[0m01:23:51.777472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:51.815750 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m01:23:51.816693 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:23:51.817219 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */

  create view "postgres"."public_staging"."parent_variant_map__dbt_tmp" as (
    with base as (
    Select
        md5(pid || variant) as parent_variant_map_uuid,
        pid as parent_product_id,
        variant as variant_id,
        actual_size,
        weave_feature,
        weave_cat,
        size_grp,
        shipping_size,
        shape,
        cast(weight as float) as weight,
        cast(price as decimal(10,2)) as price,
        cast(msrp as decimal(10,2)) as msrp,    
        case when status = 'In_stock' and not low_stock then False else True end as popular_variant_flag,
        low_stock as low_stock_flag,
        cast(estimated_delivery_date as date) as estimated_delivery_date,
        case when new_arrival = 'Y' then true else false end as new_arrival_flag,   
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, variant order by dw_insert_timestamp desc) as row_num
    from rugs_usa_variant
)


Select *
from base 
where row_num = 1
  );
[0m01:23:51.820487 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:23:51.831916 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:23:51.832558 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map" rename to "parent_variant_map__dbt_backup"
[0m01:23:51.833575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:23:51.843964 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:23:51.844588 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map__dbt_tmp" rename to "parent_variant_map"
[0m01:23:51.845560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:23:51.852445 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m01:23:51.852998 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:23:51.853537 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m01:23:51.854879 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:23:51.862837 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:23:51.863420 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
drop view if exists "postgres"."public_staging"."parent_variant_map__dbt_backup" cascade
[0m01:23:51.864975 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:23:51.869304 [debug] [Thread-1 (]: finished collecting timing info
[0m01:23:51.869931 [debug] [Thread-1 (]: On model.jaffle_shop.parent_variant_map: Close
[0m01:23:51.871375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d7e9bdb-9d41-4d6e-8952-7bf8e92015a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10f26e0>]}
[0m01:23:51.872618 [info ] [Thread-1 (]: 3 of 3 OK created view model public_staging.parent_variant_map ................. [[32mCREATE VIEW[0m in 0.13s]
[0m01:23:51.874003 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.parent_variant_map
[0m01:23:51.880498 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m01:23:51.881495 [debug] [MainThread]: Using postgres connection "master"
[0m01:23:51.882029 [debug] [MainThread]: On master: BEGIN
[0m01:23:51.882569 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:23:51.919483 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m01:23:51.920516 [debug] [MainThread]: On master: COMMIT
[0m01:23:51.921049 [debug] [MainThread]: Using postgres connection "master"
[0m01:23:51.921549 [debug] [MainThread]: On master: COMMIT
[0m01:23:51.922251 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:23:51.922844 [debug] [MainThread]: On master: Close
[0m01:23:51.924632 [info ] [MainThread]: 
[0m01:23:51.925527 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m01:23:51.926616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:23:51.927216 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_variant_map' was properly closed.
[0m01:23:51.927848 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_product' was properly closed.
[0m01:23:51.967618 [info ] [MainThread]: 
[0m01:23:51.968607 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:23:51.969811 [info ] [MainThread]: 
[0m01:23:51.970728 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:23:51.972046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1083b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1083550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf2335a20>]}


============================== 2024-07-22 01:29:43.706185 | 0d63bfc8-e194-4534-b62a-04d011c22ded ==============================
[0m01:29:43.706938 [info ] [MainThread]: Running with dbt=1.2.0
[0m01:29:43.710976 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:29:43.711942 [debug] [MainThread]: Tracking: tracking
[0m01:29:43.737509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f20bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f20370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f21840>]}
[0m01:29:43.968147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:29:43.970559 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/parent_variant_map.sql
[0m01:29:44.055869 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_variant_map.sql
[0m01:29:44.290071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d63bfc8-e194-4534-b62a-04d011c22ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10a95a0>]}
[0m01:29:44.334475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d63bfc8-e194-4534-b62a-04d011c22ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1087fa0>]}
[0m01:29:44.335724 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:29:44.337014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d63bfc8-e194-4534-b62a-04d011c22ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f035b0>]}
[0m01:29:44.344511 [info ] [MainThread]: 
[0m01:29:44.346430 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m01:29:44.351590 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m01:29:44.420665 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:29:44.422049 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:29:44.423724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:29:44.515160 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.09 seconds
[0m01:29:44.523270 [debug] [ThreadPool]: On list_postgres: Close
[0m01:29:44.532268 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m01:29:44.533983 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m01:29:44.572538 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m01:29:44.589350 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m01:29:44.589943 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:29:44.590599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:29:44.591284 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m01:29:44.593349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:29:44.632359 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m01:29:44.633430 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m01:29:44.633898 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m01:29:44.634487 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:29:44.635060 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m01:29:44.635665 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:29:44.640501 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m01:29:44.641015 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m01:29:44.646915 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m01:29:44.652062 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m01:29:44.653091 [debug] [ThreadPool]: On list_postgres_public: Close
[0m01:29:44.653728 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m01:29:44.678321 [debug] [MainThread]: Using postgres connection "master"
[0m01:29:44.679173 [debug] [MainThread]: On master: BEGIN
[0m01:29:44.679698 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:29:44.719946 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m01:29:44.720875 [debug] [MainThread]: Using postgres connection "master"
[0m01:29:44.721373 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:29:44.728182 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m01:29:44.734144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d63bfc8-e194-4534-b62a-04d011c22ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f21840>]}
[0m01:29:44.735378 [debug] [MainThread]: On master: ROLLBACK
[0m01:29:44.736016 [debug] [MainThread]: Using postgres connection "master"
[0m01:29:44.736539 [debug] [MainThread]: On master: BEGIN
[0m01:29:44.737376 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:29:44.737939 [debug] [MainThread]: On master: COMMIT
[0m01:29:44.738460 [debug] [MainThread]: Using postgres connection "master"
[0m01:29:44.738994 [debug] [MainThread]: On master: COMMIT
[0m01:29:44.739640 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:29:44.740181 [debug] [MainThread]: On master: Close
[0m01:29:44.741509 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:29:44.742488 [info ] [MainThread]: 
[0m01:29:44.754567 [debug] [Thread-1 (]: Began running node model.jaffle_shop.link_product_map
[0m01:29:44.755143 [debug] [Thread-2 (]: Began running node model.jaffle_shop.parent_product
[0m01:29:44.756206 [info ] [Thread-1 (]: 1 of 3 START view model public_staging.link_product_map ........................ [RUN]
[0m01:29:44.757193 [info ] [Thread-2 (]: 2 of 3 START view model public_staging.parent_product .......................... [RUN]
[0m01:29:44.758893 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.link_product_map"
[0m01:29:44.760675 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.parent_product"
[0m01:29:44.761490 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.link_product_map
[0m01:29:44.762126 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.parent_product
[0m01:29:44.762807 [debug] [Thread-1 (]: Compiling model.jaffle_shop.link_product_map
[0m01:29:44.763349 [debug] [Thread-2 (]: Compiling model.jaffle_shop.parent_product
[0m01:29:44.771609 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.link_product_map"
[0m01:29:44.781344 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.parent_product"
[0m01:29:44.784095 [debug] [Thread-2 (]: finished collecting timing info
[0m01:29:44.785131 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.parent_product
[0m01:29:44.784742 [debug] [Thread-1 (]: finished collecting timing info
[0m01:29:44.813583 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.link_product_map
[0m01:29:45.202671 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.link_product_map"
[0m01:29:45.203979 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.parent_product"
[0m01:29:45.206459 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:29:45.206965 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:29:45.207610 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: BEGIN
[0m01:29:45.209725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:29:45.208813 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: BEGIN
[0m01:29:45.211962 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:29:45.445476 [debug] [Thread-2 (]: SQL status: BEGIN in 0.23 seconds
[0m01:29:45.447007 [debug] [Thread-1 (]: SQL status: BEGIN in 0.24 seconds
[0m01:29:45.449355 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:29:45.450304 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */

  create view "postgres"."public_staging"."link_product_map__dbt_tmp" as (
    with base as (
    Select *, row_number() over (partition by card_links order by page_rank) as row_num
    from (
        Select
        md5(card_links) as link_product_map_uuid,
        split_part(split_part(card_links, '/', -1), '-', 1) as parent_product_id, --the last element of the card_links is the pid
        split_part(card_links, '/', -2) as color, --the penultimate element of the card_links is the color
        case when split_part(split_part(page_links, '/', -1), '?', 2) = '' then 1
            else cast(
                    split_part(
                        split_part(split_part(page_links, '/', -1), '?', 2),
                        '=',
                        2
                    ) as int) end as page_rank,    --the second element of the query string is the page rank
        request_time_stamp::timestamptz as request_timestamp_utc, --assuming timestamp is in utc at the source
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        card_links, 
        page_links
        from rugs_usa_links) links
)

Select *
from base
where row_num = 1
  );
[0m01:29:45.448312 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:29:45.452423 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */

  create view "postgres"."public_staging"."parent_product__dbt_tmp" as (
    --making a simple dimension table for parent product

Select distinct
pid as parent_product_id,
thickness,
material,
weave_feature,
brand,
category
from rugs_usa_parent
  );
[0m01:29:45.468762 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m01:29:45.470477 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m01:29:45.549464 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:29:45.550761 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:29:45.552077 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
alter table "postgres"."public_staging"."link_product_map" rename to "link_product_map__dbt_backup"
[0m01:29:45.551500 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product" rename to "parent_product__dbt_backup"
[0m01:29:45.554388 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:29:45.554785 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:29:45.565432 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:29:45.576392 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
alter table "postgres"."public_staging"."link_product_map__dbt_tmp" rename to "link_product_map"
[0m01:29:45.575812 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:29:45.577271 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product__dbt_tmp" rename to "parent_product"
[0m01:29:45.577651 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:29:45.586268 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m01:29:45.761796 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m01:29:45.768582 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:29:45.769112 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m01:29:45.767845 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: COMMIT
[0m01:29:45.770024 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:29:45.770532 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: COMMIT
[0m01:29:45.774162 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m01:29:45.781614 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m01:29:45.798978 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:29:45.807269 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
drop view if exists "postgres"."public_staging"."parent_product__dbt_backup" cascade
[0m01:29:45.806605 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:29:45.808107 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
drop view if exists "postgres"."public_staging"."link_product_map__dbt_backup" cascade
[0m01:29:45.809441 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:29:45.814291 [debug] [Thread-2 (]: finished collecting timing info
[0m01:29:45.815312 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: Close
[0m01:29:45.814698 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m01:29:45.817475 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d63bfc8-e194-4534-b62a-04d011c22ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf233e770>]}
[0m01:29:45.821640 [debug] [Thread-1 (]: finished collecting timing info
[0m01:29:45.824106 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: Close
[0m01:29:45.823070 [info ] [Thread-2 (]: 2 of 3 OK created view model public_staging.parent_product ..................... [[32mCREATE VIEW[0m in 1.06s]
[0m01:29:45.825571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d63bfc8-e194-4534-b62a-04d011c22ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab109af50>]}
[0m01:29:45.827392 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.parent_product
[0m01:29:45.828841 [info ] [Thread-1 (]: 1 of 3 OK created view model public_staging.link_product_map ................... [[32mCREATE VIEW[0m in 1.07s]
[0m01:29:45.830114 [debug] [Thread-2 (]: Began running node model.jaffle_shop.parent_variant_map
[0m01:29:45.833737 [info ] [Thread-2 (]: 3 of 3 START view model public_staging.parent_variant_map ...................... [RUN]
[0m01:29:45.832818 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.link_product_map
[0m01:29:45.835377 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:29:45.836541 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.parent_variant_map
[0m01:29:45.837145 [debug] [Thread-2 (]: Compiling model.jaffle_shop.parent_variant_map
[0m01:29:45.844788 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.parent_variant_map"
[0m01:29:45.846282 [debug] [Thread-2 (]: finished collecting timing info
[0m01:29:45.846834 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.parent_variant_map
[0m01:29:45.863786 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.parent_variant_map"
[0m01:29:45.865443 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:29:45.865960 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: BEGIN
[0m01:29:45.866404 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:29:45.906886 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m01:29:45.908430 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:29:45.909031 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */

  create view "postgres"."public_staging"."parent_variant_map__dbt_tmp" as (
    with base as (
    Select
        md5(pid || variant) as parent_variant_map_uuid,
        pid as parent_product_id,
        variant as variant_id,
        actual_size,
        weave_feature,
        weave_cat,
        size_grp,
        shipping_size,
        shape,
        cast(weight as float) as weight,
        cast(price as decimal(10,2)) as price,
        cast(msrp as decimal(10,2)) as msrp,    
        case when status = 'In_stock' and not low_stock then False else True end as popular_variant_flag,
        low_stock as low_stock_flag,
        cast(estimated_delivery_date as date) as estimated_delivery_date,
        case when new_arrival = 'Y' then true else false end as new_arrival_flag,   
        -- dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, variant order by dw_insert_timestamp desc) as row_num
    from rugs_usa_variant
)


Select *
from base 
where row_num = 1
  );
[0m01:29:45.913655 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:29:45.928800 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:29:45.929650 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map" rename to "parent_variant_map__dbt_backup"
[0m01:29:45.931096 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:29:45.941730 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:29:45.942347 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map__dbt_tmp" rename to "parent_variant_map"
[0m01:29:45.943302 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:29:45.950171 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m01:29:45.950741 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:29:45.951215 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m01:29:45.953105 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m01:29:45.961383 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:29:45.962011 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
drop view if exists "postgres"."public_staging"."parent_variant_map__dbt_backup" cascade
[0m01:29:45.963689 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:29:45.968076 [debug] [Thread-2 (]: finished collecting timing info
[0m01:29:45.968696 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: Close
[0m01:29:45.970293 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d63bfc8-e194-4534-b62a-04d011c22ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10afdc0>]}
[0m01:29:45.971590 [info ] [Thread-2 (]: 3 of 3 OK created view model public_staging.parent_variant_map ................. [[32mCREATE VIEW[0m in 0.14s]
[0m01:29:45.973174 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.parent_variant_map
[0m01:29:45.979299 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m01:29:45.980137 [debug] [MainThread]: Using postgres connection "master"
[0m01:29:45.980659 [debug] [MainThread]: On master: BEGIN
[0m01:29:45.981130 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:29:46.017494 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m01:29:46.018335 [debug] [MainThread]: On master: COMMIT
[0m01:29:46.018844 [debug] [MainThread]: Using postgres connection "master"
[0m01:29:46.019337 [debug] [MainThread]: On master: COMMIT
[0m01:29:46.020007 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:29:46.020565 [debug] [MainThread]: On master: Close
[0m01:29:46.022414 [info ] [MainThread]: 
[0m01:29:46.023315 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m01:29:46.024257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:29:46.024864 [debug] [MainThread]: Connection 'model.jaffle_shop.link_product_map' was properly closed.
[0m01:29:46.025388 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_variant_map' was properly closed.
[0m01:29:46.061965 [info ] [MainThread]: 
[0m01:29:46.062910 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:29:46.064015 [info ] [MainThread]: 
[0m01:29:46.064907 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:29:46.066345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1087b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1087b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf2345a50>]}


============================== 2024-07-22 01:32:37.469847 | 1eff89b4-ae7d-4582-a751-ab120c7dcdfa ==============================
[0m01:32:37.470553 [info ] [MainThread]: Running with dbt=1.2.0
[0m01:32:37.475554 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:32:37.476375 [debug] [MainThread]: Tracking: tracking
[0m01:32:37.510180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f20b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f20310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f21c60>]}
[0m01:32:37.715105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:32:37.717278 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/parent_variant_map.sql
[0m01:32:37.805223 [debug] [MainThread]: 1699: static parser successfully parsed staging/parent_variant_map.sql
[0m01:32:38.019129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1eff89b4-ae7d-4582-a751-ab120c7dcdfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10aa800>]}
[0m01:32:38.065614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1eff89b4-ae7d-4582-a751-ab120c7dcdfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1087e50>]}
[0m01:32:38.066975 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 6 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:32:38.068173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eff89b4-ae7d-4582-a751-ab120c7dcdfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab1075210>]}
[0m01:32:38.075941 [info ] [MainThread]: 
[0m01:32:38.078044 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m01:32:38.083214 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m01:32:38.142274 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:32:38.143187 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:32:38.143689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:32:38.213675 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.07 seconds
[0m01:32:38.220294 [debug] [ThreadPool]: On list_postgres: Close
[0m01:32:38.227942 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_staging"
[0m01:32:38.229664 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m01:32:38.267131 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m01:32:38.281566 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m01:32:38.281186 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:32:38.282123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:32:38.282758 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m01:32:38.284663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:32:38.322587 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m01:32:38.323205 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m01:32:38.323915 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:32:38.324534 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m01:32:38.325125 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:32:38.325735 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
  
[0m01:32:38.329394 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m01:32:38.329861 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m01:32:38.335725 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m01:32:38.340807 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m01:32:38.341760 [debug] [ThreadPool]: On list_postgres_public: Close
[0m01:32:38.342328 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m01:32:38.367484 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:38.368308 [debug] [MainThread]: On master: BEGIN
[0m01:32:38.368823 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:32:38.405745 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m01:32:38.406652 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:38.407175 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:32:38.411329 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m01:32:38.416970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eff89b4-ae7d-4582-a751-ab120c7dcdfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab0f20b80>]}
[0m01:32:38.417966 [debug] [MainThread]: On master: ROLLBACK
[0m01:32:38.418635 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:38.419185 [debug] [MainThread]: On master: BEGIN
[0m01:32:38.420038 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:32:38.420606 [debug] [MainThread]: On master: COMMIT
[0m01:32:38.421098 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:38.421555 [debug] [MainThread]: On master: COMMIT
[0m01:32:38.422175 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:32:38.422729 [debug] [MainThread]: On master: Close
[0m01:32:38.423878 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:32:38.424748 [info ] [MainThread]: 
[0m01:32:38.436439 [debug] [Thread-1 (]: Began running node model.jaffle_shop.link_product_map
[0m01:32:38.437071 [debug] [Thread-2 (]: Began running node model.jaffle_shop.parent_product
[0m01:32:38.438144 [info ] [Thread-1 (]: 1 of 3 START view model public_staging.link_product_map ........................ [RUN]
[0m01:32:38.439518 [info ] [Thread-2 (]: 2 of 3 START view model public_staging.parent_product .......................... [RUN]
[0m01:32:38.441873 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.link_product_map"
[0m01:32:38.443519 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.parent_product"
[0m01:32:38.444236 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.link_product_map
[0m01:32:38.444893 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.parent_product
[0m01:32:38.445493 [debug] [Thread-1 (]: Compiling model.jaffle_shop.link_product_map
[0m01:32:38.446094 [debug] [Thread-2 (]: Compiling model.jaffle_shop.parent_product
[0m01:32:38.453904 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.link_product_map"
[0m01:32:38.464906 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.parent_product"
[0m01:32:38.467986 [debug] [Thread-1 (]: finished collecting timing info
[0m01:32:38.468830 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.link_product_map
[0m01:32:38.469204 [debug] [Thread-2 (]: finished collecting timing info
[0m01:32:38.490300 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.parent_product
[0m01:32:38.849585 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.link_product_map"
[0m01:32:38.854101 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.parent_product"
[0m01:32:38.857427 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:32:38.857896 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:32:38.858859 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: BEGIN
[0m01:32:38.859320 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:32:38.858378 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: BEGIN
[0m01:32:38.861801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:38.900165 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m01:32:38.901214 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:32:38.902027 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */

  create view "postgres"."public_staging"."parent_product__dbt_tmp" as (
    --making a simple dimension table for parent product

Select distinct
pid as parent_product_id,
thickness,
material,
weave_feature,
brand,
category
from rugs_usa_parent
  );
[0m01:32:38.902494 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m01:32:38.903428 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:32:38.904110 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */

  create view "postgres"."public_staging"."link_product_map__dbt_tmp" as (
    with base as (
    Select *, row_number() over (partition by card_links order by page_rank) as row_num
    from (
        Select
        md5(card_links) as link_product_map_uuid,
        split_part(split_part(card_links, '/', -1), '-', 1) as parent_product_id, --the last element of the card_links is the pid
        split_part(card_links, '/', -2) as color, --the penultimate element of the card_links is the color
        case when split_part(split_part(page_links, '/', -1), '?', 2) = '' then 1
            else cast(
                    split_part(
                        split_part(split_part(page_links, '/', -1), '?', 2),
                        '=',
                        2
                    ) as int) end as page_rank,    --the second element of the query string is the page rank
        request_time_stamp::timestamptz as request_timestamp_utc, --assuming timestamp is in utc at the source
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        card_links, 
        page_links
        from rugs_usa_links) links
)

Select *
from base
where row_num = 1
  );
[0m01:32:38.906161 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:32:38.916682 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m01:32:38.937638 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:32:38.948959 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product" rename to "parent_product__dbt_backup"
[0m01:32:38.948342 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:32:38.949854 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
alter table "postgres"."public_staging"."link_product_map" rename to "link_product_map__dbt_backup"
[0m01:32:38.950319 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:32:38.958610 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m01:32:38.961476 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:32:38.972174 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
alter table "postgres"."public_staging"."parent_product__dbt_tmp" rename to "parent_product"
[0m01:32:38.971619 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:32:38.973000 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
alter table "postgres"."public_staging"."link_product_map__dbt_tmp" rename to "link_product_map"
[0m01:32:38.973398 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:32:38.983221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m01:32:39.162089 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m01:32:39.162546 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: COMMIT
[0m01:32:39.163340 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:32:39.164459 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: COMMIT
[0m01:32:39.163906 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:32:39.165487 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: COMMIT
[0m01:32:39.165991 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m01:32:39.176178 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m01:32:39.201936 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_product"
[0m01:32:39.206424 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_product"} */
drop view if exists "postgres"."public_staging"."parent_product__dbt_backup" cascade
[0m01:32:39.205780 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.link_product_map"
[0m01:32:39.207365 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.link_product_map"} */
drop view if exists "postgres"."public_staging"."link_product_map__dbt_backup" cascade
[0m01:32:39.209261 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:32:39.209755 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:32:39.214388 [debug] [Thread-2 (]: finished collecting timing info
[0m01:32:39.219173 [debug] [Thread-2 (]: On model.jaffle_shop.parent_product: Close
[0m01:32:39.218544 [debug] [Thread-1 (]: finished collecting timing info
[0m01:32:39.221628 [debug] [Thread-1 (]: On model.jaffle_shop.link_product_map: Close
[0m01:32:39.220964 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eff89b4-ae7d-4582-a751-ab120c7dcdfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf23db070>]}
[0m01:32:39.222968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eff89b4-ae7d-4582-a751-ab120c7dcdfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf237bfd0>]}
[0m01:32:39.224397 [info ] [Thread-2 (]: 2 of 3 OK created view model public_staging.parent_product ..................... [[32mCREATE VIEW[0m in 0.78s]
[0m01:32:39.225805 [info ] [Thread-1 (]: 1 of 3 OK created view model public_staging.link_product_map ................... [[32mCREATE VIEW[0m in 0.78s]
[0m01:32:39.227508 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.parent_product
[0m01:32:39.229239 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.link_product_map
[0m01:32:39.230471 [debug] [Thread-2 (]: Began running node model.jaffle_shop.parent_variant_map
[0m01:32:39.231948 [info ] [Thread-2 (]: 3 of 3 START view model public_staging.parent_variant_map ...................... [RUN]
[0m01:32:39.233618 [debug] [Thread-2 (]: Acquiring new postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:32:39.234269 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.parent_variant_map
[0m01:32:39.234886 [debug] [Thread-2 (]: Compiling model.jaffle_shop.parent_variant_map
[0m01:32:39.243196 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.parent_variant_map"
[0m01:32:39.245261 [debug] [Thread-2 (]: finished collecting timing info
[0m01:32:39.245819 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.parent_variant_map
[0m01:32:39.263473 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.parent_variant_map"
[0m01:32:39.265275 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:32:39.265824 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: BEGIN
[0m01:32:39.266332 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:32:39.304110 [debug] [Thread-2 (]: SQL status: BEGIN in 0.04 seconds
[0m01:32:39.305031 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:32:39.305566 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */

  create view "postgres"."public_staging"."parent_variant_map__dbt_tmp" as (
    with base as (
    Select
        md5(pid || variant) as parent_variant_map_uuid,
        pid as parent_product_id,
        variant as variant_id,
        actual_size,
        weave_feature,
        weave_cat,
        size_grp,
        shipping_size,
        shape,
        cast(weight as float) as weight,
        cast(price as decimal(10,2)) as price,
        cast(msrp as decimal(10,2)) as msrp,    
        case when status = 'In_stock' and not low_stock then False else True end as popular_variant_flag,
        low_stock as low_stock_flag,
        case when new_arrival = 'Y' then true else false end as new_arrival_flag,   
        dw_insert_timestamp::timestamptz as dw_insert_timestamp_utc, --assuming timestamp is in utc at the source
        row_number() over (partition by pid, variant order by dw_insert_timestamp desc) as row_num
    from rugs_usa_variant
)


Select *
from base 
where row_num = 1
  );
[0m01:32:39.308910 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:32:39.320086 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:32:39.320702 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map" rename to "parent_variant_map__dbt_backup"
[0m01:32:39.321768 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:32:39.331894 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:32:39.332491 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
alter table "postgres"."public_staging"."parent_variant_map__dbt_tmp" rename to "parent_variant_map"
[0m01:32:39.333415 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:32:39.340159 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m01:32:39.340706 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:32:39.341202 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: COMMIT
[0m01:32:39.342145 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m01:32:39.349851 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.parent_variant_map"
[0m01:32:39.350388 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.parent_variant_map"} */
drop view if exists "postgres"."public_staging"."parent_variant_map__dbt_backup" cascade
[0m01:32:39.352228 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:32:39.356429 [debug] [Thread-2 (]: finished collecting timing info
[0m01:32:39.357028 [debug] [Thread-2 (]: On model.jaffle_shop.parent_variant_map: Close
[0m01:32:39.358524 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eff89b4-ae7d-4582-a751-ab120c7dcdfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10f0850>]}
[0m01:32:39.359773 [info ] [Thread-2 (]: 3 of 3 OK created view model public_staging.parent_variant_map ................. [[32mCREATE VIEW[0m in 0.13s]
[0m01:32:39.361138 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.parent_variant_map
[0m01:32:39.366598 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m01:32:39.367524 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:39.368038 [debug] [MainThread]: On master: BEGIN
[0m01:32:39.368546 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:32:39.405371 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m01:32:39.406335 [debug] [MainThread]: On master: COMMIT
[0m01:32:39.406859 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:39.407394 [debug] [MainThread]: On master: COMMIT
[0m01:32:39.408144 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:32:39.408726 [debug] [MainThread]: On master: Close
[0m01:32:39.410581 [info ] [MainThread]: 
[0m01:32:39.411525 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m01:32:39.412579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:32:39.413256 [debug] [MainThread]: Connection 'model.jaffle_shop.link_product_map' was properly closed.
[0m01:32:39.414131 [debug] [MainThread]: Connection 'model.jaffle_shop.parent_variant_map' was properly closed.
[0m01:32:39.451477 [info ] [MainThread]: 
[0m01:32:39.452509 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:32:39.453748 [info ] [MainThread]: 
[0m01:32:39.454695 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:32:39.456512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10f2620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaab10f26b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x2aaaf233db40>]}
